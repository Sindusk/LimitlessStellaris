##########################################################################
# Limitless Stellaris - Resolutions
##########################################################################

# Vanilla Variables
#@resolution_weight_hated = 3
#@resolution_weight_disliked = 4
#@resolution_weight_unpopular = 5
#@resolution_weight_normal = 6
#@resolution_weight_popular = 6.5
#@resolution_weight_loved = 7
#@resolution_weight_fever = 10 # MECR
#
#@resolution_cost_t1 = 100
#@resolution_cost_t2 = 150
#@resolution_cost_t3 = 200
#@resolution_cost_t4 = 250
#@resolution_cost_t5 = 300
#@resolution_cost_denounce = 25
#
#@resolution_flag_timer = 360
#
# MECR Variables
#@resolution_cost_t1_half = 50
#@resolution_cost_t2_half = 75
#@resolution_cost_t3_half = 100
#@resolution_cost_t4_half = 125
#@resolution_cost_t5_half = 150
#@resolution_cost_denounce_half = 12.5

##################################################
## Merged Resolutions
##################################################

## Amoeba Conservation Act
# Merge between EED, MECR, NGS, Ariphaos
resolution_amoeba_conservation_act = {
	icon = "GFX_resolution_tiyanki_preservation"

	potential = {
		has_federations_dlc = yes
		has_modifier = pacified_amoebas
	}

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_denounce
		}
	}
	target = no

	effect = {
		hidden_effect = { add_modifier = { modifier = resolution_passed_diplomatic_weight days = 2200 } } # EED
		custom_tooltip = resolution_amoeba_conservation_act_tooltip
		hidden_effect = {
			every_country = {
				limit = {
					is_galactic_community_member = yes
					NOT = { has_modifier = pacified_amoebas }
				}
				country_event = { id = galactic_features.505 }
			}
			set_timed_country_flag = { flag = galactic_community_resolution_passed_general days = @resolution_flag_timer }
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_supremacist days = 7200 } # EED
			add_modifier = {
				modifier = resolution_passed_diplomatic_weight
				days = 2200
			}
		}
	}

	fail_effects = {
		hidden_effect = { add_modifier = { modifier = resolution_failed_diplomatic_weight days = 2200 } } # EED
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_general days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_failed_diplomatic_weight
				days = 2200
			}
		}
	}

	allow = {
		custom_tooltip = { # MECR
			fail_text = "resolution_already_in_lower_house_session"
			NOT = { has_global_flag = lh_recent_resolution_amoeba_conservation_act }
		}
		OR = {
			is_active_resolution = resolution_tiyanki_conservation_act
			has_global_flag = tiyanki_extinct # Ariphaos
		}
		custom_tooltip = {
			fail_text = "resolution_already_active"
			NOR = { # EED
				is_active_resolution = "resolution_amoeba_conservation_act"
				is_active_resolution = "resolution_crystal_conservation_act"
				is_active_resolution = "resolution_space_cloud_conservation_act"
				is_active_resolution = "resolution_drone_conservation_act"
			}
		}
	}

	breach = {
		NOT = { has_country_flag = constitutional_immunity }
		OR = {
			has_country_flag = resolution_breached_killed_tiyanki # EED
			NOT = { has_modifier = pacified_amoebas }
		}
	}

	ai_weight = {
		base = @resolution_weight_unpopular # NGS disliked -> unpopular

		modifier = {
			factor = 2 # NGS 1.5 -> 2
			is_xenophile = yes
			desc = ethic_xenophile
		}

		modifier = { # NGS
			factor = 1.5
			has_policy_flag = diplo_stance_cooperative
			desc = diplo_stance_cooperative
		}

		modifier = {
			factor = 1.5 # NGS 1.25 -> 1.5
			is_pacifist = yes
			desc = ethic_pacifist
		}

		modifier = {
			factor = 0.75
			is_militarist = yes
			desc = ethic_militarist
		}
		modifier = { # EED
			factor = 0
			has_origin = origin_natural_hunters
			desc = origin_natural_hunters
		}

		modifier = {
			factor = 1.5
			OR = {
				has_valid_civic = civic_environmentalist
				has_valid_civic = civic_hive_empath
			}
			desc = gal_com_supporting_civics
		}

		modifier = {
			factor = 0.25 # NGS 0 -> 0.25
			has_valid_civic = civic_hive_cordyceptic_drones
			desc = gal_com_opposing_civics
		}

		modifier = {
			factor = 0.25 # NGS 0 -> 0.25
			is_xenophobe = yes
			desc = ethic_xenophobe
		}
		
		modifier = { # MECR
			factor = 0.1
			NOR = {
				is_voting_on_resolution = resolution_amoeba_conservation_act
				any_country = { is_proposing_resolution = resolution_amoeba_conservation_act }
			}
			desc = gal_com_meaningless_resolution
		}
		modifier = { # MECR
			factor = 0.5
			NOT = { is_voting_on_resolution = resolution_amoeba_conservation_act }
			desc = gal_com_meaningless_resolution
		}
		modifier = { # EED
			factor = 10
			has_origin = origin_amoeba
			desc = origin_amoeba
		}
	}
}

## Community Champions
# Merge between EED, MECR, StarTech, Ariphaos
resolution_community_champions = {
	icon = "GFX_resolution_community_champions"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t4
		}
	}
	target = no

	triggered_modifier = {
		potential = {
			is_galactic_custodian = no
			is_galactic_emperor = no
			is_part_of_galactic_council = yes
		}
		modifier = {
			community_champion_counselor = 1
		}
	}

	triggered_modifier = {
		potential = {
			is_galactic_custodian = yes
			is_galactic_president = no # EED
		}
		modifier = {
			community_champion_custodian = 1
		}
	}

	triggered_modifier = {
		potential = {
			OR = {
				is_galactic_emperor = yes
				is_galactic_president = yes # EED
			}
		}
		modifier = {
			community_champion_emperor = 1
		}
	}

	triggered_modifier = {
		potential = {
			is_galactic_custodian = no
			is_galactic_president = no # EED
			is_galactic_emperor = no
			is_part_of_galactic_council = no
		}
		modifier = {
			community_champion_regular = 1
		}
	}

	effect = {
		custom_tooltip = resolution_community_champions_tooltip
		hidden_effect = {
			set_global_flag = galactic_community_resolution_passed
			set_timed_country_flag = { flag = galactic_community_resolution_passed_community_champions days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_passed_diplomatic_weight
				days = 2200
			}
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_community_champions days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_failed_diplomatic_weight
				days = 2200
			}
		}
	}

	potential = {
		has_tradition = tr_politics_finish
	}

	allow = {
		custom_tooltip = {
			fail_text = "resolution_already_active"
			NOT = {
				is_active_resolution = resolution_community_champions
			}
		}
		is_galactic_council_established = yes
	}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = { # EED
			factor = 1.5
			is_civic_diplomatic_corps = yes
			desc = gal_com_diplo_civic
		}
		modifier = { # EED
			factor = 1.5
			is_civic_machine_servitor = yes
			desc = civic_machine_servitor
		}

		modifier = {
			factor = 1.2
			is_authoritarian = yes
			desc = ethic_authoritarian
		}

		modifier = {
			factor = 2
			OR = {
				is_part_of_galactic_council = yes
				AND = {
					is_subject = yes
					overlord = {
						opinion_level = { who = prev level >= neutral }
						is_part_of_galactic_council = yes
					}
				}
			}
			desc = gal_com_they_or_overlord_on_galatic_council
		}

		modifier = {
			factor = 0.8
			galactic_community_rank > 5
			NAND = {
				is_subject = yes
				overlord = {
					opinion_level = { who = prev level >= neutral }
					is_part_of_galactic_council = yes
				}
			}
			desc = gal_com_they_nor_overlord_not_on_galatic_council
		}

		modifier = { # EED
			factor = 0.8
			is_militarist = yes
			is_part_of_galactic_council = no
			desc = ethic_militarist
		}
	}
}

## Council Denouncement
# Merge between EED, NGS, StarTech, Ariphaos
resolution_council_denouncement = {
	icon = "GFX_resolution_purges"

	potential = {
		OR = {
			has_federations_dlc = yes
			has_nemesis = yes
		}
		is_galactic_council_established = yes
		NOT = { has_global_flag = resolution_council_denouncement_abolished }
	}

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t1
		}
	}

	target = yes
	harmful = yes
	valid_target = {
		is_country_type = default
		is_galactic_community_member = yes
		NOR = { 
			is_same_value = from # don't denounce yourself.
			has_modifier = resolution_denounced # #NGS: Give them a break.
		} 
		OR = {
			opinion_level = { who = from level < poor } # NGS neutral -> poor
			from = { is_rival = prev }
			is_in_breach_of_any = yes
			is_at_war_with = from # NGS
		}
		NOT = { has_country_flag = constitutional_immunity }
		OR = { # Ariphaos
			has_crisis_level = crisis_level_1
			has_crisis_level = crisis_level_2
			has_crisis_level = crisis_level_3
			has_crisis_level = crisis_level_4
			has_crisis_level = crisis_level_5
			NOT = { has_modifier = resolution_denounced } # Give them a break.
		}
		OR = { # EED
			is_galactic_emperor = no
			imperial_authority <= 100
		}
	}

	effect = {
		add_modifier = { modifier = resolution_denounced days = 3600 }
		hidden_effect = { # NGS
			set_timed_global_flag = {
				flag = denouncement_cooldown_council
				years = 15
			}
		}
	}

	allow = {
		is_part_of_galactic_council = yes
	}

	ai_weight = {
		base = @resolution_weight_unpopular # NGS disliked -> unpopular
		
		modifier = { # EED
			factor = 0.75
			FROM = { is_galactic_emperor = yes }
			imperial_authority >= 75
			desc = gal_com_target_emperor
		}
		modifier = { # EED
			factor = 0.75
			FROM = { is_galactic_emperor = yes }
			imperial_authority >= 50
			desc = gal_com_target_emperor
		}
		
		# More likely to declare on rivals
		modifier = { # Ariphaos
			factor = 2
			is_rival = from
			desc = gal_com_target_is_rival
		}

		# Never on yourself
		modifier = { # Ariphaos
			factor = 0
			is_same_value = from
			desc = gal_com_target_is_me
		}
		
		# Never on your federation
		modifier = { # Ariphaos
			factor = 0
			is_in_federation_with = from
			desc = ariphaos_patch_gal_com_share_federation
		}

		modifier = { # NGS
			factor = 0.6
			has_global_flag = denouncement_cooldown_council
			NOR = { 
				from = { is_rival = prev }
				is_at_war_with = from
			}
			desc = denounced_cooldown_eu
		}
		# weaklings are scared of BtC
		modifier = {
			factor = 5
			has_nemesis = yes
			any_playable_country = {
				#has_crisis_level >= crisis_level_1
				OR = {
					has_crisis_level = crisis_level_1
					has_crisis_level = crisis_level_2
					has_crisis_level = crisis_level_3
					has_crisis_level = crisis_level_4
					has_crisis_level = crisis_level_5
				}
				NOT = { is_same_value = prev }
				has_resource = {
					type = menace
					amount > 1000
				}
				relative_power = {
					who = prev
					category = all
					value > equivalent
				}
			}
			desc = gal_com_afraid_of_powerful_crisis
		}

		# everyone is scared of BtC
		modifier = {
			factor = 5
			has_nemesis = yes
			any_playable_country = {
				#has_crisis_level >= crisis_level_1
				OR = {
					has_crisis_level = crisis_level_1
					has_crisis_level = crisis_level_2
					has_crisis_level = crisis_level_3
					has_crisis_level = crisis_level_4
					has_crisis_level = crisis_level_5
				}
				NOT = { is_same_value = prev }
				has_resource = {
					type = menace
					amount > 2000
				}
			}
			desc = gal_com_afraid_of_crisis
		}

		# imagine having a BtC empire next door
		modifier = {
			factor = 5
			has_nemesis = yes
			any_neighbor_country = {
				#has_crisis_level >= crisis_level_1
				OR = {
					has_crisis_level = crisis_level_1
					has_crisis_level = crisis_level_2
					has_crisis_level = crisis_level_3
					has_crisis_level = crisis_level_4
					has_crisis_level = crisis_level_5
				}
			}
			desc = gal_com_afraid_of_neighbor_crisis
		}

		# imagine your rival having a (not too scary) BtC empire next door - that's good
		modifier = {
			factor = 0.01
			has_nemesis = yes
			NOT = {
				any_neighbor_country = {
					#has_crisis_level >= crisis_level_1
					OR = {
						has_crisis_level = crisis_level_1
						has_crisis_level = crisis_level_2
						has_crisis_level = crisis_level_3
						has_crisis_level = crisis_level_4
						has_crisis_level = crisis_level_5
					}
				}
			}
			any_rival_country = {
				any_neighbor_country = {
					#has_crisis_level >= crisis_level_1
					#has_crisis_level < crisis_level_5
					OR = {
						has_crisis_level = crisis_level_1
						has_crisis_level = crisis_level_2
						has_crisis_level = crisis_level_3
						has_crisis_level = crisis_level_4
						#has_crisis_level = crisis_level_5
					}
				}
			}
			desc = gal_com_pleased_to_have_rival_neighboring_crisis
		}
		modifier = { # NGS
			factor = 1.6
			from = { is_rival = prev }
			desc = rival_target_eu
		}
		modifier = { # NGS
			factor = 1.4
			is_at_war_with = from
			desc = is_at_war_eu
		}
		modifier = { # NGS
			factor = 0.75
			from = { is_galactic_community_member = yes }
			opinion_level = { who = from level > neutral }
			NOT = { opinion_level = { who = from level > good } }
			desc = good_opinion
		}
		modifier = { # NGS
			factor = 0.5
			from = { is_galactic_community_member = yes }
			opinion_level = { who = from level > good }
			desc = excellent_opinion
		}
		modifier = { # NGS
			factor = 1.4
			from = { 
				is_galactic_community_member = yes
				NOT = { is_rival = prev }
			}
			opinion_level = { who = from level < neutral }
			NOT = { opinion_level = { who = from level < poor } }
			desc = bad_opinion
		}
		modifier = { # NGS
			factor = 2
			from = { 
				is_galactic_community_member = yes
				NOT = { is_rival = prev }
			}
			opinion_level = { who = from level < poor }
			desc = terrible_opinion
		}
	}
}

## Declare Crisis
# Merge between EED, Daemonic Incursion, Ariphaos, Scripted Trigger Undercoat
resolution_declare_crisis = {
	icon = "GFX_resolution_declare_crisis"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t5
		}
	}

	target = yes
	harmful = yes

	valid_target = {
		NOT = { is_same_value = from }
		OR = {
			is_playable = yes # STU
			AND = {
				is_fallen_empire = yes
				NOT = { has_global_flag = war_in_heaven_ongoing }
			}
		}
		NOT = { has_country_flag = declared_crisis }
	}

	modifier = {
		starbase_shipyard_build_speed_mult = 0.20
		ships_upkeep_mult = -0.1
	}

	effect = {
		custom_tooltip = resolution_declare_crisis_tooltip
		from = { # EED
			custom_tooltip = resolution_declare_crisis_menace_tooltip
		}
		hidden_effect = {
			if = {
				limit = { is_galactic_community_member = yes }
				remove_from_galactic_community = yes
			}
			if = {
				limit = {
					is_galactic_council_established = yes
					is_part_of_galactic_council = yes
				}
				remove_from_galactic_council = yes
			}
			every_subject = {
				if = {
					limit = { is_galactic_community_member = yes }
					remove_from_galactic_community = yes
				}
				if = {
					limit = {
						is_galactic_council_established = yes
						is_part_of_galactic_council = yes
					}
					remove_from_galactic_council = yes
				}
			}
			set_country_flag = declared_crisis
			save_event_target_as = new_crisis
			country_event = { id = crisis.4105 }
			every_playable_country = {
				limit = {
					is_ai = no
					NOT = { is_same_value = prev }
				}
				country_event = { id = crisis.4100 }
			}
			if = {
				limit = { has_galactic_custodian = yes }
				galactic_custodian = {
					save_event_target_as = community_war_leader
					if = {
						limit = { is_in_federation_with = event_target:new_crisis }
						event_target:new_crisis = {
							leave_alliance = { override_requirements = yes }
						}
					}
				}
			}
			else_if = {
				limit = { has_galactic_emperor = yes }
				galactic_emperor = {
					save_event_target_as = community_war_leader
				}
			}
			else = {
				random_playable_country = {
					limit = {
						is_galactic_community_member = yes
						NOT = { is_in_federation_with = event_target:new_crisis }
					}
					weights = {
						base = 1
						modifier = {
							add = 10000
							galactic_community_rank = 1
						}
						modifier = {
							add = 1000
							galactic_community_rank = 2
						}
						modifier = {
							add = 100
							galactic_community_rank = 3
						}
						modifier = {
							add = 10
							is_galactic_council_established = yes
							is_part_of_galactic_council = yes
						}
					}
					save_event_target_as = community_war_leader
				}
			}
			if = { # EED
				limit = {
					from = { has_ascension_perk = ap_become_the_crisis }
					NOR = {
						is_homicidal = yes
						has_ascension_perk = ap_become_the_crisis
						AND = {
							is_fallen_empire = yes
							NOT = { has_global_flag = war_in_heaven_ongoing }
						}

					}
				}
				from = { complete_crisis_objective = crisobj_perform_upsetting_operations }
			}

			declare_crisis_war_effect = yes
		}
	}

	potential = {
		has_nemesis = yes
		has_galactic_emperor = no
		is_part_of_galactic_council = yes
	}

	ai_weight = {
		base = @resolution_weight_hated

		modifier = { # Daemonic Incursion
			factor = 10
			from = {
				has_country_flag = newgen_danger1
			}
			desc = newgen_com_desc_2
		}
		modifier = { # Daemonic Incursion
			factor = 40
			exists = event_target:demonic_incursion_country
			from = {
				is_same_value = event_target:demonic_incursion_country
				galaxy_percentage > 0.1
			}
			desc = newgen_com_desc_2
		}
		modifier = { # Daemonic Incursion
			factor = 30
			from = {
				has_country_flag = chosen_empire
				galaxy_percentage > 0.15
			}
			desc = newgen_com_desc_2
		}
		modifier = { # Daemonic Incursion
			factor = 20
			from = {
				has_country_flag = newgen_danger2
			}
			desc = newgen_com_desc_4
		}
		modifier = { # Daemonic Incursion
			factor = 40
			from = {
				has_country_flag = newgen_danger3
			}
			desc = newgen_com_desc_3
		}
		# Should almost always declare on Crisis countries in end game
		modifier = {
			factor = 50
			from = {
				has_country_flag = crisis_sphere_revealed
			}
			desc = gal_com_crisis_sphere_revealed
		}

		# More likely to declare on very powerful homicidal empires
		modifier = {
			factor = 10
			from = {
				is_homicidal = yes
				relative_power = {
					who = prev
					category = fleet
					value = overwhelming
				}
			}
			desc = gal_com_target_is_very_strong_homicidal_empire
		}
		# More likely to declare on very powerful homicidal empires
		modifier = {
			factor = 5
			from = {
				is_homicidal = yes
				relative_power = {
					who = prev
					category = fleet
					value = superior
				}
			}
			desc = gal_com_target_is_strong_homicidal_empire
		}
		
		# More likely to declare on very powerful assimilator empires
		modifier = { # EED
			factor = 8
			from = {
				is_civic_machine_assimilator = yes
				is_pacifist = no
				relative_power = {
					who = prev
					category = fleet
					value = overwhelming
				}
			}
			desc = gal_com_target_is_very_strong_assimilator_empire
		}
		# More likely to declare on very powerful assimilator empires
		modifier = { # EED
			factor = 4
			from = {
				is_civic_machine_assimilator = yes
				is_pacifist = no
				relative_power = {
					who = prev
					category = fleet
					value = superior
				}
			}
			desc = gal_com_target_is_strong_assimilator_empire
		}

		# More likely to declare on rivals
		modifier = {
			factor = 5 # EED 2 -> 5
			is_rival = from
			desc = gal_com_target_is_rival
		}
		modifier = { # EED
			factor = 5
			is_at_war_with = from
			desc = gal_com_target_is_rival
		}
		
		# Never on your ally
		modifier = { # Ariphaos
			factor = 0
			is_in_federation_with = from
			desc = ariphaos_patch_gal_com_share_federation
		}

		# Never on yourself
		modifier = {
			factor = 0
			is_same_value = from
			desc = gal_com_target_is_me
		}

		# More likely to declare on a crisis country that has started cracking stars
		modifier = {
			factor = 6
			from = { has_country_flag = cracked_first_star }
			desc = gal_com_target_has_cracked_stars
		}

		# Should be reluctant to use on normal countries
		modifier = {
			factor = 0.2
			from = { # EED
				NOR = { 
					is_homicidal = yes
					has_country_flag = crisis_sphere_revealed
					has_country_flag = cracked_first_star
					AND = {
						is_civic_machine_assimilator = yes
						is_pacifist = no
					}
				}
			}
			desc = gal_com_target_is_a_normal_empire
		}
		
		modifier = { # EED
			factor = 0.5
			is_civic_machine_assimilator = yes
			from = { is_civic_machine_assimilator = yes }
			desc = gal_com_assimilator_civic
		}

		# Very unlikely to use on Custodian
		modifier = {
			factor = 0.1 # EED 0.2 -> 0.1
			from = { is_galactic_custodian = yes }
			NOR = { has_ascension_perk = ap_become_the_crisis }
			desc = gal_com_target_is_the_custodian
		}
		
		# Crisis will want to remove the Custodian as a threat
		modifier = { # EED
			factor = 5
			from = { is_galactic_custodian = yes }
			has_ascension_perk = ap_become_the_crisis
			desc = gal_com_target_is_the_custodian
		}

		# Unlikely to use on scary Fallen Empire
		modifier = {
			factor = 0.2
			from = {
				is_fallen_empire = yes
				relative_power = {
					who = prev
					category = fleet
					value = overwhelming
				}
			}
			desc = gal_com_target_is_powerful_fallen_empire
		}

		modifier = {
			factor = 0.5
			from = {
				NOT = { has_ascension_perk = ap_become_the_crisis }
			}
			desc = gal_com_target_does_not_have_crisis_perk
		}

		modifier = {
			factor = 3 # EED 2 -> 3
			from = {
				has_crisis_level = crisis_level_3
			}
			has_intel_level = {
				who = from
				category = government
				level >= 2
			}
			desc = gal_com_crisis_level_3
		}

		modifier = {
			factor = 5 # EED 2 -> 5
			from = {
				has_crisis_level = crisis_level_4
			}
			has_intel_level = { # EED
				who = from
				category = government
				level >= 2
			}
			desc = gal_com_crisis_level_4
		}

		modifier = {
			factor = 10 # EED 5 -> 10
			from = {
				has_crisis_level = crisis_level_5
			}
			has_intel_level = { # EED
				who = from
				category = government
				level >= 2
			}
			desc = gal_com_crisis_level_5
		}
		
		modifier = { # EED
			factor = 0
			is_civic_diplomatic_corps = yes
			desc = gal_com_diplo_civic
			from = {
				NOR = {
					has_ascension_perk = ap_become_the_crisis
					is_homicidal = yes
					AND = {
						is_fallen_empire = yes
						NOT = { has_global_flag = war_in_heaven_ongoing }
					}
				}
			}
		}
		
		modifier = { # EED
			factor = 3
			OR = {
				is_militarist = yes
				is_civic_militarist = yes
			}
			desc = ethic_militarist
		}
		modifier = { # EED
			factor = 0.75
			OR = {
				has_ethic = ethic_pacifist
				has_valid_civic = civic_harm_hive
				has_valid_civic = civic_harm_machine
				has_ai_personality = closed_hive_mind
				has_ai_personality = closed_machine_intelligence
			}
			from = {
				NOT = { has_country_flag = crisis_sphere_revealed }
			}
			desc = ethic_pacifist
		}
		modifier = { # EED
			factor = 0.5
			has_ethic = ethic_fanatic_pacifist
			from = {
				NOT = { has_country_flag = crisis_sphere_revealed }
			}
			desc = ethic_pacifist
		}
		modifier = { # EED
			factor = 10
			has_ascension_perk = ap_defender_of_the_galaxy
			from = {
				OR = {
					has_crisis_level = crisis_level_3
					is_homicidal = yes
				}
			}
			desc = ap_defender_of_the_galaxy
		}

		modifier = { # Daemonic Incursion
			factor = 0.1
			from = {
				has_country_flag = newgen_prescripted_country
				is_ai = yes
			}
			desc = newgen_com_desc_2
		}
	}
}

## Declare Crisis - Empire
# Merge between EED, MECR, Ariphaos
resolution_declare_crisis_empire = {
	icon = "GFX_resolution_declare_crisis"

	resources = {
		category = resolutions
		cost = {
			trigger = { NOT = { is_active_resolution = "resolution_emperor_imperial_ministry_of_defence" } } # MECR
			influence = @resolution_cost_t5
		}
		cost = { # MECR
			trigger = { is_active_resolution = "resolution_emperor_imperial_ministry_of_defence" }
			influence = @resolution_cost_t5_half
		}
	}

	target = yes
	harmful = yes

	valid_target = {
		NOT = { is_same_value = from }
		is_galactic_emperor = no
		OR = {
			is_country_type = default
			AND = {
				is_fallen_empire = yes
				NOT = { has_global_flag = war_in_heaven_ongoing }
			}
		}
		if = { # MECR
			limit = { is_active_resolution = resolution_emperor_the_step_towards_a_united_galaxy }
			is_galactic_community_member = no
		}
		NOT = { has_country_flag = declared_crisis }
	}

	modifier = {
		starbase_shipyard_build_speed_mult = 0.20
		ships_upkeep_mult = -0.1
	}

	effect = {
		custom_tooltip = resolution_declare_crisis_empire_tooltip
		from = { # EED
			custom_tooltip = resolution_declare_crisis_menace_tooltip
		}
		hidden_effect = {
			if = {
				limit = { is_galactic_community_member = yes }
				remove_from_galactic_community = yes
			}
			if = {
				limit = {
					is_galactic_council_established = yes
					is_part_of_galactic_council = yes
				}
				remove_from_galactic_council = yes
			}
			every_subject = {
				if = {
					limit = { is_galactic_community_member = yes }
					remove_from_galactic_community = yes
				}
				if = {
					limit = {
						is_galactic_council_established = yes
						is_part_of_galactic_council = yes
					}
					remove_from_galactic_council = yes
				}
			}

			set_country_flag = declared_crisis
			save_event_target_as = new_crisis
			country_event = { id = crisis.4106 }
			every_playable_country = {
				limit = {
					is_ai = no
					NOT = { is_same_value = prev }
				}
				country_event = { id = crisis.4101 }
			}
			galactic_emperor = {
				save_event_target_as = community_war_leader
			}
			declare_crisis_war_effect = yes
			if = {
				limit = {
					from = { has_ascension_perk = ap_become_the_crisis }
					NOR = {
						is_homicidal = yes
						has_ascension_perk = ap_become_the_crisis
						AND = {
							is_fallen_empire = yes
							NOT = { has_global_flag = war_in_heaven_ongoing }
						}
					}
				}
				from = { complete_crisis_objective = crisobj_perform_upsetting_operations }
			}
		}
		from_pass_resolution_modifier = yes # MECR
	}

	fail_effects = {
		from_fail_resolution_modifier = yes # MECR
	}

	potential = {
		has_galactic_emperor = yes
		has_nemesis = yes
		is_part_of_galactic_council = yes
	}

	ai_weight = {
		base = @resolution_weight_hated

		# Should almost always declare on Crisis countries in end game
		modifier = {
			factor = 50
			from = {
				has_country_flag = crisis_sphere_revealed
			}
			desc = gal_com_crisis_sphere_revealed
		}

		# More likely to declare on very powerful homicidal empires
		modifier = {
			factor = 10
			from = {
				is_homicidal = yes
				relative_power = {
					who = prev
					category = fleet
					value = overwhelming
				}
			}
			desc = gal_com_target_is_very_strong_homicidal_empire
		}
		# More likely to declare on very powerful homicidal empires
		modifier = {
			factor = 5
			from = {
				is_homicidal = yes
				relative_power = {
					who = prev
					category = fleet
					value = superior
				}
			}
			desc = gal_com_target_is_strong_homicidal_empire
		}
		
		# More likely to declare on very powerful assimilator empires
		modifier = { # EED
			factor = 8
			from = {
				is_civic_machine_assimilator = yes
				is_pacifist = no
				relative_power = {
					who = prev
					category = fleet
					value = overwhelming
				}
			}
			desc = gal_com_target_is_strong_assimilator_empire
		}
		# More likely to declare on very powerful assimilator empires
		modifier = { # EED
			factor = 4
			from = {
				is_civic_machine_assimilator = yes
				is_pacifist = no
				relative_power = {
					who = prev
					category = fleet
					value = superior
				}
			}
			desc = gal_com_target_is_strong_assimilator_empire
		}

		# More likely to declare on rivals
		modifier = {
			factor = 5 # EED 2 -> 5
			is_rival = from
			desc = gal_com_target_is_rival
		}
		modifier = { # EED
			factor = 5
			is_at_war_with = from
			desc = gal_com_target_is_rival
		}

		# Never on yourself
		modifier = {
			factor = 0
			is_same_value = from
			desc = gal_com_target_is_me
		}
		
		# Never on your ally
		modifier = { # Ariphaos
			factor = 0
			is_in_federation_with = from
			desc = ariphaos_patch_gal_com_share_federation
		}

		# More likely to declare on empire who hvae cracked a star
		modifier = {
			factor = 6
			from = { has_country_flag = cracked_first_star }
			desc = gal_com_target_has_cracked_stars
		}

		# Should be reluctant to use on normal countries
		modifier = {
			factor = 0.2
			from = { # EED
				NOR = { 
					is_homicidal = yes
					has_country_flag = crisis_sphere_revealed
					has_country_flag = cracked_first_star
					AND = {
						is_civic_machine_assimilator = yes
						is_pacifist = no
					}
				}
			}
			desc = gal_com_target_is_a_normal_empire
		}
		
		modifier = { # EED
			factor = 0.5
			is_civic_machine_assimilator = yes
			from = { is_civic_machine_assimilator = yes }
			desc = gal_com_assimilator_civic
		}

		# Very unlikely to use on Custodian
		modifier = {
			factor = 0.2
			from = { is_galactic_custodian = yes }
			desc = gal_com_target_is_the_custodian
		}

		# Unlikely to use on scary Fallen Empire
		modifier = {
			factor = 0.2
			from = {
				is_fallen_empire = yes
				relative_power = {
					who = prev
					category = fleet
					value = overwhelming
				}
			}
			desc = gal_com_target_is_powerful_fallen_empire
		}

		modifier = { # EED
			factor = 0.5
			from = {
				NOT = { has_ascension_perk = ap_become_the_crisis }
			}
			desc = gal_com_target_does_not_have_crisis_perk
		}

		modifier = { # EED
			factor = 3
			from = {
				has_crisis_level = crisis_level_3
			}
			has_intel_level = {
				who = from
				category = government
				level >= 2
			}
			desc = gal_com_crisis_level_3
		}

		modifier = { # EED
			factor = 5
			from = {
				has_crisis_level = crisis_level_4
			}
			has_intel_level = {
				who = from
				category = government
				level >= 2
			}
			desc = gal_com_crisis_level_4
		}

		modifier = { # EED
			factor = 10
			from = {
				has_crisis_level = crisis_level_5
			}
			has_intel_level = {
				who = from
				category = government
				level >= 2
			}
			desc = gal_com_crisis_level_5
		}
		
		modifier = { # EED
			factor = 0
			is_civic_diplomatic_corps = yes
			desc = gal_com_diplo_civic
			from = {
				NOR = {
					has_ascension_perk = ap_become_the_crisis
					is_homicidal = yes
					AND = {
						is_fallen_empire = yes
						NOT = { has_global_flag = war_in_heaven_ongoing }
					}
				}
			}
		}
		
		modifier = { # EED
			factor = 3
			OR = {
				is_militarist = yes
				is_civic_militarist = yes
			}
			desc = ethic_militarist
		}
		modifier = { # EED
			factor = 0.75
			OR = {
				has_ethic = ethic_pacifist
				has_valid_civic = civic_harm_hive
				has_valid_civic = civic_harm_machine
				has_ai_personality = closed_hive_mind
				has_ai_personality = closed_machine_intelligence
			}
			from = {
				NOT = { has_country_flag = crisis_sphere_revealed }
			}
			desc = ethic_pacifist
		}
		modifier = { # EED
			factor = 0.5
			has_ethic = ethic_fanatic_pacifist
			from = {
				NOT = { has_country_flag = crisis_sphere_revealed }
			}
			desc = ethic_pacifist
		}
		modifier = { # EED
			factor = 10
			has_ascension_perk = ap_defender_of_the_galaxy
			from = {
				OR = {
					has_crisis_level = crisis_level_3
					is_homicidal = yes
				}
			}
			desc = ap_defender_of_the_galaxy
		}
	}
}

## Development Aides
# Merge between EED, Scripted Trigger Undercoat
resolution_development_aides = {
	icon = "GFX_resolution_development_aides"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t4
		}
	}
	target = no

	triggered_modifier = {
		potential = {
			is_part_of_galactic_council = yes
		}
		modifier = {
			development_aides_counselor = 1
		}
	}

	triggered_modifier = {
		potential = {
			is_part_of_galactic_council = no
		}
		modifier = {
			development_aides_regular = 1
		}
	}

	effect = {
		custom_tooltip = resolution_development_aides_tooltip
		hidden_effect = {
			set_global_flag = galactic_community_resolution_passed
			set_timed_country_flag = { flag = galactic_community_resolution_passed_development_aides days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_passed_diplomatic_weight
				days = 2200
			}
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_development_aides days = @resolution_flag_timer }
			add_modifier = {
				modifier = resolution_failed_diplomatic_weight
				days = 2200
			}
		}
	}

	potential = {
		has_tradition = tr_politics_finish
	}

	allow = {
		custom_tooltip = {
			text = "resolution_already_active"
		}
		NOT = {
			is_active_resolution = resolution_development_aides
		}
		is_galactic_council_established = yes
	}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 1.5
			OR = {
				has_civic = civic_diplomatic_corps
				has_civic = civic_public_relations_specialists
				has_civic = civic_hive_empath
				is_servitor_empire = yes # STU
				has_civic = civic_machine_exploration_protocol
			}
			desc = gal_com_opposing_civics
		}
		
		modifier = { # EED
			factor = 1.5
			is_civic_diplomatic_corps = yes
			desc = gal_com_diplo_civic
		}

		modifier = { # EED
			factor = 1.5
			is_civic_machine_servitor = yes
			desc = civic_machine_servitor
		}

		modifier = {
			factor = 1.2
			is_authoritarian = yes
			desc = ethic_authoritarian
		}

		modifier = {
			factor = 2
			OR = {
				is_part_of_galactic_council = yes
				AND = {
					is_subject = yes
					overlord = {
						opinion_level = { who = prev level >= neutral }
						is_part_of_galactic_council = yes
					}
				}
			}
			desc = gal_com_they_or_overlord_on_galatic_council
		}

		modifier = {
			factor = 0.8
			galactic_community_rank > 5
			NAND = {
				is_subject = yes
				overlord = {
					opinion_level = { who = prev level >= neutral }
					is_part_of_galactic_council = yes
				}
			}
			desc = gal_com_they_nor_overlord_not_on_galatic_council
		}

		modifier = {
			factor = 10
			is_part_of_galactic_council = no
			OR = {
				has_deficit = minerals
				has_deficit = energy
				has_deficit = food
			}
			desc = unstable_economy
		}
	}
}



##################################################
## Copied Resolutions
##################################################

### Healthcare (NGS Version)
# Copy of all the healthcare repeals, without rename so they take priority over EED versions.
resolution_healthcare_repeal_1 = {
	icon = "GFX_repeal_blue"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t1
		}
	}
	target = no

	fire_and_forget = yes

	effect = {
		custom_tooltip = resolution_healthcare_repeal_1_effect_success
		hidden_effect = {
			cancel_resolution = "resolution_healthcare_1"
			set_timed_country_flag = { flag = galactic_community_resolution_passed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	potential = {
		is_active_resolution = "resolution_healthcare_1"
	}

	allow = {}

	ai_weight = {
		base = @resolution_weight_disliked

		modifier = {
			factor = 0.5
			is_materialist = yes
			desc = ethic_materialist
		}
		modifier = {
			factor = 3
			is_xenophobe = yes
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 1.5
			is_spiritualist = yes
			is_egalitarian = no
			desc = ethic_spiritualist
		}
		modifier = {
			factor = 0.25
			is_xenophile = yes
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0.85
			is_egalitarian = yes
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 1.25
			has_valid_civic = civic_dystopian_society
			desc = civic_dystopian_society
		}
		modifier = {
			factor = 1.25
			is_megacorp = yes
			desc = gov_megacorporation
		}
		modifier = {
			factor = 0.75
			has_valid_civic = civic_shared_burden
			desc = civic_shared_burden
		}
	}
}

resolution_healthcare_repeal_2 = {
	icon = "GFX_repeal_blue"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t2
		}
	}
	target = no

	fire_and_forget = yes

	effect = {
		custom_tooltip = resolution_healthcare_repeal_2_effect_success
		hidden_effect = {
			cancel_resolution = "resolution_healthcare_2"
			set_timed_country_flag = { flag = galactic_community_resolution_passed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	potential = {
		is_active_resolution = "resolution_healthcare_2"
	}

	modifier = {
		resolution_healthcare_1 = 1
	}

	allow = {}

	ai_weight = {
		base = @resolution_weight_unpopular

		modifier = {
			factor = 0.5
			is_materialist = yes
			desc = ethic_materialist
		}
		modifier = {
			factor = 3
			is_xenophobe = yes
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 1.5
			is_spiritualist = yes
			is_egalitarian = no
			desc = ethic_spiritualist
		}
		modifier = {
			factor = 0.25
			is_xenophile = yes
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0.85
			is_egalitarian = yes
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 1.25
			has_valid_civic = civic_dystopian_society
			desc = civic_dystopian_society
		}
		modifier = {
			factor = 1.25
			is_megacorp = yes
			desc = gov_megacorporation
		}
		modifier = {
			factor = 0.75
			has_valid_civic = civic_shared_burden
			desc = civic_shared_burden
		}
	}
}

resolution_healthcare_repeal_3 = {
	icon = "GFX_repeal_blue"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}
	target = no

	fire_and_forget = yes

	effect = {
		custom_tooltip = resolution_healthcare_repeal_3_effect_success
		hidden_effect = {
			cancel_resolution = "resolution_healthcare_3"
			set_timed_country_flag = { flag = galactic_community_resolution_passed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	potential = {
		is_active_resolution = "resolution_healthcare_3"
	}

	modifier = {
		resolution_healthcare_1 = 1
		resolution_healthcare_2 = 1
	}

	allow = {}

	ai_weight = {
		base = @resolution_weight_unpopular

		modifier = {
			factor = 0.5
			is_materialist = yes
			desc = ethic_materialist
		}
		modifier = {
			factor = 3
			is_xenophobe = yes
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 1.5
			is_spiritualist = yes
			is_egalitarian = no
			desc = ethic_spiritualist
		}
		modifier = {
			factor = 0.25
			is_xenophile = yes
			is_megacorp = no
			desc = ethic_xenophile
		}
		modifier = {
			factor = 2
			is_megacorp = yes
			desc = gov_megacorporation
		}
		modifier = {
			factor = 0.85
			is_egalitarian = yes
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 1.25
			has_valid_civic = civic_dystopian_society
			desc = civic_dystopian_society
		}
		modifier = {
			factor = 0.75
			has_valid_civic = civic_shared_burden
			desc = civic_shared_burden
		}
	}
}

resolution_healthcare_repeal_4 = {
	icon = "GFX_repeal_blue"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t4
		}
	}
	target = no

	fire_and_forget = yes

	effect = {
		custom_tooltip = resolution_healthcare_repeal_4_effect_success
		hidden_effect = {
			cancel_resolution = "resolution_healthcare_4"
			set_timed_country_flag = { flag = galactic_community_resolution_passed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	potential = {
		is_active_resolution = "resolution_healthcare_4"
	}

	modifier = {
		resolution_healthcare_1 = 1
		resolution_healthcare_2 = 1
		resolution_healthcare_3 = 1
	}

	allow = {}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 0.5
			is_materialist = yes
			desc = ethic_materialist
		}
		modifier = {
			factor = 3
			is_xenophobe = yes
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 1.5
			is_spiritualist = yes
			is_egalitarian = no
			desc = ethic_spiritualist
		}
		modifier = {
			factor = 0.25
			is_xenophile = yes
			is_megacorp = no
			desc = ethic_xenophile
		}
		modifier = {
			factor = 2
			is_megacorp = yes
			desc = gov_megacorporation
		}
		modifier = {
			factor = 0.85
			is_egalitarian = yes
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 1.25
			has_valid_civic = civic_dystopian_society
			desc = civic_dystopian_society
		}
		modifier = {
			factor = 0.75
			has_valid_civic = civic_shared_burden
			desc = civic_shared_burden
		}
	}
}

resolution_healthcare_repeal_5 = {
	icon = "GFX_repeal_blue"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t5
		}
	}
	target = no

	fire_and_forget = yes

	effect = {
		custom_tooltip = resolution_healthcare_repeal_5_effect_success
		hidden_effect = {
			cancel_resolution = "resolution_healthcare_5"
			set_timed_country_flag = { flag = galactic_community_resolution_passed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	potential = {
		is_active_resolution = "resolution_healthcare_5"
	}

	modifier = {
		resolution_healthcare_1 = 1
		resolution_healthcare_2 = 1
		resolution_healthcare_3 = 1
		resolution_healthcare_4 = 1
	}

	allow = {}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 0.5
			is_materialist = yes
			desc = ethic_materialist
		}
		modifier = {
			factor = 3
			is_xenophobe = yes
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 1.5
			is_spiritualist = yes
			is_egalitarian = no
			desc = ethic_spiritualist
		}
		modifier = {
			factor = 0.25
			is_xenophile = yes
			is_megacorp = no
			desc = ethic_xenophile
		}
		modifier = {
			factor = 2
			is_megacorp = yes
			desc = gov_megacorporation
		}
		modifier = {
			factor = 0.85
			is_egalitarian = yes
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 1.25
			has_valid_civic = civic_dystopian_society
			desc = civic_dystopian_society
		}
		modifier = {
			factor = 0.75
			has_valid_civic = civic_shared_burden
			desc = civic_shared_burden
		}
	}
}

resolution_healthcare_repeal_6 = {
	icon = "GFX_repeal_blue"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t6
		}
	}
	target = no

	fire_and_forget = yes

	effect = {
		custom_tooltip = resolution_healthcare_repeal_6_effect_success
		hidden_effect = {
			cancel_resolution = "resolution_healthcare_6"
			set_timed_country_flag = { flag = galactic_community_resolution_passed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	fail_effects = {
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	potential = {
		is_active_resolution = "resolution_healthcare_6"
	}

	modifier = {
		resolution_healthcare_1 = 1
		resolution_healthcare_2 = 1
		resolution_healthcare_3 = 1
		resolution_healthcare_4 = 1
		resolution_healthcare_5 = 1
	}

	allow = {}

	ai_weight = {
		base = @resolution_weight_popular

		modifier = {
			factor = 0.5
			is_materialist = yes
			desc = ethic_materialist
		}
		modifier = {
			factor = 3
			is_xenophobe = yes
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 1.5
			is_spiritualist = yes
			is_egalitarian = no
			desc = ethic_spiritualist
		}
		modifier = {
			factor = 0.25
			is_xenophile = yes
			is_megacorp = no
			desc = ethic_xenophile
		}
		modifier = {
			factor = 2
			is_megacorp = yes
			desc = gov_megacorporation
		}
		modifier = {
			factor = 0.85
			is_egalitarian = yes
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 1.25
			has_valid_civic = civic_dystopian_society
			desc = civic_dystopian_society
		}
		modifier = {
			factor = 0.75
			has_valid_civic = civic_shared_burden
			desc = civic_shared_burden
		}
	}
}

### Healthcare (EED Version)
# Copy of all the healthcare repeals, renamed so they can coexist with NGS.
resolution_healthcare_eed_repeal_1 = {
	icon = "GFX_repeal_blue"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t1
		}
	}
	target = no
	fire_and_forget = yes

	effect = {
		set_timed_country_flag = { flag = galcom_resolution_passed_anti_xenoist days = 7200 }
		set_timed_country_flag = { flag = galcom_resolution_passed_anti_progressivee days = 7200 }
		hidden_effect = { add_modifier = { modifier = resolution_passed_diplomatic_weight days = 2200 } }
		custom_tooltip = resolution_healthcare_repeal_1_effect_success
		hidden_effect = {
			cancel_resolution = "resolution_healthcare_board_of_health"
			set_timed_country_flag = { flag = galactic_community_resolution_passed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	fail_effects = {
		hidden_effect = { add_modifier = { modifier = resolution_failed_diplomatic_weight days = 2200 } }
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	potential = {
		is_active_resolution = "resolution_healthcare_board_of_health"
	}

	ai_weight = {
		base = @resolution_weight_unpopular
		modifier = {
			factor = 10
			has_dystopian_society = yes
			desc = civic_dystopian_society
		}
		modifier = {
			factor = 0
			is_hive_empire = yes
			desc = auth_hive_mind
		}
		modifier = {
			factor = 0
			is_civic_health = yes
			desc = gal_com_health_civic
		}
		modifier = {
			factor = 0
			is_civic_machine_servitor = yes
			desc = civic_machine_servitor
		}
		modifier = {
			factor = 0.5
			is_xenophile = yes
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0
			has_ethic = ethic_fanatic_xenophile
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0.5
			is_egalitarian = yes
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 0
			has_ethic = ethic_fanatic_egalitarian
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 0.5
			is_civic_has_meritocracy = yes
			desc = gal_com_meritocracy_civic
		}
		modifier = {
			factor = 0.75
			is_civic_environmentalist = yes
			desc = gal_com_environment_civic
		}
		modifier = {
			factor = 0.85
			is_erudite_explorers = yes
			desc = personality_erudite_explorers
		}
		modifier = {
			factor = 0.85
			is_civic_diplomatic_corps = yes
			desc = gal_com_diplo_civic
		}
		modifier = {
			factor = 0.85
			is_civic_efficient_bureaucracy = yes
			desc = gal_com_efficient_civic
		}
		modifier = {
			factor = 1.25
			is_honorbound_warriors = yes
			desc = personality_honorbound_warriors
		}
		modifier = {
			factor = 0
			is_shared_burden_empire = yes
			desc = civic_shared_burden
		}
		modifier = {
			factor = 2
			is_capitalist = yes
			desc = auth_corporate
			is_shared_burden_empire = no
		}
		modifier = {
			factor = 1.5
			is_civic_cutthroat_politics = yes
			desc = gal_com_cutthroat_civic
		}
		modifier = {
			factor = 2
			OR = { is_xenophobe = yes is_xenophobic_isolationists = yes }
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 2
			has_ethic = ethic_fanatic_xenophobe
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 2
			is_civic_has_elite  = yes
			desc = gal_com_elite_civic
		}
		modifier = {
			factor = 2
			is_civic_authoritarian = yes
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 3
			is_authoritarian  = yes
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 3
			has_ethic = ethic_fanatic_authoritarian
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 5
			is_origin_syncretic_livestock = yes
			desc = origin_syncretic_livestock
		}
		modifier = {
			factor = 3
			is_robot_empire = yes
			desc = auth_machine_intelligence
			NOT = {
				any_owned_species = {
					is_sapient = yes
					NOR = {
						is_archetype = ROBOT
						is_archetype = MACHINE
					}
				}
			}
		}
	}
}

resolution_healthcare_eed_repeal_2 = {
	icon = "GFX_repeal_blue"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t2
		}
	}
	target = no
	fire_and_forget = yes

	effect = {
		set_timed_country_flag = { flag = galcom_resolution_passed_anti_xenoist days = 7200 }
		set_timed_country_flag = { flag = galcom_resolution_passed_anti_progressivee days = 7200 }
		hidden_effect = { add_modifier = { modifier = resolution_passed_diplomatic_weight days = 2200 } }
		custom_tooltip = resolution_healthcare_repeal_2_effect_success
		hidden_effect = {
			cancel_resolution = "resolution_healthcare_xenomedical_research"
			set_timed_country_flag = { flag = galactic_community_resolution_passed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	fail_effects = {
		hidden_effect = { add_modifier = { modifier = resolution_failed_diplomatic_weight days = 2200 } }
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	potential = {
		is_active_resolution = "resolution_healthcare_xenomedical_research"
	}

	modifier = {
		resolution_healthcare_board_of_health = 1
	}

	allow = {}

	ai_weight = {
		base = @resolution_weight_unpopular
		modifier = {
			factor = 10
			has_dystopian_society = yes
			desc = civic_dystopian_society
		}
		modifier = {
			factor = 0
			is_hive_empire = yes
			desc = auth_hive_mind
		}
		modifier = {
			factor = 0
			is_civic_health = yes
			desc = gal_com_health_civic
		}
		modifier = {
			factor = 0
			is_civic_machine_servitor = yes
			desc = civic_machine_servitor
		}
		modifier = {
			factor = 0.5
			is_xenophile = yes
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0
			has_ethic = ethic_fanatic_xenophile
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0.5
			is_egalitarian = yes
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 0
			has_ethic = ethic_fanatic_egalitarian
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 0.5
			is_civic_has_meritocracy = yes
			desc = gal_com_meritocracy_civic
		}
		modifier = {
			factor = 0.75
			is_civic_environmentalist = yes
			desc = gal_com_environment_civic
		}
		modifier = {
			factor = 0.85
			is_erudite_explorers = yes
			desc = personality_erudite_explorers
		}
		modifier = {
			factor = 0.85
			is_civic_diplomatic_corps = yes
			desc = gal_com_diplo_civic
		}
		modifier = {
			factor = 0.85
			is_civic_efficient_bureaucracy = yes
			desc = gal_com_efficient_civic
		}
		modifier = {
			factor = 1.25
			is_honorbound_warriors = yes
			desc = personality_honorbound_warriors
		}
		modifier = {
			factor = 0
			is_shared_burden_empire = yes
			desc = civic_shared_burden
		}
		modifier = {
			factor = 2
			is_capitalist = yes
			desc = auth_corporate
			is_shared_burden_empire = no
		}
		modifier = {
			factor = 1.5
			is_civic_cutthroat_politics = yes
			desc = gal_com_cutthroat_civic
		}
		modifier = {
			factor = 2
			OR = { is_xenophobe = yes is_xenophobic_isolationists = yes }
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 2
			has_ethic = ethic_fanatic_xenophobe
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 2
			is_civic_has_elite  = yes
			desc = gal_com_elite_civic
		}
		modifier = {
			factor = 2
			is_civic_authoritarian = yes
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 3
			is_authoritarian  = yes
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 3
			has_ethic = ethic_fanatic_authoritarian
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 5
			is_origin_syncretic_livestock = yes
			desc = origin_syncretic_livestock
		}
		modifier = {
			factor = 3
			is_robot_empire = yes
			desc = auth_machine_intelligence
			NOT = {
				any_owned_species = {
					is_sapient = yes
					NOR = {
						is_archetype = ROBOT
						is_archetype = MACHINE
					}
				}
			}
		}
	}
}

resolution_healthcare_eed_repeal_3 = {
	icon = "GFX_repeal_blue"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}
	target = no
	fire_and_forget = yes

	effect = {
		set_timed_country_flag = { flag = galcom_resolution_passed_anti_xenoist days = 7200 }
		set_timed_country_flag = { flag = galcom_resolution_passed_anti_progressivee days = 7200 }
		if = {
			limit = { has_global_flag = expanded_pops_active }
			custom_tooltip = resolution_healthcare_xenomedical_research_tooltip_pops
		}
		else = {
			custom_tooltip = resolution_healthcare_xenomedical_research_tooltip_no_pops
		}
		hidden_effect = { add_modifier = { modifier = resolution_passed_diplomatic_weight days = 2200 } }
		custom_tooltip = resolution_healthcare_repeal_3_effect_success
		hidden_effect = {
			cancel_resolution = "resolution_healthcare_war_relief"
			set_timed_country_flag = { flag = galactic_community_resolution_passed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	fail_effects = {
		hidden_effect = { add_modifier = { modifier = resolution_failed_diplomatic_weight days = 2200 } }
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	potential = {
		is_active_resolution = "resolution_healthcare_war_relief"
	}

	modifier = {
		resolution_healthcare_board_of_health = 1
		resolution_healthcare_xenomedical_research = 1
	}

	allow = {}

	ai_weight = {
		base = @resolution_weight_unpopular
		modifier = {
			factor = 10
			has_dystopian_society = yes
			desc = civic_dystopian_society
		}
		modifier = {
			factor = 10
			desc = gal_com_in_breach_of_proposed_resolution
			in_breach_of = resolution_healthcare_war_relief
		}
		
		modifier = {
			factor = 2
			desc = gal_com_ally_in_breach_of_proposed_resolution
			any_federation_ally = {
				NOT = {
					federation = { has_federation_type = hegemony_federation }
				}
				in_breach_of = resolution_healthcare_war_relief
			}
		}
		modifier = {
			factor = 0
			is_hive_empire = yes
			desc = auth_hive_mind
		}
		modifier = {
			factor = 0
			is_civic_health = yes
			desc = gal_com_health_civic
		}
		modifier = {
			factor = 0
			is_civic_machine_servitor = yes
			desc = civic_machine_servitor
		}
		modifier = {
			factor = 0.5
			is_xenophile = yes
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0
			has_ethic = ethic_fanatic_xenophile
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0.5
			is_egalitarian = yes
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 0
			has_ethic = ethic_fanatic_egalitarian
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 0.5
			is_civic_has_meritocracy = yes
			desc = gal_com_meritocracy_civic
		}
		modifier = {
			factor = 0.75
			is_civic_environmentalist = yes
			desc = gal_com_environment_civic
		}
		modifier = {
			factor = 0.85
			is_erudite_explorers = yes
			desc = personality_erudite_explorers
		}
		modifier = {
			factor = 0.85
			is_civic_diplomatic_corps = yes
			desc = gal_com_diplo_civic
		}
		modifier = {
			factor = 0.85
			is_civic_efficient_bureaucracy = yes
			desc = gal_com_efficient_civic
		}
		modifier = {
			factor = 1.25
			is_honorbound_warriors = yes
			desc = personality_honorbound_warriors
		}
		modifier = {
			factor = 0
			is_shared_burden_empire = yes
			desc = civic_shared_burden
		}
		modifier = {
			factor = 2
			is_capitalist = yes
			desc = auth_corporate
			is_shared_burden_empire = no
		}
		modifier = {
			factor = 1.5
			is_civic_cutthroat_politics = yes
			desc = gal_com_cutthroat_civic
		}
		modifier = {
			factor = 2
			OR = { is_xenophobe = yes is_xenophobic_isolationists = yes }
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 2
			has_ethic = ethic_fanatic_xenophobe
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 2
			is_civic_has_elite  = yes
			desc = gal_com_elite_civic
		}
		modifier = {
			factor = 2
			is_civic_authoritarian = yes
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 3
			is_authoritarian  = yes
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 3
			has_ethic = ethic_fanatic_authoritarian
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 5
			is_origin_syncretic_livestock = yes
			desc = origin_syncretic_livestock
		}
		modifier = {
			factor = 3
			is_robot_empire = yes
			desc = auth_machine_intelligence
			NOT = {
				any_owned_species = {
					is_sapient = yes
					NOR = {
						is_archetype = ROBOT
						is_archetype = MACHINE
					}
				}
			}
		}
	}
}

resolution_healthcare_eed_repeal_4 = {
	icon = "GFX_repeal_blue"

	potential = {
		has_federations_dlc = yes
	}

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t4
		}
	}
	target = no
	fire_and_forget = yes

	effect = {
		set_timed_country_flag = { flag = galcom_resolution_passed_anti_xenoist days = 7200 }
		set_timed_country_flag = { flag = galcom_resolution_passed_anti_progressivee days = 7200 }
		custom_tooltip = resolution_healthcare_war_relief_tooltip
		hidden_effect = { add_modifier = { modifier = resolution_passed_diplomatic_weight days = 2200 } }
		custom_tooltip = resolution_healthcare_repeal_4_effect_success
		hidden_effect = {
			cancel_resolution = "resolution_healthcare_clonal_medicine"
			set_timed_country_flag = { flag = galactic_community_resolution_passed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	fail_effects = {
		hidden_effect = { add_modifier = { modifier = resolution_failed_diplomatic_weight days = 2200 } }
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	potential = {
		is_active_resolution = "resolution_healthcare_clonal_medicine"
	}

	modifier = {
		resolution_healthcare_board_of_health = 1
		resolution_healthcare_xenomedical_research = 1
		resolution_healthcare_war_relief = 1
	}

	allow = {}

	ai_weight = {
		base = @resolution_weight_unpopular
		modifier = {
			factor = 10
			has_dystopian_society = yes
			desc = civic_dystopian_society
		}
		modifier = {
			factor = 5
			is_private_healthcare_empire = yes
			desc = civic_private_healthcare_corporate
		}
		modifier = {
			factor = 10
			desc = gal_com_in_breach_of_proposed_resolution
			in_breach_of = resolution_healthcare_clonal_medicine
		}
		
		modifier = {
			factor = 2
			desc = gal_com_ally_in_breach_of_proposed_resolution
			any_federation_ally = {
				NOT = {
					federation = { has_federation_type = hegemony_federation }
				}
				in_breach_of = resolution_healthcare_clonal_medicine
			}
		}
		modifier = {
			factor = 5
			OR = {
				has_civic = civic_living_hosts
				is_current_or_former_necrophage_empire = yes
			}
			desc = gal_com_supporting_civics
		}
		modifier = {
			factor = 0
			is_hive_empire = yes
			desc = auth_hive_mind
		}
		modifier = {
			factor = 0
			is_civic_health = yes
			NOT = { is_private_healthcare_empire = yes }
			desc = gal_com_health_civic
		}
		modifier = {
			factor = 0
			is_civic_machine_servitor = yes
			desc = civic_machine_servitor
		}
		modifier = {
			factor = 0.5
			is_xenophile = yes
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0
			has_ethic = ethic_fanatic_xenophile
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0.5
			is_egalitarian = yes
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 0
			has_ethic = ethic_fanatic_egalitarian
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 0.5
			is_civic_has_meritocracy = yes
			desc = gal_com_meritocracy_civic
		}
		modifier = {
			factor = 0.75
			is_civic_environmentalist = yes
			desc = gal_com_environment_civic
		}
		modifier = {
			factor = 0.85
			is_erudite_explorers = yes
			desc = personality_erudite_explorers
		}
		modifier = {
			factor = 0.85
			is_civic_diplomatic_corps = yes
			desc = gal_com_diplo_civic
		}
		modifier = {
			factor = 0.85
			is_civic_efficient_bureaucracy = yes
			desc = gal_com_efficient_civic
		}
		modifier = {
			factor = 1.25
			is_honorbound_warriors = yes
			desc = personality_honorbound_warriors
		}
		modifier = {
			factor = 0
			is_shared_burden_empire = yes
			desc = civic_shared_burden
		}
		modifier = {
			factor = 2
			is_capitalist = yes
			desc = auth_corporate
			is_shared_burden_empire = no
		}
		modifier = {
			factor = 1.5
			is_civic_cutthroat_politics = yes
			desc = gal_com_cutthroat_civic
		}
		modifier = {
			factor = 2
			OR = { is_xenophobe = yes is_xenophobic_isolationists = yes }
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 2
			has_ethic = ethic_fanatic_xenophobe
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 2
			is_civic_has_elite  = yes
			desc = gal_com_elite_civic
		}
		modifier = {
			factor = 2
			is_civic_authoritarian = yes
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 3
			is_authoritarian  = yes
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 3
			has_ethic = ethic_fanatic_authoritarian
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 5
			is_origin_syncretic_livestock = yes
			desc = origin_syncretic_livestock
		}
		modifier = {
			factor = 0
			OR = {
				is_clone_army_empire = yes
				has_origin = origin_clones
				has_origin = origin_hive_queen
			}
			desc = gal_com_opposing_civics
		}
		modifier = {
			factor = 3
			is_robot_empire = yes
			desc = auth_machine_intelligence
			NOT = {
				any_owned_species = {
					is_sapient = yes
					NOR = {
						is_archetype = ROBOT
						is_archetype = MACHINE
					}
				}
			}
		}
	}
}

resolution_healthcare_eed_repeal_5 = {
	icon = "GFX_repeal_blue"

	potential = {
		has_federations_dlc = yes
	}

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t5
		}
	}
	target = no
	fire_and_forget = yes

	effect = {
		set_timed_country_flag = { flag = galcom_resolution_passed_anti_xenoist days = 7200 }
		set_timed_country_flag = { flag = galcom_resolution_passed_anti_progressivee days = 7200 }
		if = {
			limit = { has_global_flag = expanded_pops_active }
			custom_tooltip = resolution_healthcare_clonal_medicine_tooltip_pops
		}
		else = {
			custom_tooltip = resolution_healthcare_clonal_medicine_tooltip_no_pops
		}
		hidden_effect = { add_modifier = { modifier = resolution_passed_diplomatic_weight days = 2200 } }
		custom_tooltip = resolution_healthcare_repeal_5_effect_success
		hidden_effect = {
			cancel_resolution = "resolution_healthcare_universal_healthcare"
			set_timed_country_flag = { flag = galactic_community_resolution_passed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	fail_effects = {
		hidden_effect = { add_modifier = { modifier = resolution_failed_diplomatic_weight days = 2200 } }
		hidden_effect = {
			set_timed_country_flag = { flag = galactic_community_resolution_failed_healthcare_repeal days = @resolution_flag_timer }
		}
	}

	potential = {
		is_active_resolution = "resolution_healthcare_universal_healthcare"
	}


	modifier = {
		resolution_healthcare_board_of_health = 1
		resolution_healthcare_xenomedical_research = 1
		resolution_healthcare_war_relief = 1
		resolution_healthcare_clonal_medicine = 1
	}

	allow = {}

	ai_weight = {
		base = @resolution_weight_unpopular
		modifier = {
			factor = 10
			has_dystopian_society = yes
			desc = civic_dystopian_society
		}
		modifier = {
			factor = 10
			is_private_healthcare_empire = yes
			desc = civic_private_healthcare_corporate
		}
		modifier = {
			factor = 10
			desc = gal_com_in_breach_of_proposed_resolution
			in_breach_of = resolution_healthcare_universal_healthcare
		}
		
		modifier = {
			factor = 2
			desc = gal_com_ally_in_breach_of_proposed_resolution
			any_federation_ally = {
				NOT = {
					federation = { has_federation_type = hegemony_federation }
				}
				in_breach_of = resolution_healthcare_universal_healthcare
			}
		}
		modifier = {
			factor = 5
			OR = {
				has_civic = civic_living_hosts
				is_current_or_former_necrophage_empire = yes
			}
			desc = gal_com_supporting_civics
		}
		modifier = {
			factor = 0
			is_hive_empire = yes
			desc = auth_hive_mind
		}
		modifier = {
			factor = 0
			is_civic_health = yes
			desc = gal_com_health_civic
		}
		modifier = {
			factor = 0
			is_civic_machine_servitor = yes
			desc = civic_machine_servitor
		}
		modifier = {
			factor = 0.5
			is_xenophile = yes
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0
			has_ethic = ethic_fanatic_xenophile
			desc = ethic_xenophile
		}
		modifier = {
			factor = 0.5
			is_egalitarian = yes
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 0
			has_ethic = ethic_fanatic_egalitarian
			desc = ethic_egalitarian
		}
		modifier = {
			factor = 0.5
			is_civic_has_meritocracy = yes
			desc = gal_com_meritocracy_civic
		}
		modifier = {
			factor = 0.75
			is_civic_environmentalist = yes
			desc = gal_com_environment_civic
		}
		modifier = {
			factor = 0.85
			is_erudite_explorers = yes
			desc = personality_erudite_explorers
		}
		modifier = {
			factor = 0.85
			is_civic_diplomatic_corps = yes
			desc = gal_com_diplo_civic
		}
		modifier = {
			factor = 0.85
			is_civic_efficient_bureaucracy = yes
			desc = gal_com_efficient_civic
		}
		modifier = {
			factor = 1.25
			is_honorbound_warriors = yes
			desc = personality_honorbound_warriors
		}
		modifier = {
			factor = 0
			is_shared_burden_empire = yes
			desc = civic_shared_burden
		}
		modifier = {
			factor = 2
			is_capitalist = yes
			desc = auth_corporate
			is_shared_burden_empire = no
		}
		modifier = {
			factor = 1.5
			is_civic_cutthroat_politics = yes
			desc = gal_com_cutthroat_civic
		}
		modifier = {
			factor = 2
			OR = { is_xenophobe = yes is_xenophobic_isolationists = yes }
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 2
			has_ethic = ethic_fanatic_xenophobe
			desc = ethic_xenophobe
		}
		modifier = {
			factor = 2
			is_civic_has_elite  = yes
			desc = gal_com_elite_civic
		}
		modifier = {
			factor = 2
			is_civic_authoritarian = yes
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 3
			is_authoritarian  = yes
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 3
			has_ethic = ethic_fanatic_authoritarian
			desc = ethic_authoritarian
		}
		modifier = {
			factor = 5
			is_origin_syncretic_livestock = yes
			desc = origin_syncretic_livestock
		}
		modifier = {
			factor = 3
			is_robot_empire = yes
			desc = auth_machine_intelligence
			NOT = {
				any_owned_species = {
					is_sapient = yes
					NOR = {
						is_archetype = ROBOT
						is_archetype = MACHINE
					}
				}
			}
		}
	}
}
