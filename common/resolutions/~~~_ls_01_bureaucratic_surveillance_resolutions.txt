##########################################################################
# Limitless Stellaris - Bureaucratic Surveillance Resolutions
##########################################################################

# Vanilla Variables
#@resolution_weight_hated = 3
#@resolution_weight_disliked = 4
#@resolution_weight_unpopular = 5
#@resolution_weight_normal = 6
#@resolution_weight_popular = 6.5
#@resolution_weight_loved = 7
#@resolution_weight_fever = 10 # MECR
#
#@resolution_cost_t1 = 100
#@resolution_cost_t2 = 150
#@resolution_cost_t3 = 200
#@resolution_cost_t4 = 250
#@resolution_cost_t5 = 300
#@resolution_cost_denounce = 25
#
#@resolution_flag_timer = 360
#
# MECR Variables
#@resolution_cost_t1_half = 50
#@resolution_cost_t2_half = 75
#@resolution_cost_t3_half = 100
#@resolution_cost_t4_half = 125
#@resolution_cost_t5_half = 150
#@resolution_cost_denounce_half = 12.5

##################################################
## Bureaucratic Surveillance
##################################################

## Bureaucratic Surveillance - Administrative Insight
# Merge between EED, MECR
resolution_bureaucraticsurveillance_administrative_insight = {
	icon = "GFX_resolution_bureaucratic_surveillance"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t1
		}
	}

	target = no
	level = 1

	potential = {
		has_overlord_dlc = yes
	}

	allow = {
		custom_tooltip = { # MECR
			fail_text = "resolution_already_in_lower_house_session"
			NOT = { has_global_flag = lh_recent_resolution_bureaucraticsurveillance_administrative_insight }
		}
		is_overlord = yes
		custom_tooltip = {
			fail_text = "resolution_already_active"
			NOR = {
				is_active_resolution = "resolution_bureaucraticsurveillance_administrative_insight"
				is_active_resolution = "resolution_bureaucraticsurveillance_borderless_authority"
				is_active_resolution = "resolution_bureaucraticsurveillance_personal_oversight"
			}
		}
	}

	effect = {
		galcom_success_effect = { FLAG = galactic_community_resolution_passed_bureaucraticsurveillance }
		custom_tooltip = galcom_tooltip_ethics_tier_1
		hidden_effect = {
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_progressive days = 7200 } # EED
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_xenoist days = 7200 } # EED
			every_galcom_member = {
				limit = {
					is_subject = yes
				}
				galcom_subject_ethic_modifier_effect = yes
			}
		}
	}

	fail_effects = {
		galcom_fail_effects = { FLAG = galactic_community_resolution_failed_bureaucraticsurveillance }
	}

	modifier = {
		resolution_bureaucraticsurveillance_administrative_insight = 1
	}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 0.25
			is_subject = yes
			desc = galcom_is_subject
		}

		modifier = {
			factor = 3
			is_overlord = yes
			is_xenophile = no
			is_egalitarian = no
			desc = galcom_is_overlord
		}

		modifier = {
			factor = 0.5
			is_egalitarian = yes
			desc = ethic_egalitarian
		}

		modifier = {
			factor = 2
			is_authoritarian = yes
			desc = ethic_authoritarian
		}

		modifier = {
			factor = 2
			is_xenophobe = yes
			is_subject = no
			desc = ethic_xenophobe
		}
		
		modifier = { # EED
			factor = 1.5
			is_civic_expansionist = yes
			desc = gal_com_expansion_civic
		}
		
		modifier = { # EED
			factor = 2
			is_civic_has_elite = yes
			desc = gal_com_elite_civic
		}

		modifier = {
			factor = 0.5
			has_civic = civic_feudal_realm
			desc = civic_feudal_realm
		}

		modifier = {
			factor = 0.5
			has_civic = civic_franchising
			desc = civic_franchising
		}
	}
}

## Bureaucratic Surveillance - Borderless Authority
# Merge between EED, MECR
resolution_bureaucraticsurveillance_borderless_authority = {
	icon = "GFX_resolution_bureaucratic_surveillance"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t2
		}
	}

	target = no
	level = 2

	potential = {
		has_overlord_dlc = yes
	}

	allow = {
		custom_tooltip = { # MECR
			fail_text = "resolution_already_in_lower_house_session"
			NOT = { has_global_flag = lh_recent_resolution_bureaucraticsurveillance_borderless_authority }
		}
		is_active_resolution = "resolution_bureaucraticsurveillance_administrative_insight"
		is_overlord = yes
		custom_tooltip = {
			fail_text = "resolution_already_active"
			NOR = {
				is_active_resolution = "resolution_bureaucraticsurveillance_borderless_authority"
				is_active_resolution = "resolution_bureaucraticsurveillance_personal_oversight"
			}
		}
	}

	effect = {
		custom_tooltip = galcom_tooltip_ethics_tier_2
		hidden_effect = {
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_progressive days = 7200 } # EED
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_xenoist days = 7200 } # EED
			every_galcom_member = {
				limit = {
					is_subject = yes
				}
				galcom_upgrade_ethic_modifier_effect = yes
			}
		}
		galcom_success_effect = { FLAG = galactic_community_resolution_passed_bureaucraticsurveillance }
		custom_tooltip = galcom_tooltip_no_independent_sensors
		hidden_effect = {
			galcom_change_agreement_term_resolution_effect = {
				TERM = subject_sensors
				CURRENT_VALUE = subject_does_not_get_sensors
				NEW_VALUE = subject_gets_sensors
			}
		}
		custom_tooltip = galcom_tooltip_no_holdings_4
		hidden_effect = {
			every_galcom_member = {
				limit = {
					is_overlord = yes
				}
				every_agreement = {
					limit = {
						has_term_value = {
							term = subject_holdings_limit
							value = subject_holdings_limit_4
						}
					}
					set_agreement_terms = {
						subject_holdings_limit = subject_holdings_limit_3
					}
				}
			}
		}
	}

	fail_effects = {
		galcom_fail_effects = { FLAG = galactic_community_resolution_failed_bureaucraticsurveillance }
	}

	modifier = {
		resolution_bureaucraticsurveillance_administrative_insight = 1
		resolution_bureaucraticsurveillance_borderless_authority = 1
	}

	ai_weight = {
		base = @resolution_weight_unpopular

		modifier = {
			factor = 0.25
			is_subject = yes
			desc = galcom_is_subject
		}

		modifier = {
			factor = 3
			is_overlord = yes
			is_xenophile = no
			is_egalitarian = no
			desc = galcom_is_overlord
		}

		modifier = {
			factor = 0.5
			is_egalitarian = yes
			desc = ethic_egalitarian
		}

		modifier = {
			factor = 2
			is_authoritarian = yes
			desc = ethic_authoritarian
		}

		modifier = {
			factor = 2
			is_xenophobe = yes
			is_subject = no
			desc = ethic_xenophobe
		}
		
		modifier = { # EED
			factor = 1.5
			is_civic_expansionist = yes
			desc = gal_com_expansion_civic
		}
		
		modifier = { # EED
			factor = 2
			is_civic_has_elite = yes
			desc = gal_com_elite_civic
		}

		modifier = {
			factor = 0.5
			has_civic = civic_feudal_realm
			desc = civic_feudal_realm
		}

		modifier = {
			factor = 0.5
			has_civic = civic_franchising
			desc = civic_franchising
		}
	}
}

## Bureaucratic Surveillance - Personal Oversight
# Merge between EED, MECR
resolution_bureaucraticsurveillance_personal_oversight = {
	icon = "GFX_resolution_bureaucratic_surveillance"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}

	target = no
	level = 3

	potential = {
		has_overlord_dlc = yes
	}

	allow = {
		custom_tooltip = { # MECR
			fail_text = "resolution_already_in_lower_house_session"
			NOT = { has_global_flag = lh_recent_resolution_bureaucraticsurveillance_personal_oversight }
		}
		is_active_resolution = "resolution_bureaucraticsurveillance_borderless_authority"
		is_overlord = yes
		custom_tooltip = {
			fail_text = "resolution_already_active"
			NOT = { is_active_resolution = "resolution_bureaucraticsurveillance_personal_oversight" }
		}
	}

	effect = {
		custom_tooltip = galcom_tooltip_ethics_tier_3
		hidden_effect = {
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_progressive days = 7200 } # EED
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_xenoist days = 7200 } # EED
			every_galcom_member = {
				limit = {
					is_subject = yes
				}
				galcom_upgrade_ethic_modifier_effect = yes
			}
		}
		galcom_success_effect = { FLAG = galactic_community_resolution_passed_bureaucraticsurveillance }
		custom_tooltip = galcom_tooltip_no_independent_diplomacy
		hidden_effect = {
			galcom_change_agreement_term_resolution_effect = {
				TERM = subject_diplomacy
				CURRENT_VALUE = subject_can_do_diplomacy
				NEW_VALUE = subject_can_do_diplomacy_but_not_vote
			}
		}
		custom_tooltip = galcom_tooltip_no_holdings_3
		hidden_effect = {
			every_galcom_member = {
				limit = {
					is_overlord = yes
				}
				every_agreement = {
					limit = {
						has_term_value = {
							term = subject_holdings_limit
							value = subject_holdings_limit_3
						}
					}
					set_agreement_terms = {
						subject_holdings_limit = subject_holdings_limit_2
					}
				}
			}
		}
	}

	fail_effects = {
		galcom_fail_effects = { FLAG = galactic_community_resolution_failed_bureaucraticsurveillance }
	}

	modifier = {
		resolution_bureaucraticsurveillance_administrative_insight = 1
		resolution_bureaucraticsurveillance_borderless_authority = 1
		resolution_bureaucraticsurveillance_personal_oversight = 1
	}

	ai_weight = {
		base = @resolution_weight_disliked

		modifier = {
			factor = 0.25
			is_subject = yes
			desc = galcom_is_subject
		}

		modifier = {
			factor = 3
			is_overlord = yes
			is_xenophile = no
			is_egalitarian = no
			desc = galcom_is_overlord
		}

		modifier = {
			factor = 0.5
			is_egalitarian = yes
			desc = ethic_egalitarian
		}

		modifier = {
			factor = 2
			is_authoritarian = yes
			desc = ethic_authoritarian
		}

		modifier = {
			factor = 2
			is_xenophobe = yes
			is_subject = no
			desc = ethic_xenophobe
		}
		
		modifier = { # EED
			factor = 1.5
			is_civic_expansionist = yes
			desc = gal_com_expansion_civic
		}
		
		modifier = { # EED
			factor = 2
			is_civic_has_elite = yes
			desc = gal_com_elite_civic
		}

		modifier = {
			factor = 0.5
			has_civic = civic_feudal_realm
			desc = civic_feudal_realm
		}

		modifier = {
			factor = 0.5
			has_civic = civic_franchising
			desc = civic_franchising
		}
	}
}

## Bureaucratic Surveillance - Repeal 1
# Merge between EED, MECR
resolution_bureaucraticsurveillance_repeal_1 = {
	icon = "GFX_resolution_council_veto"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t1
		}
	}

	target = no
	fire_and_forget = yes

	potential = {
		has_overlord_dlc = yes
		is_active_resolution = "resolution_bureaucraticsurveillance_administrative_insight"
	}

	allow = {
		custom_tooltip = { # MECR
			fail_text = "resolution_already_in_lower_house_session"
			NOT = { has_global_flag = lh_recent_resolution_bureaucraticsurveillance_repeal_1 }
		}
	}

	effect = {
		galcom_success_effect_repeal = {
			RESOLUTION = resolution_bureaucraticsurveillance_administrative_insight
			FLAG = galactic_community_resolution_passed_bureaucraticsurveillance_repeal
		}
		hidden_effect = {
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_totalitarian days = 7200 } # EED
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_supremacist days = 7200 } # EED
			every_galcom_member = {
				limit = {
					is_subject = yes
				}
				galcom_downgrade_ethic_modifier_effect = yes
			}
		}
	}

	fail_effects = {
		galcom_fail_effects = { FLAG = galactic_community_resolution_failed_bureaucraticsurveillance_repeal }
	}

	ai_weight = {
		base = @resolution_weight_disliked

		modifier = {
			factor = 3
			is_subject = yes
			desc = galcom_is_subject
		}

		modifier = {
			factor = 0.25
			is_overlord = yes
			is_xenophile = no
			is_egalitarian = no
			desc = galcom_is_overlord
		}

		modifier = {
			factor = 2
			is_egalitarian = yes
			desc = ethic_egalitarian
		}

		modifier = {
			factor = 0.25
			is_authoritarian = yes
			desc = ethic_authoritarian
		}

		modifier = {
			factor = 0.5
			is_xenophobe = yes
			is_subject = no
			desc = ethic_xenophobe
		}
		
		modifier = { # EED
			factor = 0.75
			is_civic_expansionist = yes
			desc = gal_com_expansion_civic
		}
		
		modifier = { # EED
			factor = 0.5
			is_civic_has_elite = yes
			desc = gal_com_elite_civic
		}

		modifier = {
			factor = 2
			has_civic = civic_feudal_realm
			desc = civic_feudal_realm
		}

		modifier = {
			factor = 2
			has_civic = civic_franchising
			desc = civic_franchising
		}
	}
}

## Bureaucratic Surveillance - Repeal 2
# Merge between EED, MECR
resolution_bureaucraticsurveillance_repeal_2 = {
	icon = "GFX_resolution_council_veto"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t2
		}
	}

	target = no
	fire_and_forget = yes

	potential = {
		has_overlord_dlc = yes
		is_active_resolution = "resolution_bureaucraticsurveillance_borderless_authority"
	}

	allow = {
		custom_tooltip = { # MECR
			fail_text = "resolution_already_in_lower_house_session"
			NOT = { has_global_flag = lh_recent_resolution_bureaucraticsurveillance_repeal_2 }
		}
	}

	effect = {
		galcom_success_effect_repeal = {
			RESOLUTION = resolution_bureaucraticsurveillance_borderless_authority
			FLAG = galactic_community_resolution_passed_bureaucraticsurveillance_repeal
		}
		hidden_effect = {
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_totalitarian days = 7200 } # EED
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_supremacist days = 7200 } # EED
			every_galcom_member = {
				limit = {
					is_subject = yes
				}
				galcom_downgrade_ethic_modifier_effect = yes
			}
		}
	}

	fail_effects = {
		galcom_fail_effects = { FLAG = galactic_community_resolution_failed_bureaucraticsurveillance_repeal }
	}

	ai_weight = {
		base = @resolution_weight_unpopular

		modifier = {
			factor = 3
			is_subject = yes
			desc = galcom_is_subject
		}

		modifier = {
			factor = 0.25
			is_overlord = yes
			is_xenophile = no
			is_egalitarian = no
			desc = galcom_is_overlord
		}

		modifier = {
			factor = 2
			is_egalitarian = yes
			desc = ethic_egalitarian
		}

		modifier = {
			factor = 0.25
			is_authoritarian = yes
			desc = ethic_authoritarian
		}

		modifier = {
			factor = 0.5
			is_xenophobe = yes
			is_subject = no
			desc = ethic_xenophobe
		}
		
		modifier = { # EED
			factor = 0.75
			is_civic_expansionist = yes
			desc = gal_com_expansion_civic
		}
		
		modifier = { # EED
			factor = 0.5
			is_civic_has_elite = yes
			desc = gal_com_elite_civic
		}

		modifier = {
			factor = 2
			has_civic = civic_feudal_realm
			desc = civic_feudal_realm
		}

		modifier = {
			factor = 2
			has_civic = civic_franchising
			desc = civic_franchising
		}
	}
}

## Bureaucratic Surveillance - Repeal 3
# Merge between EED, MECR
resolution_bureaucraticsurveillance_repeal_3 = {
	icon = "GFX_resolution_council_veto"

	resources = {
		category = resolutions
		cost = {
			influence = @resolution_cost_t3
		}
	}

	target = no
	fire_and_forget = yes

	potential = {
		has_overlord_dlc = yes
		is_active_resolution = "resolution_bureaucraticsurveillance_personal_oversight"
	}

	allow = {
		custom_tooltip = { # MECR
			fail_text = "resolution_already_in_lower_house_session"
			NOT = { has_global_flag = lh_recent_resolution_bureaucraticsurveillance_repeal_3 }
		}
	}

	effect = {
		galcom_success_effect_repeal = {
			RESOLUTION = resolution_bureaucraticsurveillance_personal_oversight
			FLAG = galactic_community_resolution_passed_bureaucraticsurveillance_repeal
		}
		hidden_effect = {
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_totalitarian days = 7200 } # EED
			set_timed_country_flag = { flag = galcom_resolution_passed_anti_supremacist days = 7200 } # EED
			every_galcom_member = {
				limit = {
					is_subject = yes
				}
				galcom_downgrade_ethic_modifier_effect = yes
			}
		}
	}

	fail_effects = {
		galcom_fail_effects = { FLAG = galactic_community_resolution_failed_bureaucraticsurveillance_repeal }
	}

	ai_weight = {
		base = @resolution_weight_normal

		modifier = {
			factor = 3
			is_subject = yes
			desc = galcom_is_subject
		}

		modifier = {
			factor = 0.25
			is_overlord = yes
			is_xenophile = no
			is_egalitarian = no
			desc = galcom_is_overlord
		}

		modifier = {
			factor = 2
			is_egalitarian = yes
			desc = ethic_egalitarian
		}

		modifier = {
			factor = 0.25
			is_authoritarian = yes
			desc = ethic_authoritarian
		}

		modifier = {
			factor = 0.5
			is_xenophobe = yes
			is_subject = no
			desc = ethic_xenophobe
		}
		
		modifier = { # EED
			factor = 0.75
			is_civic_expansionist = yes
			desc = gal_com_expansion_civic
		}
		
		modifier = { # EED
			factor = 0.5
			is_civic_has_elite = yes
			desc = gal_com_elite_civic
		}

		modifier = {
			factor = 2
			has_civic = civic_feudal_realm
			desc = civic_feudal_realm
		}

		modifier = {
			factor = 2
			has_civic = civic_franchising
			desc = civic_franchising
		}
	}
}
