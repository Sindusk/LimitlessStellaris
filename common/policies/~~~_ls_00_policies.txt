##########################################################################
# Limitless Stellaris - Policies
##########################################################################

##################################################
## Standard Policies
##################################################

## Diplomatic Stance
# Merge between Organic Zealots, OSA, Bug Branch, MECR, NGS, StarTech, Ariphaos, Scripted Trigger Undercoat
diplomatic_stance = {
	potential = {
		OR = {
			is_default_or_fallen = yes # STU
			is_primitive = yes # STU
			is_country_type = awakened_marauders
			AND = { # MECR
				has_global_flag = zofe_activated
				is_zofe_country = yes
			}
			is_galactic_custodian = yes # MECR
			is_galactic_emperor = yes # MECR
		}
		OR = { # MECR
			NOT = { is_country_type = default_ev }
			has_origin = origin_ev_both_choosen
			has_valid_civic = civic_ev_planet_and_fleet
			has_ascension_perk = ev_land_planets
		}
	}

	allow = {
		is_at_war = no # Not allowed to change policies in this group while at war
	}

	option = {
		name = "diplo_stance_belligerent"
		icon = "GFX_diplomatic_stance_belligerent"

		in_breach_of = { # NGS
			{ key = resolution_prime_directive }
			{ key = resolution_galactic_cooperation_initiative }
		}

		potential = {
			OR = {
				is_playable = yes # STU
				is_country_type = awakened_fallen_empire
				AND = { # MECR
					has_global_flag = zofe_activated
					is_ascended_empire = yes
				}
			}
			if = { # MECR
				limit = { is_ECI_activated = yes }
				NOT = { has_valid_civic = civic_isolationism }
			}
		}

		valid = {
			NOT = { has_valid_civic = civic_inwards_perfection }
			is_homicidal = no # They have their own variants of this
			is_galactic_custodian = no # MECR
			is_galactic_emperor = no # MECR
		}

		policy_flags = {
			diplo_stance_belligerent
		}

		modifier = {
			country_war_exhaustion_mult = -0.1
			country_naval_cap_mult = 0.25 # OSA 0.10 -> 0.25
			country_starbase_capacity_mult = 0.25 # OSA
			ship_fire_rate_mult = 0.05 # OSA
			country_claim_influence_cost_mult = -0.1
		}

		ai_weight = {
			weight = 10

			modifier = {
				factor = 0
				NOT = { has_country_flag = has_encountered_other_empire }
			}

			# Pacifists
			modifier = { # Fanatic Pacifists will *only* go belligerent if there's a rival neighbor...
				factor = 0
				has_ethic = ethic_fanatic_pacifist
				NOR = { # Bug Branch
					is_at_war = yes # Bug Branch
					any_neighbor_country = {
						is_rival = root
					}
				}
			}
			modifier = { # Regular Pacifists have only a small chance to go belligerent unless there's a rival neighbor...
				factor = 0.5
				has_ethic = ethic_pacifist
				NOR = { # Bug Branch
					is_at_war = yes # Bug Branch
					any_neighbor_country = {
						is_rival = root
					}
				}
			}
			modifier = {
				factor = 0.5 # ...but they're still less likely to.
				is_pacifist = yes
			}
			modifier = { # NGS
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_prime_directive"
					is_active_resolution = "resolution_galactic_cooperation_initiative"
				}
			}

			# Angry people like to be belligerent
			modifier = {
				factor = 2.0
				has_ethic = ethic_fanatic_militarist
			}
			modifier = {
				factor = 1.5
				has_ethic = ethic_militarist
			}
			modifier = {
				factor = 1.5
				has_ethic = ethic_fanatic_authoritarian
			}
			modifier = {
				factor = 1.25
				has_ethic = ethic_authoritarian
			}
			modifier = {
				factor = 5.0 # Intentionally high value for despoilers/Nihilistic Acquisition
				is_slaver = yes
			}
			modifier = {
				factor = 1.5
				has_valid_civic = civic_nationalistic_zeal
			}
			modifier = {
				factor = 1.5
				OR = {
					has_valid_civic = civic_hive_strength_of_legions
					has_valid_civic = civic_machine_warbots
					has_valid_civic = civic_private_military_companies
					has_valid_civic = civic_warrior_culture
				}
			}

			modifier = { # NGS
				factor = 2.2
				has_civic = civic_crusader_spirit
			}

			modifier = {
				factor = 1.5
				has_ai_personality_behaviour = conqueror
			}
			modifier = {
				factor = 1.5
				has_ai_personality_behaviour = subjugator
			}

			modifier = {
				factor = 3.0 # Blocked in propagators get ANGRY
				has_ai_expansion_plan = no
				has_ai_personality_behaviour = propagator
			}
		}
	}

	option = {
		name = "diplo_stance_cooperative"
		icon = "GFX_diplomatic_stance_cooperative"

		in_breach_of = { # MECR
			{ key = resolution_justified_suspicion }
			{ key = resolution_national_purity }
			{ key = resolution_cooperation_discouraged }
			{ key = resolution_closed_society }
		}

		potential = {
			OR = {
				is_playable = yes # STU
				is_country_type = awakened_fallen_empire
				AND = { # MECR
					has_global_flag = zofe_activated
					is_ascended_empire = yes
				}
			}
			if = { # MECR
				limit = { is_ECI_activated = yes }
				NOT = { has_valid_civic = civic_isolationism }
			}
		}

		valid = {
			NOT = { has_valid_civic = civic_inwards_perfection }
			is_unfriendly = no # Not homicidal or barbaric despoilers
			is_galactic_custodian = no # MECR
			is_galactic_emperor = no # MECR
		}

		policy_flags = {
			diplo_stance_cooperative
		}

		modifier = {
			diplo_weight_mult = 0.50 # OSA 0.25 -> 0.50
			add_base_country_intel = 20 # OSA
			envoy_improve_relations_mult = 0.5
			country_border_friction_mult = -0.5
			operations_cost_mult = 0.25
			operations_upkeep_mult = 0.25
		}

		ai_weight = {
			weight = 2 # StarTech 10 -> 2

			modifier = { # StarTech AI
				factor = 5
				is_pacifist = yes
			}
			
			modifier = { # StarTech AI
				factor = 100
				has_federation = yes
			}

			modifier = { # NGS
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_justified_suspicion"
					is_active_resolution = "resolution_national_purity"
					is_active_resolution = "resolution_cooperation_discouraged"
					is_active_resolution = "resolution_closed_society"
				}
			}

			modifier = {
				factor = 0.01
				has_ascension_perk = ap_become_the_crisis
			}

			modifier = {
				factor = 0
				NOT = { has_country_flag = has_encountered_other_empire }
			}

			# Tons of Ethics modifiers!
			# Cranky people:
			modifier = {
				factor = 0
				has_ethic = ethic_fanatic_xenophobe
			}
			modifier = {
				factor = 0.1
				has_ethic = ethic_xenophobe
			}
			modifier = {
				factor = 0.5
				has_ethic = ethic_fanatic_authoritarian
			}
			modifier = {
				factor = 0.75
				has_ethic = ethic_authoritarian
			}

			# Nice people:
			modifier = {
				factor = 2.0
				has_ethic = ethic_fanatic_xenophile
			}
			modifier = {
				factor = 1.5
				has_ethic = ethic_xenophile
			}
			modifier = {
				factor = 1.3
				has_valid_civic = civic_machine_exploration_protocol
			}
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_pacifist
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_pacifist
			}
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_egalitarian
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_egalitarian
			}
			modifier = {
				factor = 1.1
				has_ethic = ethic_fanatic_materialist
			}
			modifier = {
				factor = 1.05
				has_ethic = ethic_materialist
			}

			modifier = {
				factor = 1.25
				has_ai_personality_behaviour = multispecies
			}

			modifier = {
				factor = 3.0
				has_ai_personality = federation_builders
			}
		}
	}

	option = {
		name = "diplo_stance_isolationist"
		icon = "GFX_diplomatic_stance_isolationist"

		in_breach_of = { # NGS
			{ key = resolution_galactic_cooperation_initiative }
		}

		potential = {
			OR = {
				is_playable = yes # STU
				is_country_type = awakened_fallen_empire
				AND = { # MECR
					has_global_flag = zofe_activated
					is_ascended_empire = yes
				}
			}
		}

		valid = {
			is_megacorp = no # "NO! YOU CAN'T BUY OUR STUFF!" makes the shareholders sad
			is_homicidal = no # Homicidal variants below
			is_galactic_custodian = no # MECR
			is_galactic_emperor = no # MECR
		}

		policy_flags = {
			diplo_stance_isolationist
		}

		modifier = {
			empire_size_penalty_mult = -0.15 # OSA
			country_unity_produces_mult = 0.50 # OSA 0.10 -> 0.50
			diplo_weight_mult = -0.50
			country_power_projection_produces_mult = -0.50 # OSA
			diplomacy_upkeep_mult = 1
			pop_government_ethic_attraction = 0.50 # OSA 0.25 -> 0.50
			country_border_friction_mult = 2.0
		}

		on_enabled = {
		}

		ai_weight = {
			weight = 10

			modifier = { # NGS
				factor = 0.1
				is_galactic_community_member = yes
				is_active_resolution = "resolution_galactic_cooperation_initiative"
			}

			modifier = {
				factor = 0.01
				has_ascension_perk = ap_become_the_crisis
			}

			modifier = {
				factor = 0.25 # Let the isolationists start in this if they want
				NOT = { has_country_flag = has_encountered_other_empire }
			}

			modifier = {
				factor = 0
				OR = {
					has_ai_personality = federation_builders
					has_ai_personality = fanatic_befrienders
				}
			}

			modifier = {
				factor = 100.0 # Inwards Perfection should almost always go isolationist
				has_valid_civic = civic_inwards_perfection
			}

			modifier = {
				factor = 3.0
				has_ai_personality_behaviour = isolationist
			}

			modifier = {
				factor = 2.0
				is_xenophobe = yes
				is_militarist = no
				is_authoritarian = no
			}
			
			modifier = { # StarTech AI
				factor = 0
				is_ai = yes
			}
		}
	}

	option = {
		name = "diplo_stance_expansionist"
		icon = "GFX_diplomatic_stance_expansionist"

		in_breach_of = { # NGS
			{ key = resolution_cooperation_discouraged }
			{ key = resolution_closed_society }
			{ key = resolution_galactic_cooperation_initiative }
		}

		potential = {
			OR = {
				is_playable = yes # STU
				is_country_type = awakened_fallen_empire
				AND = { # MECR
					has_global_flag = zofe_activated
					is_ascended_empire = yes
				}
			}
		}

		valid = {
			is_homicidal = no
			is_galactic_custodian = no # MECR
			is_galactic_emperor = no # MECR
		}

		policy_flags = {
			diplo_stance_expansionist
		}

		modifier = {
			starbase_outpost_cost_mult = -0.10
			planet_colony_development_speed_mult = 0.25 # OSA 0.15 -> 0.25
			country_border_friction_mult = 1.0
		}

		ai_weight = {
			weight = 10

			modifier = { # StarTech AI
				factor = 100
				or = {
					used_naval_capacity_percent < 0.7
					years_passed < @str_years_of_extended_truce
				}
			}

			modifier = { # NGS
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_cooperation_discouraged"
					is_active_resolution = "resolution_closed_society"
					is_active_resolution = "resolution_galactic_cooperation_initiative"
				}
			}

			modifier = {
				factor = 2
				NOT = { has_country_flag = has_encountered_other_empire }
			}

			modifier = {
				factor = 0.01
				has_ascension_perk = ap_become_the_crisis
			}
		}
	}

	option = {
		name = "diplo_stance_mercantile"
		icon = "GFX_diplomatic_stance_mercantile"

		in_breach_of = { # NGS
			{ key = resolution_cooperation_discouraged }
			{ key = resolution_closed_society }
		}

		potential = {
			OR = {
				is_playable = yes # STU
				is_country_type = awakened_fallen_empire
				AND = { # MECR
					has_global_flag = zofe_activated
					is_ascended_empire = yes
				}
			}
			is_gestalt = no
			if = { # MECR
				limit = { is_ECI_activated = yes }
				NOT = { has_valid_civic = civic_isolationism }
			}
		}

		valid = {
			NOT = { has_valid_civic = civic_inwards_perfection }
			is_homicidal = no
			# some ugliness to preserve the
			# auth/civic - potential/valid divide for tooltip
			if = {
				limit = { # LS - Rewrite for more clarity
					has_megacorp = yes
					#is_megacorp = yes # LS - Doesn't make sense with lower conditions
				}
				OR = { # LS - Rewrite for more clarity
					is_megacorp = yes
					has_civic = civic_merchant_guilds
					has_tradition = tr_mercantile_finish # OSA
					has_ethic = ethic_competitive # Bug Branch
					has_ethic = ethic_fanatic_competitive # Bug Branch
				}
			}
			else_if = { # MECR
				limit = { is_ECI_activated = yes }
				OR = {
					has_ethic = ethic_capitalism
					has_ethic = ethic_fanatic_capitalism
				}
			}
			else = { has_civic = civic_corporate_dominion }
		}

		policy_flags = {
			diplo_stance_mercantile
		}

		modifier = {
			diplo_weight_economy_mult = 0.50 # OSA 0.25 -> 0.50
			trade_value_mult = 0.25 # OSA 0.10 -> 0.25
			local_trade_protection_add = 5
		}

		ai_weight = {
			weight = 1 # StarTech 10 -> 1

			modifier = { # NGS
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_cooperation_discouraged"
					is_active_resolution = "resolution_closed_society"
				}
			}

			modifier = {
				factor = 0.01
				has_ascension_perk = ap_become_the_crisis
			}
			modifier = {
				factor = 3.0
				is_megacorp = yes # Megacorps should generally prefer this diplo stance unless their ethics get them to specialize differently
			}
			modifier = {
				factor = 1.25
				has_valid_civic = civic_free_traders
			}
			modifier = {
				factor = 10
				should_ai_focus_on_trade = yes
			}
			modifier = {
				factor = 0.65
				OR = {
					has_valid_civic = civic_private_prospectors
					has_valid_civic = civic_private_military_companies
				}
			}
		}
	}

	option = {
		name = "diplo_stance_supremacist"
		icon = "GFX_diplomatic_stance_supremacy"

		in_breach_of = { # NGS
			{ key = resolution_charter_of_sentient_rights }
			{ key = resolution_stellar_diplomatic_forums }
			{ key = resolution_prime_directive }
			{ key = resolution_galactic_cooperation_initiative }
		}

		potential = {
			is_homicidal = no # Bug Branch
			OR = {
				is_country_type = awakened_fallen_empire
				is_country_type = awakened_marauders
				is_playable = yes # STU
				AND = { # MECR
					has_global_flag = zofe_activated
					OR = {
						is_ascended_empire = yes
						is_country_type = awakened_original_empire
					}
				}
			}
			if = { # MECR
				limit = { is_ECI_activated = yes }
				NOT = { has_valid_civic = civic_isolationism }
			}
			NOR = { has_valid_civic = civic_inwards_perfection } # Bug Branch
		}
		valid = {
			NOR = {
				has_valid_civic = civic_inwards_perfection
				has_modifier = humiliated
			}
			is_homicidal = no
			custom_tooltip = {
				fail_text = "requires_supremacy_traditions"
				OR = {
					has_tradition = tr_supremacy_finish
					is_playable = no # STU
				}
			}
			custom_tooltip = { # MECR
				fail_text = "we_have_bowed_to_the_imperium"
				NAND = {
					is_galactic_community_member = yes
					has_galactic_emperor = yes
					is_galactic_emperor = no
				}
			}
			is_subject = no
			is_galactic_custodian = no # MECR
			is_galactic_emperor = no # MECR
		}

		policy_flags = {
			diplo_stance_supremacist
		}

		modifier = {
			diplo_weight_naval_mult = 0.50 # MECR 1.00 -> 0.50
			country_war_exhaustion_mult = -0.20
			country_naval_cap_mult = 0.30 # OSA 0.20 -> 0.30
			country_claim_influence_cost_mult = -0.1
			ship_fire_rate_mult = 0.05 # OSA
		}

		on_enabled = {
		}

		ai_weight = {
			weight = 7 # StarTech 10 -> 7

			modifier = { # StarTech AI
				factor = 30
				years_passed > 60
				or = {
					used_naval_capacity_percent > 0.95
					and = {
						used_naval_capacity_percent > 0.5
						has_tradition = tr_supremacy_finish
					}
				}
				nor = {
					has_country_flag = str_has_bad_economy_score
					has_country_flag = str_has_bad_fleet_score
					has_country_flag = str_has_bad_tech_score
				}
			}

			modifier = { # NGS
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_charter_of_sentient_rights"
					is_active_resolution = "resolution_stellar_diplomatic_forums"
					is_active_resolution = "resolution_prime_directive"
					is_active_resolution = "resolution_galactic_cooperation_initiative"
				}
			}

			modifier = {
				factor = 0
				NOT = { has_country_flag = has_encountered_other_empire }
			}

			modifier = {
				factor = 0
				is_pacifist = yes
			}

			modifier = {
				factor = 10
				OR = {
					is_country_type = awakened_fallen_empire
					is_country_type = awakened_marauders
				}
			}

			# Angry people want to be Supreme
			modifier = {
				factor = 5.0 # Ariphaos 2.0 -> 5.0
				has_ethic = ethic_fanatic_militarist
			}
			modifier = { # NGS
				factor = 2.0
				has_civic = civic_dragons
			}
			modifier = {
				factor = 2.0 # Ariphaos 1.5 -> 2.0
				has_ethic = ethic_militarist
			}
			modifier = {
				factor = 2.0 # Ariphaos 1.5 -> 2.0
				has_ethic = ethic_fanatic_authoritarian
			}
			modifier = {
				factor = 1.5 # Ariphaos 1.25 -> 1.5
				has_ethic = ethic_authoritarian
			}
			modifier = {
				factor = 1.5 # Ariphaos 1.25 -> 1.5
				is_slaver = yes
			}
			modifier = {
				factor = 2
				has_valid_civic = civic_nationalistic_zeal
			}
			modifier = {
				factor = 3
				OR = {
					has_valid_civic = civic_hive_strength_of_legions
					has_valid_civic = civic_machine_warbots
					has_valid_civic = civic_private_military_companies
					has_warrior_culture = yes # STU
				}
			}

			modifier = {
				factor = 1.5
				has_ai_personality_behaviour = conqueror
			}
			modifier = {
				factor = 1.5
				has_ai_personality_behaviour = subjugator
			}

			modifier = { # Don't be suicidal
				factor = 0
				any_relation = {
					has_communications = root
					has_policy_flag = diplo_stance_supremacist
					is_playable = yes # STU
					is_subject = no
					relative_power = {
						who = root
						category = fleet
						value = overwhelming
					}
				}
			}
			modifier = {
				factor = 0.5 # NGS 0.25 -> 0.5
				any_neighbor_country = {
					has_communications = root
					is_playable = yes # STU
					is_subject = no
					relative_power = {
						who = root
						category = fleet
						value > equivalent
					}
				}
			}
		}
	}

	option = {
		name = "diplo_stance_hunger"
		icon = "GFX_diplomatic_stance_rest"

		potential = {
			is_hive_empire = yes # STU
		}

		valid = {
			has_valid_civic = civic_hive_devouring_swarm
		}

		policy_flags = {
			diplo_stance_hunger
		}

		modifier = {
			planet_colony_development_speed_mult = 0.25 # OSA
			pop_resettlement_cost_mult -0.25 # OSA
			pop_purge_speed = 0.5 # OSA
		}

		ai_weight = {
			weight = 100
		}
	}

	option = {
		name = "diplo_stance_extermination"
		icon = "GFX_diplomatic_stance_recompiling"

		potential = {
			is_machine_empire = yes # STU
		}

		valid = {
			has_valid_civic = civic_machine_terminator
		}

		policy_flags = {
			diplo_stance_extermination
		}

		modifier = {
			ship_weapon_damage = 0.1 # OSA
			planet_army_build_speed_mult = 0.25 # OSA
			army_attack_damage_mult = 0.25 # OSA
			pop_purge_speed = 0.5 # OSA
		}

		ai_weight = {
			weight = 100
		}
	}

	option = {
		name = "diplo_stance_purification"
		icon = "GFX_diplomatic_stance_withdrawn"

		potential = {
			has_utopia = yes
		}

		valid = {
			OR = { # Organic Zealots
				has_valid_civic = civic_fanatic_purifiers
				is_valid_organic_zealots = yes # Organic Zealots
			}
		}

		policy_flags = {
			diplo_stance_purification
		}

		modifier = {
			ship_weapon_damage = 0.1 # OSA
			planet_army_build_speed_mult = 0.25 # OSA
			army_attack_damage_mult = 0.25 # OSA
			pop_purge_speed = 0.5 # OSA
		}

		ai_weight = {
			weight = 100
		}
	}

	option = {
		name = "diplo_stance_isolationist_fallen_empire"
		icon = "GFX_diplomatic_stance_isolationist"

		potential = {
			OR = { # MECR
				is_fallen_empire = yes # STU
				AND = { # MECR
					has_global_flag = zofe_activated
					is_zofe_fe = yes
				}
			}
		}

		policy_flags = {
			diplo_stance_isolationist_fallen_empire
		}

		modifier = {
		}

		ai_weight = {
			weight = 100
			
			modifier = { # MECR
				factor = 3.0
				has_global_flag = zofe_activated
				is_lost_empire = yes
			}
			modifier = { # MECR
				factor = 3.0
				has_global_flag = zofe_activated
				is_country_type = original_empire
			}
		}
	}

	option = {
		name = "diplo_stance_ignorant"
		icon = "GFX_diplomatic_stance_isolationist"

		potential = {
			is_country_type = primitive
			current_awareness_level < medium
			capital_scope = {
				NOT = { has_modifier = culture_shock_diplomacy }
			}
		}

		policy_flags = {
			diplo_stance_ignorant
		}

		modifier = {
		}

		ai_weight = {
			weight = 1
		}
	}

	option = {
		name = "diplo_stance_questioning"
		icon = "GFX_diplomatic_stance_expansionist"

		potential = {
			is_country_type = primitive
			current_awareness_level = medium
			capital_scope = {
				NOT = { has_modifier = culture_shock_diplomacy }
			}
		}

		policy_flags = {
			diplo_stance_questioning
		}

		modifier = {
		}

		ai_weight = {
			weight = 1
		}
	}

	option = {
		name = "diplo_stance_eager"
		icon = "GFX_diplomatic_stance_cooperative"

		potential = {
			is_country_type = primitive
			current_awareness_level >= high
			is_xenophile = yes
			capital_scope = {
				NOT = { has_modifier = culture_shock_diplomacy }
			}
		}

		policy_flags = {
			diplo_stance_eager
		}

		modifier = {
		}

		ai_weight = {
			weight = 1
		}
	}

	option = {
		name = "diplo_stance_fearful"
		icon = "GFX_diplomatic_stance_withdrawn"

		potential = {
			is_country_type = primitive
			current_awareness_level >= high
			is_xenophobe = yes
			capital_scope = {
				NOT = { has_modifier = culture_shock_diplomacy }
			}
		}

		policy_flags = {
			diplo_stance_fearful
		}

		modifier = {
		}

		ai_weight = {
			weight = 1
		}
	}

	option = {
		name = "diplo_stance_uncertain"
		icon = "GFX_diplomatic_stance_isolationist"

		potential = {
			is_country_type = primitive
			current_awareness_level >= high
			is_xenophile = no
			is_xenophobe = no
			capital_scope = {
				NOT = { has_modifier = culture_shock_diplomacy }
			}
		}

		policy_flags = {
			diplo_stance_uncertain
		}

		modifier = {
		}

		ai_weight = {
			weight = 1
		}
	}

	option = {
		name = "diplo_stance_culture_shock"
		icon = "GFX_diplomatic_stance_belligerent"

		potential = {
			is_country_type = primitive
			capital_scope = {
				has_modifier = culture_shock_diplomacy
			}
		}

		policy_flags = {
			diplo_stance_culture_shock
		}

		modifier = {
			diplo_action_acceptance_add = -100
		}

		ai_weight = {
			weight = 100
		}
	}

	option = { # MECR
		name = "diplo_peaceful_coexistence"
		icon = "GFX_diplomatic_stance_cooperative"
		potential = {
			is_ECI_activated = yes
			OR = {
				is_country_type = default
				is_country_type = awakened_fallen_empire
			}
			NOR = {
				has_ethic = ethic_militarist
				has_ethic = ethic_fanatic_militarist
			}
		}
		policy_flags = {
			diplo_stance_cooperative
		}
		modifier = {
			diplo_weight_economy_mult = 0.25
			country_border_friction_mult = -0.5
			country_hostile_claim_influence_cost_mult = 0.75
			country_claim_influence_cost_mult = 0.75
		}
		ai_weight = {
			weight = 10
			modifier = {
				factor = 0
				NOT = {
					has_country_flag = has_encountered_other_empire
				}
			}
			# Tons of Ethics modifiers!
			# Cranky people:
			modifier = {
				factor = 0
				has_ethic = ethic_fanatic_xenophobe
			}
			modifier = {
				factor = 0
				has_ethic = ethic_fanatic_xenophile
			}
			modifier = {
				factor = 0.5
				has_ethic = ethic_fanatic_authoritarian
			}
			modifier = {
				factor = 0.75
				has_ethic = ethic_authoritarian
			}
			# Nice people:
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_pacifist
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_pacifist
			}
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_egalitarian
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_egalitarian
			}
			modifier = {
				factor = 1.1
				has_ethic = ethic_fanatic_materialist
			}
			modifier = {
				factor = 1.05
				has_ethic = ethic_materialist
			}
			modifier = {
				factor = 1.25
				has_ai_personality_behaviour = multispecies
			}
			modifier = {
				factor = 10
				has_civic = civic_independent
			}
			modifier = {
				factor = 10
				has_valid_civic = civic_shared_burden
			}
		}
	}

	option = { # MECR
		name = "diplo_stance_revolution"
		icon = "GFX_diplomatic_stance_supremacy"
		potential = {
			is_ECI_activated = yes
			is_homicidal = no
			OR = {
				is_country_type = awakened_fallen_empire
				is_country_type = awakened_marauders
				is_country_type = default
			}
			NOR = {
				has_valid_civic = civic_inwards_perfection
				has_valid_civic = civic_isolationism
			}
		}
		valid = {
			NOT = {
				has_modifier = humiliated
			}
			OR = {
				has_tradition = tr_revolution_finish
			}
			is_subject = no
		}
		policy_flags = {
			diplo_stance_revolution
		}
		modifier = {
			diplo_weight_naval_mult = 0.5
			country_war_exhaustion_mult = -0.2
			country_naval_cap_mult = 0.2
			intel_decryption_add = 2
		}
		on_enabled = {
		}
		ai_weight = {
			weight = 50
			modifier = {
				factor = 0
				NOT = {
					has_country_flag = has_encountered_other_empire
				}
			}
			modifier = {
				factor = 0
				is_pacifist = yes
			}
			modifier = {
				factor = 10
				OR = {
					is_country_type = awakened_fallen_empire
					is_country_type = awakened_marauders
				}
				has_ethic = "ethic_fanatic_socialism"
			}
			# Angry people want to be Supreme
			modifier = {
				factor = 1.5
				has_ethic = ethic_fanatic_militarist
			}
			modifier = {
				factor = 1.25
				has_ethic = ethic_militarist
			}
			modifier = {
				factor = 2
				has_ethic = ethic_fanatic_egalitarian
			}
			modifier = {
				factor = 1.5
				has_ethic = ethic_egalitarian
			}
			modifier = {
				factor = 0                # Despoilers/Nihilistic Acquisition intentionally get a higher multiplier for Belligerent than Supremacist
				is_slaver = yes
			}
			modifier = {
				factor = 2
				has_ai_personality_behaviour = liberator
			}
			modifier = {
				factor = 1.5
				has_ai_personality_behaviour = robot_liberator
			}
			modifier = {
				# Don't be suicidal
				factor = 100
				any_relation = {
					has_communications = root
					has_policy_flag = diplo_stance_revolution
					is_country_type = default
					is_subject = no
					relative_power = {
						who = root
						category = fleet
						value = overwhelming
					}
				}
			}
			modifier = {
				factor = 0.25
				any_neighbor_country = {
					has_communications = root
					is_country_type = default
					is_subject = no
					relative_power = {
						who = root
						category = fleet
						value > equivalent
					}
				}
			}
		}
	}
	
	option = { # MECR
		name = "diplo_stance_galactic_custodian"
		icon = "GFX_diplomatic_galactic_custodian"

		potential = {
			is_galactic_custodian = yes
		}
		valid = {
			is_galactic_custodian = yes
		}

		policy_flags = {
			diplo_stance_galactic_custodian
		}

		modifier = {
			diplo_weight_mult = 0.33
			envoy_improve_relations_mult = 0.5
			country_naval_cap_mult = 0.20
			trade_value_mult = 0.1
			diplo_action_acceptance_add = 5
		}

		on_enabled = {
		}

		ai_weight = {
			weight = 100
		}
	}

	option = { # MECR
		name = "diplo_stance_condescending_authority"
		icon = "GFX_diplomatic_stance_supremacy"

		potential = {
			is_galactic_emperor = yes
			NOT = { has_country_flag = flag_tr_diplomacy_imperial_prestige_complete }
		}
		valid = {
			is_galactic_emperor = yes
			is_egalitarian = no
		}

		policy_flags = {
			diplo_stance_condescending_authority
		}

		modifier = {
			imperial_authority_monthly_get = 0.4
			country_base_influence_produces_add = 1
			diplo_weight_mult = 0.40
			country_naval_cap_mult = 0.20
		}

		on_enabled = { hidden_effect = { country_event = { id = MECR.4 days = 1 } } }

		ai_weight = {
			weight = 100
		}
	}

	option = { # MECR
		name = "diplo_stance_humble_and_friendly"
		icon = "GFX_diplomatic_stance_cooperative"

		potential = {
			is_galactic_emperor = yes
			NOT = { has_country_flag = flag_tr_diplomacy_imperial_prestige_complete }
		}
		valid = {
			is_galactic_emperor = yes
			is_xenophobe = no
		}

		policy_flags = {
			diplo_stance_humble_and_friendly
		}

		modifier = {
			diplo_weight_mult = 0.25
			envoy_improve_relations_mult = 1.0
			diplo_action_acceptance_add = 15
			envoys_add = 2
			imperial_authority_monthly_get = -0.2
		}

		on_enabled = { hidden_effect = { country_event = { id = MECR.4 days = 1 } } }

		ai_weight = {
			weight = 60
			complex_trigger_modifier = {
				trigger = count_subject
				parameters = {
					limit = { is_imperial_province = yes }
				}
				mode = add
				mult = 5
			}
			modifier = {
				mult = 1.5
				is_xenophile = yes
			}
			modifier = {
				mult = 0.8
				is_xenophobe = yes
			}
		}
	}

	option = { # MECR
		name = "diplo_stance_glory_conquest"
		icon = "GFX_diplomatic_stance_belligerent"

		potential = {
			is_galactic_emperor = yes
			NOT = { has_country_flag = flag_tr_diplomacy_imperial_prestige_complete }
		}
		valid = {
			is_galactic_emperor = yes
			is_pacifist = no
		}

		policy_flags = {
			diplo_stance_glory_conquest
		}

		modifier = {
			diplo_weight_naval_mult = 0.50
			country_war_exhaustion_mult = -0.50
			country_naval_cap_mult = 0.33
			ship_fire_rate_mult = 0.33
			diplo_stance_glory_conquest_effect = -0.5
		}

		on_enabled = { hidden_effect = { country_event = { id = MECR.4 days = 1 } } }

		ai_weight = {
			weight = 80
			modifier = {
				mult = 1.5
				is_militarist = yes
			}
			modifier = {
				mult = 0.5
				years_of_peace = { value > 5 }
			}
		}
	}

	option = { # MECR
		name = "diplo_stance_universal_transactions"
		icon = "GFX_diplomatic_stance_mercantile"

		potential = {
			is_galactic_emperor = yes
			NOT = { has_country_flag = flag_tr_diplomacy_imperial_prestige_complete }
		}
		valid = {
			has_civic = civic_galactic_sovereign_megacorp
		}

		policy_flags = {
			diplo_stance_universal_transactions
		}

		modifier = {
			diplo_weight_economy_mult = 1.0
			planet_branch_offices_cost_mult = -0.25
			branch_office_value_mult = 0.25
			trade_value_mult = 0.25
			country_war_exhaustion_mult = 0.50
		}

		on_enabled = { hidden_effect = { country_event = { id = MECR.4 days = 1 } } }

		ai_weight = {
			weight = 110
		}
	}

	option = { # MECR
		name = "diplo_stance_condescending_authority_advanced"
		icon = "GFX_diplomatic_stance_supremacy"

		potential = {
			is_galactic_emperor = yes
			has_active_tradition = tr_diplomacy_imperial_prestige
		}
		valid = {
			is_galactic_emperor = yes
			is_egalitarian = no
		}

		policy_flags = {
			diplo_stance_condescending_authority
		}

		modifier = {
			imperial_authority_monthly_get = 0.5
			country_base_influence_produces_add = 1
			diplo_weight_mult = 0.50
			country_naval_cap_mult = 0.25
		}

		on_enabled = { hidden_effect = { country_event = { id = MECR.4 days = 1 } } }

		ai_weight = {
			weight = 100
		}
	}

	option = { # MECR
		name = "diplo_stance_humble_and_friendly_advanced"
		icon = "GFX_diplomatic_stance_cooperative"

		potential = {
			is_galactic_emperor = yes
			has_active_tradition = tr_diplomacy_imperial_prestige
		}
		valid = {
			is_galactic_emperor = yes
			is_xenophobe = no
		}

		policy_flags = {
			diplo_stance_humble_and_friendly
		}

		modifier = {
			diplo_weight_mult = 0.33
			envoy_improve_relations_mult = 1.0
			diplo_action_acceptance_add = 20
			envoys_add = 3
		}

		on_enabled = { hidden_effect = { country_event = { id = MECR.4 days = 1 } } }

		ai_weight = {
			weight = 60
			complex_trigger_modifier = {
				trigger = count_subject
				parameters = {
					limit = { is_imperial_province = yes }
				}
				mode = add
				mult = 5
			}
			modifier = {
				mult = 1.5
				is_xenophile = yes
			}
			modifier = {
				mult = 0.8
				is_xenophobe = yes
			}
		}
	}

	option = { # MECR
		name = "diplo_stance_glory_conquest_advanced"
		icon = "GFX_diplomatic_stance_belligerent"

		potential = {
			is_galactic_emperor = yes
			has_active_tradition = tr_diplomacy_imperial_prestige
		}
		valid = {
			is_galactic_emperor = yes
			is_pacifist = no
		}

		policy_flags = {
			diplo_stance_glory_conquest
		}

		modifier = {
			# 和平每持续一年，每月额外-0.05帝国权威，持续和平20年时达到最大值每月-1
			diplo_weight_naval_mult = 0.60
			country_war_exhaustion_mult = -0.50
			country_naval_cap_mult = 0.40
			ship_fire_rate_mult = 0.40
			army_damage_mult = 0.40
			diplo_stance_glory_conquest_effect = -0.5
		}

		on_enabled = { hidden_effect = { country_event = { id = MECR.4 days = 1 } } }

		ai_weight = {
			weight = 80
			modifier = {
				mult = 1.5
				is_militarist = yes
			}
			modifier = {
				mult = 0.5
				years_of_peace = { value > 5 }
			}
		}
	}

	option = { # MECR
		name = "diplo_stance_universal_transactions_advanced"
		icon = "GFX_diplomatic_stance_mercantile"

		potential = {
			is_galactic_emperor = yes
			has_active_tradition = tr_diplomacy_imperial_prestige
		}
		valid = {
			has_civic = civic_galactic_sovereign_megacorp
		}

		policy_flags = {
			diplo_stance_universal_transactions
		}

		modifier = {
			diplo_weight_economy_mult = 1.0
			planet_branch_offices_cost_mult = -0.50
			branch_office_value_mult = 0.33
			trade_value_mult = 0.33
			country_war_exhaustion_mult = 0.25
		}

		on_enabled = { hidden_effect = { country_event = { id = MECR.4 days = 1 } } }

		ai_weight = {
			weight = 110
		}
	}
}

## War Philosophy
# Merge between Organic Zealots, OSA, NGS, Expanded Gestalts, Ariphaos, Scripted Trigger Undercoat
war_philosophy = {

	potential = {
		OR = {
			is_default_or_fallen = yes # STU
		}
	}

	allow = {
		is_at_war = no # Not allowed to change policies in this group while at war
	}

	option = {
		name = "unrestricted_wars"

		policy_flags = {
			unrestricted_wars
		}

		in_breach_of = {
			{
				key = resolution_rulesofwar_last_resort_doctrine
			}
			{ # NGS
				key = resolution_rulesofwar_demobilization_initiative
			}
			{ # NGS
				key = resolution_rulesofwar_6
			}
		}

		valid = {
			NOR = {
				has_valid_civic = "civic_mutualistic_behavior" # Expanded Gestalts
				has_ethic = "ethic_pacifist"
				has_ethic = "ethic_fanatic_pacifist"
				has_valid_civic = "civic_inwards_perfection"
				has_civic = "civic_crusader_spirit"
				has_valid_civic = "civic_crusader_spirit_corporate" # Organic Zealots
			}
		}

		AI_weight = {
			modifier = {
				factor = 10
				OR = {
					has_valid_ai_personality = no
					is_ai = no
				}
				is_pacifist = no # STU
			}
			modifier = {
				factor = 10
				has_valid_ai_personality = yes
				is_ai = yes
				OR = {
					has_ai_personality_behaviour = conqueror
					has_ai_personality_behaviour = subjugator
					has_ai_personality_behaviour = purger
				}
			}
			modifier = {
				factor = 10
				has_ascension_perk = ap_become_the_crisis
			}
			modifier = {
				factor = 0.1
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_rulesofwar_last_resort_doctrine"
					is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
					is_active_resolution = "resolution_rulesofwar_6" # NGS
				}
			}
			modifier = {
				factor = 0
				is_pacifist = yes # STU
			}
		}
	}

	option = {
		name = "liberation_wars"

		policy_flags = {
			liberation_wars
		}

		in_breach_of = { # NGS
			{
				key = resolution_rulesofwar_6
			}
		}

		potential = {
			is_gestalt = no
		}

		valid = {
			is_homicidal = no # Organic Zealots
			NOR = {
				has_ethic = "ethic_fanatic_pacifist"
				has_valid_civic = "civic_fanatic_purifiers"
			}
		}

		on_enabled = {
			hidden_effect = {
				check_casus_belli_valid = {
					type = cb_ideology
				}
			}
		}

		on_disabled = {
			hidden_effect = {
				check_casus_belli_valid = {
					type = cb_ideology
				}
			}
		}

		AI_weight = {
			modifier = {
				factor = 2
				OR = {
					has_valid_ai_personality = no
					is_ai = no
				}
				has_ethic = "ethic_pacifist"
			}
			modifier = {
				factor = 2
				has_valid_ai_personality = yes
				is_ai = yes
				OR = {
					has_ai_personality_behaviour = conqueror
					has_ai_personality_behaviour = subjugator
					has_ai_personality_behaviour = liberator
				}
			}
			modifier = { # NGS
				factor = 0.1
				is_galactic_community_member = yes
				is_active_resolution = resolution_rulesofwar_6
			}
			modifier = { # Ariphaos
				factor = 10
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_rulesofwar_last_resort_doctrine"
					is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
				}
			}
		}
	}

	option = { # Expanded Gestalts
		name = "protection_wars"
		
		policy_flags = {
			protection_wars
		}
		
		potential = {
			has_valid_civic = civic_mutualistic_behavior
		}
		
	
		on_enabled = {
			hidden_effect = {
				check_casus_belli_valid = {
					type = cb_protect
				}
			}
		}

		on_disabled = {
			hidden_effect = {
				check_casus_belli_valid = {
					type = cb_protect
				}
			}
		}
		
		AI_weight = {
			modifier = {
				factor = 2
				has_valid_civic = civic_mutualistic_behavior
			}
		}
	}

	option = {
		name = "no_wars"

		policy_flags = {
			no_wars
		}

		valid = {
			OR = { # NGS
				NOR = {
					has_ethic = "ethic_fanatic_militarist"
					is_homicidal = yes # STU
					has_civic = "civic_crusader_spirit"
					has_valid_civic = "civic_crusader_spirit_corporate" # Organic Zealots
				}
				AND = { # NGS
					is_galactic_community_member = yes
					is_active_resolution = resolution_rulesofwar_6
				}
			}
		}

		AI_weight = {
			modifier = {
				factor = 5
				has_ethic = "ethic_fanatic_pacifist"
			}
			modifier = { # NGS
				factor = 5
				is_active_resolution = resolution_rulesofwar_6
				is_galactic_community_member = yes
			}
			modifier = {
				factor = 0
				NOR = { # NGS
					has_ethic = "ethic_fanatic_pacifist"
					is_active_resolution = resolution_rulesofwar_6 # NGS
				}
			}
		}
	}
}

## War Doctrine
# Merge between Intel Expanded, OSA, MECR, StarTech, Ariphaos, Scripted Trigger Undercoat
war_doctrine = {
	potential = {
		OR = {
			AND = {
				is_playable = yes # STU
				has_tradition = tr_supremacy_finish
			}
			is_country_type = enclave_mercenary
			AND = { # MECR
				is_galactic_community_member = yes
				has_federation = yes
				federation = {
					OR = {
						has_federation_law = imperial_ministry_of_defence_strategy_institute
						has_federation_law = imperial_ministry_of_defence_joint_headquarter
					}
				}
			}
			AND = { # MECR
				is_ECI_activated = yes
				is_country_type = default
			}
		}
	}

	option = {
		name = "defense_in_depth_doctrine"

		policy_flags = { defense_in_depth_doctrine } # Intel Expanded
		modifier = {
			ship_home_territory_fire_rate_mult = 0.15 # OSA 0.10 -> 0.15
			ship_hull_mult = 0.25 # OSA
		}

		AI_weight = {
			factor = 1
		}
	}

	option = {
		name = "hit_and_run_doctrine"

		policy_flags = { hit_and_run_doctrine } # Intel Expanded
		modifier = {
			ship_disengage_opportunities_add = 2
			ship_disengage_chance_mult = 0.35 # OSA 0.33 -> 0.35
			ship_emergency_ftl_mult = -0.25
		}

		AI_weight = {
			factor = 5 # StarTech AI 10 -> 5
			modifier = {
				factor = 0
				is_ai = no # StarTech AI
				NOR = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
				}
			}
			modifier = { # StarTech AI
				factor = 1000
				or = {
					not = { has_technology = tech_energy_torpedoes_1 }
					has_country_flag = str_just_got_launchers
				}
				not = { has_country_flag = str_need_to_counter_corvettes }
				is_ai = yes
			}
		}
	}

	option = {
		name = "rapid_deployment_doctrine"

		policy_flags = { rapid_deployment_doctrine } # Intel Expanded
		modifier = {
			ship_speed_mult = 0.30 # OSA 0.25 -> 0.30
			ship_weapon_range_mult = 0.10
		}

		AI_weight = {
			factor = 10
			modifier = {
				factor = 100
				is_country_type = enclave_mercenary
			}
			modifier = { # StarTech AI
				factor = 0.1
				is_ai = no
				NOT = { is_preferred_weapons = weapon_type_explosive }
			}
			modifier = { # StarTech AI
				factor = 1000
				nor = {
					not = { has_technology = tech_energy_torpedoes_1 }
					has_country_flag = str_just_got_launchers
				}
				or = {
					has_country_flag = str_has_bad_fleet_score
					used_naval_capacity_percent < 0.5
				}
				is_ai = yes
			}
		}
	}

	option = {
		name = "no_retreat_doctrine"

		valid = {
			OR = {
				has_ethic = ethic_militarist
				has_ethic = ethic_fanatic_militarist
				is_gestalt = yes # Merged
				has_civic = civic_fanatic_purifiers
			}
		}

		potential = { # MECR
			if = {
				limit = { is_ECI_activated = yes }
				NOR = {
					has_tradition = tr_supremacy_finish
					has_tradition = tr_revolution_finish
				}
			}
		}

		policy_flags = {}
		modifier = {
			ship_disengage_chance_reduction = 1
			ship_emergency_ftl_min_days_mult = 0.5
			ship_fire_rate_mult = 0.40 # OSA 0.33 -> 0.40
		}

		AI_weight = {
			factor = 100
			modifier = {
				factor = 0
				is_ai = no # StarTech AI
				NOR = {
					has_ai_personality = honorbound_warriors
					has_ai_personality = devouring_swarm
				}
			}
			modifier = { # StarTech AI
				factor = 100
				nor = {
					not = { has_technology = tech_energy_torpedoes_1 }
					has_country_flag = str_just_got_launchers
				}
				not = { has_country_flag = str_has_bad_fleet_score }
				used_naval_capacity_percent > 0.5
				is_ai = yes
			}
		}
	}

	option = { # MECR
		name = "crowd_tactics"

		potential = {
			is_ECI_activated = yes
			OR = {
				has_tradition = tr_supremacy_finish
				has_tradition = tr_revolution_finish
			}
		}

		policy_flags = {}
		modifier = {
			country_naval_cap_mult = 0.2
			country_command_limit_add = 40
			ships_upkeep_mult = -0.2
			ship_disengage_chance_mult = 0.25
		}

		AI_weight = {
			factor = 10
		}
	}
	option = { # MECR
		name = "dominant_firepower"

		potential = {
			is_ECI_activated = yes
			OR = {
				has_tradition = tr_supremacy_finish
				has_tradition = tr_revolution_finish
			}
		}

		policy_flags = {}
		modifier = {
			ship_weapon_damage = 0.2
			ship_weapon_range_mult = 0.2
			ship_accuracy_add = 5
		}

		AI_weight = {
			factor = 10
		}
	}
	option = { # MECR
		name = "maneuver_warfare"

		potential = {
			is_ECI_activated = yes
			OR = {
				has_tradition = tr_supremacy_finish
				has_tradition = tr_revolution_finish
			}
		}

		policy_flags = {}
		modifier = {
			ship_speed_mult = 0.4
			ship_evasion_add = 15
		}

		AI_weight = {
			factor = 10
		}
	}
	option = { # MECR
		name = "4D_battlefield"

		potential = {
			is_ECI_activated = yes
			OR = {
				has_tradition = tr_supremacy_finish
				has_tradition = tr_revolution_finish
			}
		}

		valid = {
			OR = {
				has_technology = tech_jump_drive_1
				has_technology = tech_psi_jump_drive_1
			}
		}

		policy_flags = {}
		modifier = {
			ship_windup_mult = -0.25
			ship_jumpdrive_cooldown_mult = -0.25
			ship_ftl_jumpdrive_range_mult = 0.25
			ship_engagement_range_mult = 1
		}

		AI_weight = {
			factor = 10
		}
	}
	option = { # MECR
		name = "to_die"

		potential = {
			is_ECI_activated = yes
			OR = {
				has_tradition = tr_supremacy_finish
				has_tradition = tr_revolution_finish
			}
		}

		valid = {
			OR = {
				has_ethic = ethic_militarist
				has_ethic = ethic_fanatic_militarist
				has_ethic = ethic_authoritarian
				has_ethic = ethic_fanatic_authoritarian
				has_ethic = ethic_gestalt_consciousness
				has_civic = civic_fanatic_purifiers
			}
		}

		policy_flags = {}
		modifier = {
			ship_fire_rate_mult = 0.5
			ship_speed_mult = 0.15
			ship_disengage_chance_reduction = 1
			ship_emergency_ftl_min_days_mult = 1
			ship_evasion_add = -10
		}

		AI_weight = {
			factor = 1000
		}
	}
	option = { # MECR
		name = "pure_fury"

		potential = {
			is_ECI_activated = yes
			OR = {
				has_tradition = tr_supremacy_finish
				has_tradition = tr_revolution_finish
			}
		}

		valid = {
			has_civic = civic_fanatic_purifiers
		}

		policy_flags = {}
		modifier = {
			ship_fire_rate_mult = 0.66
			ship_speed_mult = 0.66
			ship_disengage_chance_reduction = 10
			ship_emergency_ftl_min_days_mult = 1
			ship_evasion_add = -10
		}

		AI_weight = {
			factor = 100000
		}
	}
	option = { # MECR
		name = "scourge_of_the_universe"

		potential = {
			is_ECI_activated = yes
			OR = {
				has_tradition = tr_supremacy_finish
				has_tradition = tr_revolution_finish
			}
		}

		valid = {
			has_civic = civic_hive_devouring_swarm
		}

		policy_flags = {}
		modifier = {
			shipsize_corvette_hull_add = 300
			shipsize_destroyer_hull_add = 200
			country_naval_cap_mult = 1
			country_command_limit_add = 80
			ship_hull_regen_add_perc = 1
			ship_armor_regen_add_perc = 1
		}

		AI_weight = {
			factor = 100000
		}
	}
	option = { # MECR
		name = "mega_brutal"

		potential = {
			is_ECI_activated = yes
			OR = {
				has_tradition = tr_supremacy_finish
				has_tradition = tr_revolution_finish
			}
		}

		valid = {
			has_civic = civic_machine_terminator
		}

		policy_flags = {}
		modifier = {
			ship_weapon_damage = 0.64
			ship_weapon_range_mult = 0.32
			ship_accuracy_add = 16
			ship_tracking_add = 16
		}

		AI_weight = {
			factor = 100000
		}
	}

	option = { # MECR
		name = "imperial_glory_doctrine"

		potential = {
			is_galactic_community_member = yes
			has_federation = yes
			federation = {
				OR = {
					has_federation_law = imperial_ministry_of_defence_strategy_institute
					has_federation_law = imperial_ministry_of_defence_joint_headquarter
				}
			}
		}

		valid = {
			always = yes
		}

		policy_flags = {}
		modifier = {
			ship_community_territory_speed_mult = 0.25
			ship_ftl_jumpdrive_range_mult = 0.25
			ship_weapon_range_mult = 0.20
			ship_fire_rate_mult = 0.20
			ship_friendly_territory_fire_rate_mult = 0.20
			ship_disengage_chance_reduction = 0.75
			ship_emergency_ftl_min_days_mult = 0.5
		}

		AI_weight = {
			factor = 1000
		}
	}
}

## Subjugation War Terms
# Merge between OSA, Ariphaos, Scripted Trigger Undercoat
subjugation_war_terms = {
	potential = {
		is_subject = no
		OR = {
			is_default_or_fallen = yes # STU
		}
	}

	option = {
		name = "oppressive_terms"

		policy_flags = {
			oppressive_terms
		}

		potential = {
			is_megacorp = no # Merged
		}

		on_enabled = {
			hidden_effect = { #this is to remember the player's pick if they are subjugated
				if = {
					limit = { is_ai = no }
					set_country_flag = oppressive_terms_preference
					remove_country_flag = benevolent_terms_preference
					remove_country_flag = balanced_terms_preference
				}
			}
		}

		ai_weight = {
			weight = 10

			# Nice people who would never pick this.
			modifier = {
				factor = 0.1
				has_ethic = ethic_fanatic_xenophile
			}
			modifier = {
				factor = 0.5
				has_ethic = ethic_xenophile
			}
			modifier = {
				factor = 0.1
				has_ethic = ethic_fanatic_pacifist
			}
			modifier = {
				factor = 0.5
				has_ethic = ethic_pacifist
			}

			# Bad people who likely would.
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_xenophobe
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_xenophobe
			}
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_authoritarian
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_authoritarian
			}
			modifier = {
				factor = 10
				has_country_flag = oppressive_terms_preference
			}
		}
	}

	option = {
		name = "balanced_terms"

		policy_flags = {
			balanced_terms
		}

		potential = {
			is_megacorp = no # Merged
		}

		on_enabled = {
			hidden_effect = {
				if = {
					limit = { is_ai = no }
					set_country_flag = balanced_terms_preference
					remove_country_flag = benevolent_terms_preference
					remove_country_flag = oppressive_terms_preference
				}
			}
		}

		ai_weight = {
			weight = 10

			# Rational people who would like this.
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_egalitarian
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_egalitarian
			}
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_materialist
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_materialist
			}
			modifier = {
				factor = 10
				has_country_flag = balanced_terms_preference
			}
		}
	}

	option = {
		name = "benevolent_terms"

		policy_flags = {
			benevolent_terms
		}

		potential = {
			is_megacorp = no # Merged
		}

		on_enabled = {
			hidden_effect = {
				if = {
					limit = { is_ai = no }
					set_country_flag = benevolent_terms_preference
					remove_country_flag = balanced_terms_preference
					remove_country_flag = oppressive_terms_preference
				}
			}
		}

		ai_weight = {
			weight = 10

			# Bad people who probably not pick this.
			modifier = {
				factor = 0.1
				has_ethic = ethic_fanatic_xenophobe
			}
			modifier = {
				factor = 0.5
				has_ethic = ethic_xenophobe
			}
			modifier = {
				factor = 0.1
				has_ethic = ethic_fanatic_authoritarian
			}
			modifier = {
				factor = 0.5
				has_ethic = ethic_authoritarian
			}

			# Nice people who probably would.
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_xenophile
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_xenophile
			}
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_pacifist
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_pacifist
			}
			modifier = {
				factor = 10
				has_country_flag = benevolent_terms_preference
			}
		}
	}

	option = {
		name = "oppressive_corporate_terms"

		policy_flags = {
			oppressive_terms
		}

		potential = {
			is_megacorp = yes # Merged
		}

		on_enabled = {
			hidden_effect = { #this is to remember the player's pick if they are subjugated
				if = {
					limit = { is_ai = no }
					set_country_flag = oppressive_terms_preference
					remove_country_flag = benevolent_terms_preference
					remove_country_flag = balanced_terms_preference
				}
			}
		}

		ai_weight = {
			weight = 10

			# Nice people who would never pick this.
			modifier = {
				factor = 0.1
				has_ethic = ethic_fanatic_xenophile
			}
			modifier = {
				factor = 0.5
				has_ethic = ethic_xenophile
			}
			modifier = {
				factor = 0.1
				has_ethic = ethic_fanatic_pacifist
			}
			modifier = {
				factor = 0.5
				has_ethic = ethic_pacifist
			}

			# Bad people who likely would.
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_xenophobe
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_xenophobe
			}
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_authoritarian
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_authoritarian
			}
			modifier = {
				factor = 10
				has_country_flag = oppressive_terms_preference
			}
		}
	}

	option = {
		name = "balanced_corporate_terms"

		policy_flags = {
			balanced_terms
		}

		on_enabled = {
			hidden_effect = {
				if = {
					limit = { is_ai = no }
					set_country_flag = balanced_terms_preference
					remove_country_flag = benevolent_terms_preference
					remove_country_flag = oppressive_terms_preference
				}
			}
		}

		potential = {
			is_megacorp = yes # Merged
		}

		ai_weight = {
			weight = 10

			# Rational people who would like this.
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_egalitarian
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_egalitarian
			}
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_materialist
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_materialist
			}
			modifier = {
				factor = 10
				has_country_flag = balanced_terms_preference
			}
		}
	}

	option = {
		name = "benevolent_corporate_terms"

		policy_flags = {
			benevolent_terms
		}

		potential = {
			is_megacorp = yes # Merged
		}

		on_enabled = {
			hidden_effect = {
				if = {
					limit = { is_ai = no }
					set_country_flag = benevolent_terms_preference
					remove_country_flag = balanced_terms_preference
					remove_country_flag = oppressive_terms_preference
				}
			}
		}

		ai_weight = {
			weight = 10

			# Bad people who probably not pick this.
			modifier = {
				factor = 0.1
				has_ethic = ethic_fanatic_xenophobe
			}
			modifier = {
				factor = 0.5
				has_ethic = ethic_xenophobe
			}
			modifier = {
				factor = 0.1
				has_ethic = ethic_fanatic_authoritarian
			}
			modifier = {
				factor = 0.5
				has_ethic = ethic_authoritarian
			}

			# Nice people who probably would.
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_xenophile
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_xenophile
			}
			modifier = {
				factor = 1.3
				has_ethic = ethic_fanatic_pacifist
			}
			modifier = {
				factor = 1.15
				has_ethic = ethic_pacifist
			}
			modifier = {
				factor = 10
				has_country_flag = benevolent_terms_preference
			}
		}
	}
}

## Orbital Bombardment
# Merge between Merger of Rules, Organic Zealots, OSA, Bug Branch, Gigastructural Engineering, NGS, Expanded Gestalts, EMEX, StarTech, Ariphaos, Scripted Trigger Undercoat
orbital_bombardment = {

	potential = {
		OR = {
			merg_is_default_empire = yes
			is_country_type = vol
		}
	}

	option = {
		name = "orbital_bombardment_selective"

		policy_flags = {
			orbital_bombardment_selective
		}

		AI_weight = {
			modifier = {
				factor = 0
				NOR = {
					is_pacifist = yes
					# Ethics and Civics Classic
					is_green = yes
					# Ethics & Civics: Bug Branch
					is_ecocentric = yes
				}
				NOT = {
					is_galactic_community_member = yes
					OR = {
						is_active_resolution = "resolution_rulesofwar_independent_tribunals"
						is_active_resolution = "resolution_rulesofwar_last_resort_doctrine"
						is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
					}
				}
			}
		}
	}
	option = {
		name = "orbital_bombardment_indiscriminate"

		in_breach_of = {
			{
				key = resolution_rulesofwar_independent_tribunals
			}
			{ # NGS
				key = resolution_rulesofwar_last_resort_doctrine
			}
			{ # NGS
				key = resolution_rulesofwar_demobilization_initiative
			}
			{ # NGS
				key = resolution_rulesofwar_6
			}
		}

		policy_flags = {
			orbital_bombardment_indiscriminate
		}
		modifier = {}

		valid = {
			NOR = {
				is_pacifist = yes
				# Expanded Gestalts
				has_valid_civic = civic_mutualistic_behavior
				# Ethics and Civics Alternative - Redux
				has_valid_civic = civic_xeno_militarist
				# Ethics & Civics: Bug Branch
				is_bugged_interventionalist = yes
			}
		}
		AI_weight = {
			modifier = {
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_rulesofwar_independent_tribunals"
					is_active_resolution = "resolution_rulesofwar_last_resort_doctrine"
					is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
					is_active_resolution = "resolution_rulesofwar_6" # NGS
				}
			}
			modifier = { # NGS
				factor = 5
				is_militarist = yes
				NOR = {
					is_active_resolution = "resolution_rulesofwar_independent_tribunals"
					is_active_resolution = "resolution_rulesofwar_last_resort_doctrine"
					is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
					is_active_resolution = "resolution_rulesofwar_6"
				}
			}
		}
	}
	option = {
		name = "orbital_bombardment_armageddon"

		in_breach_of = {
			{
				key = resolution_rulesofwar_independent_tribunals
			}
			{ # NGS
				key = resolution_rulesofwar_last_resort_doctrine
			}
			{ # NGS
				key = resolution_rulesofwar_demobilization_initiative
			}
			{ # NGS
				key = resolution_rulesofwar_6
			}
		}

		potential = {
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_machine_terminator
				has_valid_civic = civic_hive_devouring_swarm
				# ZOFE
				is_country_type = ascended_empire
				# EMEX
				has_valid_civic = civic_bringers_of_death
				# Organic Zealots
				has_valid_civic = civic_organic_zealots
			}
		}

		policy_flags = {
			orbital_bombardment_armageddon
		}
		modifier = {}

		AI_weight = {
			modifier = {
				factor = 10
				OR = {
					has_valid_civic = civic_fanatic_purifiers
					has_valid_civic = civic_machine_terminator
					# ZOFE
					has_valid_civic = civic_galactic_superpower
					# EMEX
					has_valid_civic = civic_bringers_of_death
					# Organic Zealots
					has_valid_civic = civic_organic_zealots
				}
			}
			modifier = {
				factor = 10
				has_ascension_perk = ap_become_the_crisis
			}
		}
	}
	option = {
		name = "orbital_bombardment_redtoxin"
		in_breach_of = { { key = resolution_rulesofwar_independent_tribunals } }
		potential = {
			merg_has_gigastructures = yes
			OR = {
				merg_is_default_empire = yes
				is_country_type = vol
			}
		}
		prerequisites = {
			tech_scourge_deployment
		}
		policy_flags = {
			orbital_bombardment_redtoxin
		}
		valid = {
			merg_has_gigastructures = yes
			NOR = {
				is_pacifist = yes
				# Ethics and Civics Classic
				is_green = yes
				# Ethics & Civics: Bug Branch
				is_ecocentric = yes
			}
		}
		AI_weight = {
			modifier = {
				factor = 10
				OR = {
					has_valid_civic = civic_fanatic_purifiers
					has_valid_civic = civic_machine_terminator
				}
			}
			modifier = {
				factor = 10
				has_ascension_perk = ap_become_the_crisis
			}
		}
	}
}

## Interference
# Merge between OSA, NGS, Ariphaos, Scripted Trigger Undercoat
interference = {

	potential = {
		has_met_primitives = yes
	}

	option = {
		name = "interference_not_allowed"

		policy_flags = {
			interference_not_allowed
		}

		on_enabled = {
			hidden_effect = { 
				set_country_flag = encountered_first_primitive
			}
		}

		in_breach_of = {
			{
				key = resolution_galacticstudies_advanced_xenostudies
			}
			{
				key = resolution_pre_ftl_stances_equal_standing
			}
			{
				key = resolution_pre_ftl_stances_exploitation
			}
		}

		valid = {
			OR = {
				custom_tooltip = {
					text = is_a_signatory_vassal
					any_agreement = { agreement_preset = preset_signatory }
				}
				is_active_resolution = resolution_pre_ftl_stances_non_interference
				NOR = {
					is_homicidal = yes # STU
				}
				OR = { # Ariphaos
					NOT = { has_ethic = "ethic_fanatic_xenophobe" }
					is_pacifist = yes
				}
			}
		}

		AI_weight = {
			modifier = {
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_galacticstudies_advanced_xenostudies"
					is_active_resolution = "resolution_galacticstudies_ethical_guideline_refactoring"
					is_active_resolution = "resolution_galacticstudies_extradimensional_experimentation"
					is_active_resolution = "resolution_pre_ftl_stances_equal_standing"
					is_active_resolution = "resolution_pre_ftl_stances_exploitation"
				}
			}
			modifier = { # Ariphaos
				factor = 5
				has_valid_civic = "civic_inwards_perfection"
			}
		}
	}

	option = {
		name = "interference_subtle"

		policy_flags = {
			interference_subtle
		}

		on_enabled = {
			hidden_effect = { set_country_flag = encountered_first_primitive }
		}

		valid = {
			OR = {
				custom_tooltip = {
					text = is_a_signatory_vassal
					any_agreement = { agreement_preset = preset_signatory }
				}
				NOR = {
					has_ethic = "ethic_fanatic_xenophobe"
					is_homicidal = yes # STU
				}
			}
		}

		AI_weight = {
			modifier = {
				factor = 2
				has_valid_ai_personality = yes
				has_ai_personality_behaviour = infiltrator
			}
			modifier = {
				factor = 0
				has_valid_ai_personality = yes
				NOT = {
					has_ai_personality_behaviour = infiltrator
				}
			}
		}
	}

	option = {
		name = "interference_active"

		policy_flags = {
			interference_active
		}
		
		in_breach_of = {
			{
				key = resolution_pre_ftl_stances_non_interference
			}
			{ # NGS
				key = resolution_prime_directive
			}
			{ # NGS
				key = resolution_galactic_cooperation_initiative
			}
		}

		on_enabled = {
			hidden_effect = { set_country_flag = encountered_first_primitive }
		}

		valid = {
			NOR = {
				custom_tooltip = {
					text = is_a_signatory_vassal
					any_agreement = { agreement_preset = preset_signatory }
				}
				has_valid_civic = "civic_fanatic_purifiers"
				has_valid_civic = "civic_hive_devouring_swarm"
			}
		}

		AI_weight = {
			modifier = {
				factor = 2
				has_valid_ai_personality = yes
				OR = {
					has_ai_personality_behaviour = infiltrator
					has_ai_personality_behaviour = dominator
				}
			}
			modifier = {
				factor = 0
				has_valid_ai_personality = yes
				NOR = {
					has_ai_personality_behaviour = infiltrator
					has_ai_personality_behaviour = dominator
				}
			}
			modifier = {
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_galacticstudies_advanced_xenostudies"
					is_active_resolution = "resolution_galacticstudies_ethical_guideline_refactoring"
					is_active_resolution = "resolution_galacticstudies_extradimensional_experimentation"
					is_active_resolution = "resolution_pre_ftl_stances_non_interference"
					is_active_resolution = "resolution_prime_directive" # NGS
					is_active_resolution = "resolution_galactic_cooperation_initiative" # NGS
				}
			}
		}
	}
	option = {
		name = "interference_aggressive"

		in_breach_of = {
			{
				key = resolution_pre_ftl_stances_non_interference
			}
			{
				key = resolution_pre_ftl_stances_equal_standing
			}
			{ # NGS
				key = resolution_prime_directive
			}
			{ # NGS
				key = resolution_galactic_cooperation_initiative
			}
		}

		valid = {
			custom_tooltip = {
				success_text = is_not_a_signatory_vassal_success
				fail_text = is_not_a_signatory_vassal_fail
				NOT = { any_agreement = { agreement_preset = preset_signatory } }
			}
			NOR = {
				has_ethic = "ethic_pacifist"
				has_ethic = "ethic_fanatic_pacifist"
				has_ethic = "ethic_xenophile"
				has_ethic = "ethic_fanatic_xenophile"
				has_valid_civic = civic_machine_exploration_protocol
			}
		}
		on_enabled = {
			hidden_effect = { set_country_flag = encountered_first_primitive }
		}
		policy_flags = {
			interference_aggressive
		}
		modifier = {}
		AI_weight = {
			modifier = {
				factor = 3
				has_valid_ai_personality = yes
				has_ai_personality_behaviour = dominator
			}
			modifier = {
				factor = 0
				has_valid_ai_personality = yes
				NOT = {
					has_ai_personality_behaviour = dominator
				}
			}
			modifier = {
				factor = 0
				OR = {
					has_ethic = "ethic_pacifist"
					has_ethic = "ethic_fanatic_pacifist"
				}
			}
			modifier = {
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_pre_ftl_stances_non_interference"
					is_active_resolution = "resolution_pre_ftl_stances_equal_standing"
					is_active_resolution = "resolution_prime_directive" # NGS
					is_active_resolution = "resolution_galactic_cooperation_initiative" # NGS
				}
			}
		}
	}
}

## Enlightenment
# Merge between OSA, Ariphaos, Scripted Trigger Undercoat
enlightenment = {

	potential = {
		has_met_primitives = yes
	}

	option = {
		name = "enlightenment_not_allowed"

		policy_flags = {
			enlightenment_not_allowed
		}

		AI_weight = {
			weight = 1
			modifier = { # Ariphaos
				factor = 3
				is_xenophobe = yes
			}
		}
	}

	option = {
		name = "enlightenment_covert_only"

		policy_flags = {
			enlightenment_covert_only
		}

		valid = {
			NOT = { has_policy_flag = interference_not_allowed }
			NOR = {
				has_ethic = "ethic_fanatic_xenophobe"
				is_homicidal = yes
			}
		}
		
		AI_weight = {
			weight = 1
		}
	}

	option = {
		name = "enlightenment_allowed"

		policy_flags = {
			enlightenment_allowed
		}
		modifier = {}

		valid = {
			NOT = { has_policy_flag = interference_not_allowed }
			NOR = {
				has_ethic = "ethic_fanatic_xenophobe"
				is_homicidal = yes
			}
		}

		AI_weight = {
			modifier = {
				factor = 2
				has_valid_ai_personality = yes
				has_ai_personality_behaviour = uplifter
			}
			modifier = {
				factor = 0
				has_valid_ai_personality = yes
				NOT = { has_ai_personality_behaviour = uplifter }
			}
			modifier = {
				factor = 0
				OR = {
					has_ethic = "ethic_xenophobe"
					has_ethic = "ethic_fanatic_xenophobe"
				}
			}
		}
	}
}

## Resettlement
# Merge between OSA, Bug Branch, EED, StarTech, Scripted Trigger Undercoat
resettlement = {
	potential = {
		is_gestalt = no
	}

	option = {
		name = "resettlement_not_allowed"

		policy_flags = {
			resettlement_not_allowed
		}
		
		in_breach_of = { # EED
			{
				key = resolution_lawandorder_free_migration
			}
		}
	}

	option = {
		name = "resettlement_allowed"

		policy_flags = {
			resettlement_allowed
		}

		valid = { # Bug Branch
			is_bugged_spirit_of_freedom = no
		}

		modifier = {}

		AI_weight = {
			factor = 10
			modifier = {
				factor = 0
				OR = {
					is_ai = yes # StarTech AI
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
				}
				NAND = { # EED
					is_galactic_community_member = yes
					OR = {
						is_active_resolution = "resolution_lawandorder_free_migration"
						is_active_resolution = "resolution_lawandorder_informed_governance"
					}
				}
			}
		}
	}
}

## Appropriation
# Merge between OSA, EED, StarTech, Ariphaos
appropriation = {
	potential = {
		is_gestalt = no
		has_comms_with_alien_empire = yes
	}

	option = {
		name = "appropriation_not_allowed"

		policy_flags = {
			appropriation_not_allowed
		}
		
		in_breach_of = { # EED
			{
				key = resolution_lawandorder_free_migration
			}
		}

		AI_weight = {
			modifier = {
				factor = 10
				has_ai_personality_behaviour = multispecies
			}
			modifier = { # StarTech AI
				factor = 15
				is_pacifist = no
				or = {
					has_civic = civic_slaver_guilds
					has_civic = civic_indentured_assets
				}
			}
			modifier = { # EED
				factor = 0.05
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_lawandorder_free_migration"
					is_active_resolution = "resolution_lawandorder_informed_governance"
				}
			}
		}
	}

	option = {
		name = "appropriation_allowed"

		policy_flags = {
			appropriation_allowed
		}
		modifier = {}

		AI_weight = {
			modifier = {
				factor = 10
				NOT = { has_ai_personality_behaviour = multispecies }
				is_pacifist = yes # StarTech AI
			}
		}
	}
}

## Leader Enhancement
# Merge between OSA, Bug Branch, StarTech
leader_enhancement = {

	potential = {
		has_technology = tech_selected_lineages
	}

	option = {
		name = "leader_enhancement_natural_selection"

		policy_flags = {
			leader_enhancement_natural_selection
		}

		in_breach_of = {
			{
				key = resolution_galacticstudies_ethical_guideline_refactoring
				trigger = {
					OR = {
						has_technology = tech_selected_lineages
						has_technology = tech_capacity_boosters
					}
				}
			}
		}

		on_enabled = {
			# custom_tooltip = "policy_allow_slavery_effect_disable"
		}

		modifier = {}

	}

	option = {
		name = "leader_enhancement_selected_lineages"

		policy_flags = {
			leader_enhancement_selected_lineages
		}
		modifier = {
			species_leader_exp_gain = 0.15 # OSA 0.10 -> 0.15
			leader_age = 10
			leaders_cost_mult = 0.5
		}

		in_breach_of = {
			{
				key = resolution_galacticstudies_ethical_guideline_refactoring
				trigger = {
					has_technology = tech_capacity_boosters
				}
			}
		}

		valid = {
			NOT = { has_ethic = "ethic_fanatic_pluralist" } # Bug Branch
		}

		AI_weight = {
			factor = 2
			modifier = {
				factor = 0
				OR = {
					has_ethic = "ethic_cooperative" # Bug Branch
					has_ethic = "ethic_fanatic_cooperative" # Bug Branch
				}
				NOT = {
					has_valid_ai_personality = yes
					is_ai = yes
					is_galactic_community_member = yes
					OR = {
						is_active_resolution = "resolution_galacticstudies_ethical_guideline_refactoring"
						is_active_resolution = "resolution_galacticstudies_extradimensional_experimentation"
					}
				}
			}
		}

		prerequisites = { tech_selected_lineages }
	}

	option = {
		name = "leader_enhancement_capacity_boosters"

		policy_flags = {
			leader_enhancement_capacity_boosters
		}
		modifier = {
			species_leader_exp_gain = 0.30 # OSA 0.20 -> 0.30
			leader_age = 20
			leaders_cost_mult = 1
		}

		valid = {
			NOR = {
				has_ethic = "ethic_pluralist" # Bug Branch
				has_ethic = "ethic_fanatic_pluralist" # Bug Branch
			}
		}

		prerequisites = { tech_capacity_boosters }

		AI_weight = {
			factor = 3
		}
	}
}

## First Contact Protocol
# Merge between OSA, Expanded Gestalts, StarTech, Ariphaos, Scripted Trigger Undercoat
first_contact_protocol = {

	potential = {
		always = yes
	}

	option = {
		name = "first_contact_proactive"

		policy_flags = {
			first_contact_proactive
		}

		modifier = {
			first_contact_speed_mult = 0.1
		}

		on_enabled = {
		}

		valid = {
			is_homicidal = no
			is_xenophobe = no
			NOT = { has_origin = origin_payback }
		}

		AI_weight = {
			modifier = {
				factor = 2
				is_pacifist = yes
			}
			modifier = {
				factor = 2
				is_xenophile = yes
			}
			modifier = {
				factor = 2
				OR = {
					has_valid_civic = civic_machine_servitor
					has_valid_civic = civic_hive_empath # Ariphaos
				}
			}
			modifier = { # Ariphaos
				factor = 0.5
				OR = {
					has_valid_civic = civic_hive_strength_of_legions
					has_valid_civic = civic_machine_warbots
				}
			}
			modifier = { # StarTech AI
				factor = 10
				years_passed > 40
			}
		}
	}

	option = {
		name = "first_contact_cautious"

		policy_flags = {
			first_contact_cautious
		}

		modifier = {
			first_contact_defense_add = 2
		}

		on_enabled = {
		}

		valid = {
			is_homicidal = no
		}

		AI_weight = {
			modifier = {
				factor = 1.5
				always = yes #Liu Cixin is right
			}
			modifier = {
				factor = 2
				has_origin = origin_payback
			}
			modifier = { # StarTech AI
				factor = 10
				years_passed > 40
			}
		}
	}

	option = {
		name = "first_contact_attack_allowed"

		policy_flags = {
			first_contact_attack_allowed
		}
		modifier = {}

		valid = {
			NOT = { has_valid_civic = civic_mutualistic_behavior } # Expanded Gestalts
			is_pacifist = no
			is_xenophile = no
		}


		AI_weight = {
			modifier = {
				factor = 2
				is_militarist = yes
			}
			modifier = {
				factor = 2
				is_xenophobe = yes
			}
			modifier = {
				factor = 2
				is_gestalt = yes
			}
			modifier = { # Ariphaos
				factor = 2
				OR = {
					has_valid_civic = civic_hive_strength_of_legions
					has_valid_civic = civic_machine_warbots
				}
			}
			modifier = { # Ariphaos
				factor = 0
				is_megacorp = yes
				is_criminal_syndicate = no
			}
			modifier = { # Ariphaos
				factor = 0
				OR = {
					has_valid_civic = civic_machine_servitor
					has_valid_civic = civic_hive_empath
				}
			}
		}
	}
}

## Border Policy
# Merge between Organic Zealots, OSA, Bug Branch, ACOT:SBTG, StarTech, Ariphaos, Scripted Trigger Undercoat
border_policy = {

	potential = {
		always = yes
	}

	option = {
		name = "border_policy_open"

		policy_flags = {
			border_policy_open
		}

		valid = {
			OR = { # ACOT:SBTG
				is_playable = yes # STU
				is_country_type = eternal_empire
				is_country_type = ascended_empire
				is_country_type = sbtg_stellarborne_empire_active
			}
			is_homicidal = no # STU
			NOT = { has_valid_civic = civic_inwards_perfection } # Bug Branch
		}
	}

	option = {
		name = "border_policy_closed"

		policy_flags = {
			border_policy_closed
		}
		modifier = {}

		valid = {
			always = yes # Bug Branch
		}

		AI_weight = {
			factor = 0.5 # StarTech AI 10 -> 0.5
			modifier = {
				factor = 0
				is_megacorp = yes # Merged
				NOT = { has_crisis_level = crisis_level_5 } # Ariphaos
			}
			modifier = { # StarTech AI
				factor = 20
				has_valid_ai_personality = yes
				OR = {
					has_ai_personality_behaviour = isolationist
					has_ai_personality_behaviour = attack_neutrals
				}
			}
			modifier = {
				factor = 0
				has_valid_ai_personality = yes
				NOR = {
					has_ai_personality_behaviour = isolationist
					has_ai_personality_behaviour = attack_neutrals
				}
				NOT = { has_crisis_level = crisis_level_5 } # Ariphaos
			}
			modifier = { # StarTech AI
				factor = 5
				has_valid_ai_personality = no
				OR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
			}
			modifier = {
				factor = 0
				has_valid_ai_personality = no
				NOR = {
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
				NOT = { has_crisis_level = crisis_level_5 } # Ariphaos
			}
			modifier = {
				factor = 10
				has_crisis_level = crisis_level_5
			}
		}
	}
}

## Food Policy
# Merge between Intel Expanded, OSA, StarTech, Ariphaos
food_policy = {
	potential = {
		AND = { # OSA
			is_gestalt = no
			has_active_tradition = tr_administratum_finish
		}
	}

	option = {
		name = "food_policy_rationing"

		policy_flags = { food_policy_rationing } # Intel Expanded

		modifier = {
			planet_pops_organics_food_upkeep_mult = -0.25
			planet_pops_organics_minerals_upkeep_mult = -0.25
			pop_growth_speed = -0.1
			biological_pop_happiness = -0.1
			lithoid_pop_happiness = -0.1
		}

		AI_weight = {
			factor = 0
		}
	}

	option = {
		name = "food_policy_normal"

		policy_flags = { food_policy_normal } # Intel Expanded

		modifier = {}

		AI_weight = {
			factor = 1
			modifier = { # Ariphaos
				factor = 0
				days_passed > 28
			}
		}
	}

	option = {
		name = "food_policy_generous"

		policy_flags = { food_policy_generous } # Intel Expanded

		modifier = {
			planet_pops_organics_food_upkeep_mult = 0.25
			planet_pops_organics_minerals_upkeep_mult = 0.25
			biological_pop_happiness = 0.05
			lithoid_pop_happiness = 0.05
			pop_growth_speed = 0.10
		}

		AI_weight = {
			factor = 0
			modifier = { # Ariphaos
				add = 500
				days_passed > 28
			}
		}
	}
}

## Food Policy (Gestalt)
# Merge between Intel Expanded, OSA, StarTech, Ariphaos
food_policy_gestalt = {
	potential = {
		AND = { # OSA
			is_gestalt = yes
			has_active_tradition = tr_administratum_finish
		}
	}

	option = {
		name = "food_policy_gestalt_rationing"

		policy_flags = { food_policy_gestalt_rationing } # Intel Expanded

		modifier = {
			planet_pops_organics_food_upkeep_mult = -0.25
			pop_growth_speed = -0.15
		}

		AI_weight = {
			factor = 0
		}
	}

	option = {
		name = "food_policy_gestalt_normal"

		policy_flags = { food_policy_gestalt_normal } # Intel Expanded

		modifier = {}

		AI_weight = {
			factor = 1
			modifier = { # Ariphaos
				factor = 0
				days_passed > 28
			}
		}
	}

	option = {
		name = "food_policy_gestalt_generous"

		policy_flags = { food_policy_gestalt_generous } # Intel Expanded

		modifier = {
			planet_pops_organics_food_upkeep_mult = 0.5
			pop_growth_speed = 0.33
		}

		AI_weight = {
			factor = 0
			modifier = { # Ariphaos
				add = 500
				days_passed > 28
			}
		}
	}
}

## Economic Policy
# Merge between Intel Expanded, OSA, Bug Branch, NGS, EMEX, StarTech, Ariphaos
economic_policy = {
	potential = {
		is_gestalt = no # Merged
	}

	option = {
		name = "economic_policy_civilian"

		modifier = {
			planet_jobs_consumer_goods_produces_mult = 0.25
			planet_artisans_upkeep_mult = 0.25 # OSA
			planet_jobs_alloys_produces_mult = -0.05 # OSA -0.25 -> -0.05
		}
		
		valid = {
			NOR = {
				has_valid_civic = civic_war_economy # EMEX
				has_valid_civic = civic_war_factories # EMEX
				has_valid_civic = "civic_bugged_war_council" # Bug Branch
			}
		}

		policy_flags = { economic_policy_civilian } # Intel Expanded

		AI_weight = {
			factor = 0.1 # StarTech 0 -> 0.1
			modifier = { # StarTech AI
				factor = 1000
				is_ai = yes
				years_passed > 25
				or = {
					has_ethic = ethic_pacifist
					has_ethic = ethic_fanatic_pacifist
				}
			}
			modifier = { # StarTech AI
				factor = 200
				is_ai = no
				turtler = yes
			}
		}
	}

	option = {
		name = "economic_policy_balanced"

		modifier = {}

		policy_flags = { economic_policy_balanced } # Intel Expanded

		AI_weight = {
			factor = 5 # StarTech 1 -> 5
			modifier = { # StarTech AI
				factor = 200
				years_passed > 20
				is_difficulty < 4
				resource_income_compare = {
					resource = society_research
					value > 150
				}
				is_megacorp = no
				NAND = {
					has_technology = tech_battleships
					has_technology = tech_energy_torpedoes_2
					has_technology = tech_mass_accelerator_1
				}
			}
			modifier = {
				factor = 10
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
			}
		}
	}

	option = {
		name = "economic_policy_military"

		in_breach_of = {
			{
				key = resolution_rulesofwar_demobilization_initiative
			}
			{ # NGS
				key = resolution_rulesofwar_6
			}
		}

		modifier = {
			planet_jobs_consumer_goods_produces_mult = -0.05 # OSA -0.25 -> -0.05
			planet_jobs_alloys_produces_mult = 0.25
			planet_metallurgists_upkeep_mult = 0.25 # OSA
		}

		valid = {
			NOR = {
				has_valid_civic = civic_peaceful_society # EMEX
				has_valid_civic = "civic_bugged_utopian_democracy" # Bug Branch
			}
		}
		
		policy_flags = {
			economic_policy_military
		}

		AI_weight = {
			factor = 2
			modifier = { # StarTech AI
				factor = 10
				resource_income_compare = {
					resource =physics_research
					value < 90
				}
				is_ai = yes
			}
			modifier = { # StarTech AI
				factor = 10
				is_ai = yes
				is_difficulty > 3
			}
			modifier = { # StarTech AI
				factor = 20
				is_ai = yes
				has_technology = tech_battleships
				has_technology = tech_energy_torpedoes_2
				has_technology = tech_mass_accelerator_1
			}
			modifier = { # StarTech AI
				factor = 30
				lategame = yes
				or = {
					and = {
						resource_income_compare = {
							resource = consumer_goods
							value > 50
						}
						not = { has_policy_flag = trade_conversion_consumer_goods }
					}
					has_policy_flag = economic_policy_military
				}
			}
			modifier = { # NGS
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
					is_active_resolution = "resolution_rulesofwar_6"
				}
			}
		}
	}
}

## Trade Policy
# Merge between Intel Expanded, OSA, Venture Politics, Bug Branch, UAP, Galactic Imperial Tax, EMEX, StarTech, Ariphaos
trade_policy = {
	potential = {
		is_gestalt = no # Ariphaos
	}

	option = {
		name = "trade_policy_default"

		potential = {
			NOT = {
				has_active_tradition = tr_commerce_finish # OSA
			}
			NAND = { # LS - Inverted condition for Bug Branch Wealth Marketplace, which is better.
				has_federation = yes
				federation = {
					has_federation_perk = trade_federation_passive
					NOR = {
						has_federation_perk = trade_value_2
						has_federation_perk = trade_value_3
					}
				}
			}
		}

		AI_weight = {
			factor = 1 # StarTech 0 -> 1
			modifier = { # StarTech AI
				factor = 10
				lategame = yes
				or = {
					resource_income_compare = {
						resource = consumer_goods
						value > 50
					}
					not = { has_policy_flag = trade_conversion_consumer_goods }
				}
			}
		}
		
		policy_flags = {
			trade_conversion_default # Venture Politics
			trade_policy_default # Venture Politics
		}
	}

	option = {
		name = "trade_policy_consumer_goods"
		potential = {
			NOT = {
				has_active_tradition = tr_commerce_finish # OSA
			}
			OR = {
				has_federation = no
				AND = {
					has_federation = yes
					federation = { NOT = { has_federation_perk = trade_federation_passive } }
				}
				AND = { # Galactic Imperial Tax
					is_galactic_community_member = yes
					is_active_resolution = resolution_emperor_eco_3
				}
			}
			has_tradition = tr_mercantile_adaptive_economic_policies
		}

		policy_flags = {
			trade_conversion_consumer_goods
		}

		modifier = {}

		AI_weight = {
			factor = 0.5 # StarTech 1.0 -> 0.5
			modifier = { # StarTech AI
				factor = 3
				or = {
					has_policy_flag = trade_conversion_consumer_goods
					and = {
						years_passed > 8
						resource_income_compare = {
							resource = energy
							value > 5
						}
						resource_stockpile_compare = {
							resource = energy
							value > 200
						}
					}
				}
			}
		}
	}

	option = {
		name = "trade_policy_unity"
		potential = {
			NOT = {
				has_active_tradition = tr_commerce_finish # OSA
			}
			OR = {
				has_federation = no
				AND = {
					has_federation = yes
					federation = {
						NOR = {
							has_federation_perk = trade_federation_passive
							has_federation_perk = unity_trade_1
						}
					}
				}
				AND = { # Galactic Imperial Tax
					is_galactic_community_member = yes
					is_active_resolution = resolution_emperor_eco_3
				}
			}
			has_tradition = tr_mercantile_adaptive_economic_policies
		}

		policy_flags = {
			trade_conversion_unity
		}

		modifier = {
		}

		AI_weight = {
			factor = 300 # StarTech 0 -> 300
			modifier = { # StarTech AI
				factor = 0
				is_ai = no
			}
			modifier = { # StarTech AI
 				factor = 0
				num_ascension_perks > 2
				or = {
					has_tradition = tr_supremacy_adopt
					has_tradition = tr_prosperity_administrative_operations
				}
			}
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_growth_construction"
		potential = {
			OR = {
				has_federation = no
				AND = {
					has_federation = yes
					federation = {
						NOT = {
							has_federation_perk = trade_federation_passive
						}
					}
				}
			}
			has_tradition = tr_mercantile_adaptive_economic_policies
		}

		policy_flags = {
			trade_conversion_bugged_growth_construction
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_innovative_economy"
		potential = {
			OR = {
				has_federation = no
				AND = {
					has_federation = yes
					federation = {
						NOT = {
							has_federation_perk = trade_federation_passive
						}
					}
				}
			}
			NOT = {
				has_valid_civic = civic_bugged_immutable_hierarchy
			}
		}

		policy_flags = {
			trade_conversion_bugged_innovative_economy
		}

		modifier = {	
		}

		valid = {
			has_technology = tech_bugged_innovations
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_social_development"
		potential = {
			OR = {
				has_federation = no
				AND = {
					has_federation = yes
					federation = {
						NOT = {
							has_federation_perk = trade_federation_passive
						}
					}
				}
			}
		}

		policy_flags = {
			trade_conversion_bugged_social_development
		}

		modifier = {
			pop_growth_speed = 0.05
			planet_amenities_mult = 0.15
		}

		valid = {
			has_technology = tech_bugged_social_development
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		#ALL
		name = "trade_policy_bugged_basic_league"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_federation_passive
				NOR = {
					has_federation_perk = trade_value_2
					has_federation_perk = trade_value_3
				}
			}
		}
		

		policy_flags = {
			trade_conversion_bugged_basic_league
		}

		modifier = {}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 1
		}
	}

	option = { # Bug Branch
		#FREE MARKET
		name = "trade_policy_bugged_consumer_goods_league"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_federation_passive
				NOR = {
					has_federation_perk = trade_value_2
					has_federation_perk = trade_value_3
				}
			}
		}

		policy_flags = {
			trade_conversion_bugged_consumer_goods_league
		}

		modifier = {}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_innovative_economy_league"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_federation_passive
				NOR = {
					has_federation_perk = trade_value_2
					has_federation_perk = trade_value_3
				}
			}
			NOT = {
				has_valid_civic = civic_bugged_immutable_hierarchy
			}
		}

		policy_flags = {
			trade_conversion_bugged_innovative_economy_league
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_social_development_league"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_federation_passive
				NOR = {
					has_federation_perk = trade_value_2
					has_federation_perk = trade_value_3
				}
			}
		}

		policy_flags = {
			trade_conversion_bugged_social_development_league
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_agriculture_league"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_federation_passive
				NOR = {
					has_federation_perk = trade_value_2
					has_federation_perk = trade_value_3
				}
			}
		}

		policy_flags = {
			trade_conversion_bugged_agriculture_league
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_mining_league"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_federation_passive
				NOR = {
					has_federation_perk = trade_value_2
					has_federation_perk = trade_value_3
				}
			}
		}

		policy_flags = {
			trade_conversion_bugged_mining_league
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}
	# Level 2 Trade League Policies
	option = { # Bug Branch
		#ALL
		name = "trade_policy_bugged_basic_league_level_2"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_value_2
				NOT = {
					has_federation_perk = trade_value_3
				}
			}
		}
		

		policy_flags = {
			trade_conversion_bugged_basic_league_level_2
		}

		modifier = {}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 1
		}
	}

	option = { # Bug Branch
		#FREE MARKET
		name = "trade_policy_bugged_consumer_goods_league_level_2"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_value_2
				NOT = {
					has_federation_perk = trade_value_3
				}
			}
		}

		policy_flags = {
			trade_conversion_bugged_consumer_goods_league_level_2
		}

		modifier = {}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_innovative_economy_league_level_2"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_value_2
				NOT = {
					has_federation_perk = trade_value_3
				}
			}
			NOT = {
				has_valid_civic = civic_bugged_immutable_hierarchy
			}
		}

		policy_flags = {
			trade_conversion_bugged_innovative_economy_league_level_2
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_social_development_league_level_2"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_value_2
				NOT = {
					has_federation_perk = trade_value_3
				}
			}
		}

		policy_flags = {
			trade_conversion_bugged_social_development_league_level_2
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_agriculture_league_level_2"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_value_2
				NOT = {
					has_federation_perk = trade_value_3
				}
			}
		}

		policy_flags = {
			trade_conversion_bugged_agriculture_league_level_2
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_mining_league_level_2"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_value_2
				NOT = {
					has_federation_perk = trade_value_3
				}
			}
		}

		policy_flags = {
			trade_conversion_bugged_mining_league_level_2
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}
	# Level 3 Trade League Policies
	option = { # Bug Branch
		#ALL
		name = "trade_policy_bugged_basic_league_level_3"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_value_3
			}
		}
		

		policy_flags = {
			trade_conversion_bugged_basic_league_level_3
		}

		modifier = {}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 1
		}
	}

	option = { # Bug Branch
		#FREE MARKET
		name = "trade_policy_bugged_consumer_goods_league_level_3"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_value_3
			}
		}

		policy_flags = {
			trade_conversion_bugged_consumer_goods_league_level_3
		}

		modifier = {}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_innovative_economy_league_level_3"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_value_3
			}
			NOT = {
				has_valid_civic = civic_bugged_immutable_hierarchy
			}
		}

		policy_flags = {
			trade_conversion_bugged_innovative_economy_league_level_3
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_social_development_league_level_3"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_value_3
			}
		}

		policy_flags = {
			trade_conversion_bugged_social_development_league_level_3
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_agriculture_league_level_3"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_value_3
			}
		}

		policy_flags = {
			trade_conversion_bugged_agriculture_league_level_3
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # Bug Branch
		name = "trade_policy_bugged_mining_league_level_3"
		potential = {
			has_federation = yes
			federation = {
				has_federation_perk = trade_value_3
			}
		}

		policy_flags = {
			trade_conversion_bugged_mining_league_level_3
		}

		modifier = {
		}

		valid = {
			always = yes
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # This policy is removed in Bug Branch, may need to revisit
		name = "trade_policy_trade_league"
		potential = {
			NOT = {
				has_active_tradition = tr_commerce_finish # OSA
			}
			OR = {
				AND = {
					has_federation = yes
					federation = { has_federation_perk = trade_federation_passive }
				}
				AND = { # Galactic Imperial Tax
					is_galactic_community_member = yes
					is_active_resolution = resolution_emperor_eco_4
				}
			}
		}

		policy_flags = {
			trade_conversion_trade_league
		}

		modifier = {
		}

		AI_weight = {
			factor = 10 # StarTech 1,000 -> 10
		}
	}
	
	option = { # Venture Politics
		name = "trade_policy_science"
		potential = {
			has_valid_civic = civic_science_syndicate
			OR = {
				has_federation = no
				AND = {
					has_federation = yes
					#federation = { NOT = { has_federation_perk = trade_federation_passive } }
				}
			}
		}

		policy_flags = {
			trade_conversion_science
		}

		modifier = {
		}

		AI_weight = {
			factor = 0
		}
	}

	option = {
		name = "trade_policy_holy_covenant"
		potential = {
			NOT = {
				has_active_tradition = tr_commerce_finish # OSA
			}
			has_federation = yes
			federation = { has_federation_perk = unity_trade_1 }
		}

		policy_flags = {
			trade_conversion_holy_covenant
		}

		modifier = {
		}

		AI_weight = {
			factor = 1000
		}
	}

	option = { # Galactic Imperial Tax
		name = "trade_policy_emperor"
		potential = {
			is_galactic_emperor = yes
			is_active_resolution = resolution_emperor_eco_5
		}

		policy_flags = {
			trade_conversion_emperor
		}

		modifier = {
		}

		AI_weight = {
			factor = 10000
		}
	}
	
	option = { # EMEX
		name = "trade_policy_technocorp"
		potential = {
			has_valid_civic = civic_technocorp
		}

		policy_flags = {
			trade_conversion_technocorp
		}

		modifier = {
		}

		AI_weight = {
			factor = 100
		}
	}
	option = { # EMEX
		name = "trade_policy_technocorp_tl"
		potential = {
			has_valid_civic = civic_technocorp
			has_federation = yes
			federation = { has_federation_perk = trade_federation_passive }
		}

		policy_flags = {
			trade_conversion_technocorp_tl
		}

		modifier = {
		}

		AI_weight = {
			factor = 1100
		}
	}
	option = { # UAP
		name = "trade_policy_adv_conversion_energy_name"
		policy_flags = { trade_policy_adv_conversion_energy }
		potential = {
			OR = {
				has_ascension_perk = ap_economic_prospertity
				AND = {
					mid_game_years_passed > 0
					is_trade_league_federation = no
				}
			}
		}
		modifier = {}
		AI_weight = { factor = 5 }
	}
	option = { # UAP
		name = "trade_policy_adv_conversion_minerals_name"
		policy_flags = { trade_policy_adv_conversion_minerals }
		potential = {
			OR = {
				has_ascension_perk = ap_economic_prospertity
				AND = {
					mid_game_years_passed > 0
					is_trade_league_federation = no
				}
			}
		}
		modifier = {}
		AI_weight = { factor = 0 }
	}
	option = { # UAP
		name = "trade_policy_adv_conversion_food_name"
		policy_flags = { trade_policy_adv_conversion_food }
		potential = {
			OR = {
				has_ascension_perk = ap_economic_prospertity
				AND = {
					mid_game_years_passed > 0
					is_trade_league_federation = no
				}
			}
		}
		modifier = {}
		AI_weight = { factor = 0 }
	}
	option = { # UAP
		name = "trade_policy_adv_conversion_consumer_goods_name"
		policy_flags = { trade_policy_adv_conversion_consumer_goods }
		potential = {
			OR = {
				has_ascension_perk = ap_economic_prospertity
				AND = {
					mid_game_years_passed > 0
					is_trade_league_federation = no
				}
			}
		}
		modifier = {}
		AI_weight = { factor = 0 }
	}
	# LS - Forge Investments option disabled [Balance]
	#option = { # UAP
	#	name = "trade_policy_adv_conversion_alloys_name"
	#	policy_flags = { trade_policy_adv_conversion_alloys }
	#	potential = {
	#		OR = {
	#			has_ascension_perk = ap_economic_prospertity
	#			AND = {
	#				mid_game_years_passed > 0
	#				is_trade_league_federation = no
	#			}
	#		}
	#	}
	#	modifier = {}
	#	AI_weight = { factor = 0 }
	#}
	option = { # UAP
		name = "trade_policy_adv_conversion_unity_name"
		policy_flags = { trade_policy_adv_conversion_unity }
		potential = {
			OR = {
				has_ascension_perk = ap_economic_prospertity
				AND = {
					mid_game_years_passed > 0
					is_trade_league_federation = no
				}
			}
		}
		modifier = {}
		AI_weight = { factor = 0 }
	}
	option = { # UAP
		name = "trade_policy_adv_conversion_research_name"
		policy_flags = { trade_policy_adv_conversion_research }
		potential = {
			OR = {
				has_ascension_perk = ap_economic_prospertity
				AND = {
					mid_game_years_passed > 0
					is_trade_league_federation = no
				}
			}
		}
		modifier = {}
		AI_weight = { factor = 0 }
	}
	option = { # UAP
		name = "trade_policy_adv_conversion_trade_league_name"
		potential = {
			mid_game_years_passed > 0
			OR = {
				has_ascension_perk = ap_economic_prospertity
				AND = {
					is_trade_league_federation = yes
					federation = { federation_level > 1 }
					OR = {
						is_federation_leader = yes
						federation = { federation_level > 3 }
					}
				}
			}
		}
		policy_flags = { trade_policy_adv_conversion_trade_league }
		modifier = {}
		AI_weight = { factor = 220 }
	}

	option = { # OSA
		name = "trade_policy_default_improved"
		potential = {
			has_active_tradition = tr_commerce_finish
		}
		AI_weight = {
			factor = 1
		}
	}

	option = { # OSA
		name = "trade_policy_consumer_goods_improved"
		potential = {
			AND = {
				has_active_tradition = tr_commerce_finish
				OR = {
					has_federation = no
					AND = {
						has_federation = yes
						federation = { NOT = { has_federation_perk = trade_federation_passive } }
					}
				}
			}
		}

		policy_flags = {
			trade_conversion_consumer_goods
		}

		modifier = {}

		AI_weight = {
			factor = 0
		}
	}

	option = { # OSA
		name = "trade_policy_unity_improved"
		potential = {
			AND = {
				has_active_tradition = tr_commerce_finish
				OR = {
					has_federation = no
					AND = {
						has_federation = yes
						federation = { NOT = { has_federation_perk = trade_federation_passive } }
					}
				}
			}
		}

		policy_flags = {
			trade_conversion_unity
		}

		modifier = {
		}

		AI_weight = {
			factor = 0
		}
	}

	option = { # OSA
		name = "trade_policy_trade_league_improved"
		potential = {
			AND = {
				has_active_tradition = tr_commerce_finish
				has_federation = yes
				federation = { has_federation_perk = trade_federation_passive }
			}
		}

		policy_flags = {
			trade_conversion_trade_league
		}

		modifier = {
		}

		AI_weight = {
			factor = 1000
		}
	}

	option = { # OSA
		name = "trade_policy_holy_covenant_improved"
		potential = {
			AND = {
				has_active_tradition = tr_commerce_finish
				has_federation = yes
				federation = { has_federation_perk = unity_trade_1 }
			}
		}

		policy_flags = {
			trade_conversion_holy_covenant
		}

		modifier = {
		}

		AI_weight = {
			factor = 1000
		}
	}
}

## Drone Policy
# Merge between Intel Expanded, OSA, Bug Branch, StarTech, Ariphaos
drone_policy = {
	potential = {
		is_gestalt = yes # Merged
	}

	option = {
		name = "drone_policy_balanced"

		modifier = {}

		policy_flags = {
			drone_policy_balanced # Intel Expanded
			ai_full_rights # Bug Branch
		}

		AI_weight = {
			factor = 0 # StarTech 1 -> 0
		}
	}

	option = {
		name = "drone_policy_worker"

		modifier = {
			planet_jobs_simple_drone_produces_mult = 0.2
			planet_jobs_complex_drone_produces_mult = -0.1 # OSA -0.2 -> -0.1
		}

		policy_flags = {
			drone_policy_worker # Intel Expanded
			ai_full_rights # Bug Branch
		}

		AI_weight = {
			factor = 10 # StarTech 0 -> 10
			modifier = { # StarTech AI
				factor = 0
				is_ai = yes
				years_passed > 5
				resource_income_compare = {
					resource = minerals
					value > 40
				}
			}
		}
	}

	option = {
		name = "drone_policy_thinker"

		modifier = {
			planet_jobs_simple_drone_produces_mult = -0.1 # OSA -0.2 -> -0.1
			planet_jobs_complex_drone_produces_mult = 0.2
		}

		policy_flags = {
			drone_policy_thinker # Intel Expanded
			ai_full_rights # Bug Branch
		}

		AI_weight = {
			factor = 5 # StarTech 0 -> 5
		}
	}
}

## AI Policy
# Merge between Organic Zealots, OSA, Bug Branch, NGS, EMEX, Ariphaos
artificial_intelligence_policy = {

	potential = {
		is_gestalt = no # Merged
		OR = {
			is_valid_organic_zealots = yes # Organic Zealots
			can_set_ai_policy = yes
			is_robot_empire = yes # Organic Zealots
			is_bugged_machine_cult = yes # Bug Branch
		}
	}

	option = {
		name = "ai_outlawed"

		valid = {
			if = { # Organic Zealots (best version)
				limit = { is_robot_empire = no }
				OR = {
					custom_tooltip = {
						fail_text = civic_tooltip_not_materialist
						is_materialist = no
					}
					custom_tooltip = {
						fail_text = lost_robot_policy_war
						has_country_flag = lost_robot_policy_war
					}
					custom_tooltip = {
						fail_text = civic_tooltip_not_organic_zealots
						is_valid_organic_zealots = yes
					}
					custom_tooltip = {
						fail_text = civic_tooltip_overlord_not_organic_zealots
						AND = {
							is_subject = yes
							overlord = { is_valid_organic_zealots = yes }
						}
					}
				}
			}
			custom_tooltip = {
				fail_text = is_a_synthetic_empire_fail
				is_robot_empire = no
			}
			NOR = {
				is_machine_cult_emex = yes # EMEX
				is_bugged_machine_cult = yes # Bug Branch
			}
		}

		policy_flags = {
			ai_outlawed
		}

		in_breach_of = {
			{
				key = resolution_galacticstudies_advanced_xenostudies
			}
			{ # NGS
				key = resolution_galacticstudies_6
			}
		}

		AI_weight = {
			modifier = {
				factor = 0
				OR = {
					has_ethic = "ethic_materialist"
					has_ethic = "ethic_fanatic_materialist"
					has_origin = origin_mechanists # EMEX
				}
			}
			modifier = { # Organic Zealots
				factor = 0
				OR = {
					is_robot_empire = yes
					AND = {
						is_materialist = yes
						NOT = { has_country_flag = lost_robot_policy_war }
					}
				}
			}
			modifier = { # Organic Zealots
				factor = 10
				is_robot_empire = no
				OR = {
					has_country_flag = lost_robot_policy_war
					is_valid_organic_zealots = yes
					AND = {
						is_subject = yes
						overlord = { is_valid_organic_zealots = yes }
					}
				}
			}
			modifier = { # EMEX
				factor = 0
				is_machine_or_nihil_cult_emex = yes
			}
			modifier = {
				factor = 5
				is_robot_empire = no
				is_spiritualist = yes
			}
			modifier = {
				factor = 0.1
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_galacticstudies_advanced_xenostudies"
					is_active_resolution = "resolution_galacticstudies_ethical_guideline_refactoring"
					is_active_resolution = "resolution_galacticstudies_extradimensional_experimentation"
					is_active_resolution = "resolution_galacticstudies_6" # NGS
				}
			}
		}
	}

	option = {
		name = "ai_servitude"

		valid = {
			if = { # Organic Zealots (Best Version)
				limit = { is_robot_empire = no }
				is_not_restricted_by_organic_zealots_fail = yes
			}
			custom_tooltip = {
				fail_text = is_a_synthetic_empire_fail
				is_robot_empire = no
			}
			NOR = { # EMEX
				is_machine_cult_emex = yes # EMEX
				is_bugged_machine_cult = yes # Bug Branch
			}	
		}

		in_breach_of = {
			{ # NGS
				key = resolution_divinity_crusade_against_the_heretic
			}
			{ # Bug Branch
				key = resolution_galacticstudies_advanced_xenostudies
			}
		}

		policy_flags = {
			ai_servitude
		}

		AI_weight = {
			modifier = { # NGS
				factor = 0.1
				is_galactic_community_member = yes
				is_active_resolution = "resolution_divinity_crusade_against_the_heretic"
			}
			modifier = {
				factor = 5
				has_valid_ai_personality = yes
				has_ai_personality_behaviour = robot_exploiter
			}
			modifier = {
				factor = 2
				has_valid_ai_personality = yes
				has_ai_personality_behaviour = robot_liberator
			}
			modifier = { # Bug Branch
				factor = 0
				OR = {
					has_ethic = "ethic_spiritualist"
					has_ethic = "ethic_fanatic_spiritualist"
				}
				not = {
					is_bugged_machine_cult = yes
				}
			}
			modifier = {
				factor = 0
				is_spiritualist = yes
				NOT = {
					has_valid_ai_personality = yes
					is_ai = yes
					is_galactic_community_member = yes
					OR = {
						is_active_resolution = "resolution_galacticstudies_advanced_xenostudies"
						is_active_resolution = "resolution_galacticstudies_ethical_guideline_refactoring"
						is_active_resolution = "resolution_galacticstudies_extradimensional_experimentation"
					}
				}
			}
			modifier = { # Organic Zealots
				factor = 0
				OR = {
					is_robot_empire = yes
					has_country_flag = lost_robot_policy_war
					is_valid_organic_zealots = yes
					AND = {
						is_subject = yes
						overlord = { is_valid_organic_zealots = yes }
					}
				}
			}
		}
	}

	option = {
		name = "ai_full_rights"

		valid = {
			if = {
				limit = { is_robot_empire = no }
				custom_tooltip = {
					fail_text = empire_is_spiritualist
					is_spiritualist = yes
				}
				OR = {
					AND = { # EMEX
						OR = {
							has_ethic = "ethic_spiritualist"
							has_ethic = "ethic_fanatic_spiritualist"
						}
						is_machine_or_nihil_cult_emex = yes
					}
					is_bugged_machine_cult = yes # Bug Branch
				}
				is_not_restricted_by_organic_zealots_fail = yes
				NOT = { has_policy_flag = robots_outlawed }
			}
		}

		policy_flags = {
			ai_full_rights
		}

		modifier = {}

		AI_weight = {
			modifier = { # EMEX
				factor = 5
				has_ascension_perk = ap_the_flesh_is_weak
			}
			modifier = {
				factor = 0.5
				is_materialist = no
				NOR = {
					is_synthetic_empire = yes
					has_technology = tech_synthetic_workers
				}
			}
			modifier = { # NGS
				factor = 5
				OR = {
					AND = {
						is_materialist = yes
						is_authoritarian = no
					}
					AND = {
						is_egalitarian = yes
						is_spiritualist = no
					}
				}

			}
			modifier = {
				factor = 5
				has_valid_ai_personality = yes
				has_ai_personality_behaviour = robot_liberator
			}
			modifier = {
				factor = 0
				AND = { # EMEX
					OR = {
						has_ethic = "ethic_spiritualist"
						has_ethic = "ethic_fanatic_spiritualist"
					}
					NOT = { is_machine_or_nihil_cult_emex = yes } # EMEX
				}
			}
			modifier = { # Organic Zealots
				factor = 0
				is_robot_empire = no
				OR = {
					has_country_flag = lost_robot_policy_war
					is_valid_organic_zealots = yes
					AND = {
						is_subject = yes
						overlord = { is_valid_organic_zealots = yes }
					}
				}
			}
		}
	}
	
	option = { # EMEX
		name = "ai_worshipped"

		valid = {
			is_machine_cult_emex = yes
			NOT = { has_policy_flag = robots_outlawed }
		}

		policy_flags = {
			ai_full_rights
			ai_worshipped
		}

		modifier = {
			planet_pop_assembly_mult = 0.10
			planet_pops_robotics_upkeep_mult = 0.05
		}

		AI_weight = {
			modifier = {
				factor = 10
				always = yes 
			}
		}
	}
}

## Robot Pop Policy
# Merge between Organic Zealots, OSA, Bug Branch, EMEX, StarTech, Ariphaos
robot_pop_policy = {

	potential = {
		is_gestalt = no # Merged
	}

	option = {
		name = "robot_pops_outlawed"

		valid = {
			if = { # Organic Zealots (Best Version)
				limit = { is_robot_empire = no }
				OR = {
					custom_tooltip = {
						text = civic_tooltip_not_materialist
						is_materialist = no
					}
					custom_tooltip = {
						text = lost_robot_policy_war
						has_country_flag = lost_robot_policy_war
					}
					custom_tooltip = {
						text = civic_tooltip_not_organic_zealots
						is_valid_organic_zealots = yes
					}
					custom_tooltip = {
						text = civic_tooltip_overlord_not_organic_zealots
						is_subject = yes
						overlord = { is_valid_organic_zealots = yes }
					}
				}
			}
			custom_tooltip = {
				fail_text = is_a_synthetic_empire_fail
				is_robot_empire = no
			}
			NOR = {
				is_machine_cult_emex = yes # EMEX
				is_bugged_machine_cult = yes # Bug Branch
			}
			NOT = { has_policy_flag = ai_full_rights }
		}

		policy_flags = {
			robots_outlawed
		}

		on_enabled = {
			hidden_effect = {
				every_owned_species = {
					limit = { is_robotic_species = yes }
					set_citizenship_type = {
						type = citizenship_purge
						country = root
					}
				}
			}
		}

		AI_weight = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					has_ethic = "ethic_materialist"
					has_ethic = "ethic_fanatic_materialist"
					has_origin = origin_mechanists # EMEX
				}
			}
			modifier = { # Organic Zealots
				factor = 0
				OR = {
					is_robot_empire = yes
					AND = {
						is_materialist = yes
						NOT = { has_country_flag = lost_robot_policy_war }
					}
				}
			}
			modifier = { # Organic Zealots
				factor = 10
				is_robot_empire = no
				OR = {
					is_valid_organic_zealots = yes
					has_country_flag = lost_robot_policy_war
				}
			}
			modifier = {
				factor = 10
				is_robot_empire = no # Organic Zealots
				has_valid_ai_personality = yes
				NOR = {
					has_ai_personality_behaviour = robot_exploiter
					has_ai_personality_behaviour = robot_liberator
				}
			}

			#modifier = { # StarTech removes this modifier
			#	factor = 10
			#	has_ethic = "ethic_fanatic_spiritualist"
			#}
		}
	}

	option = {
		name = "robot_pops_allowed"

		valid = {
			if = { # Organic Zealots
				limit = { is_robot_empire = no }
				is_not_restricted_by_organic_zealots_fail = yes
			}
		}

		policy_flags = {
			robots_allowed
		}

		AI_weight = {
			factor = 2
			modifier = { # Organic Zealots
				factor = 0
				OR = {
					is_valid_organic_zealots = yes
					AND = {
						has_country_flag = lost_robot_policy_war
						is_robot_empire = no
					}
					#has_ethic = "ethic_fanatic_spiritualist" # Matching StarTech removal
				}
			}
			#modifier = { # StarTech removes this modifier
			#	factor = 0
			#	has_ethic = "ethic_fanatic_spiritualist"
			#}
		}
	}
}

## Pre-Sapients
# Merge between OSA, EED, StarTech, Ariphaos, Scripted Trigger Undercoat
pre_sapients = {
	potential = {
		OR = {
			has_country_flag = found_presapients
			any_planet_within_border = {
				any_owned_pop = {
					is_sapient = no
				}
			}
		}
	}

	option = {
		name = "pre_sapients_protect"

		potential = {
			is_homicidal = no # STU
		}

		on_enabled = {
			hidden_effect = {
				set_country_flag = found_presapients
			}
		}

		policy_flags = {
			pre_sapients_protect
		}

		AI_weight = {
			factor = 2
			modifier = {
				factor = 0
				NOR = { # EED
					has_ai_personality_behaviour = multispecies
					is_civic_machine_servitor = yes # EED
					is_civic_environmentalist = yes # EED
					AND = { # EED
						is_open_gestalt = yes # EED
						has_technology = tech_alien_life_studies_gestalt # EED
					}
				}
			}
		}
	}

	option = {
		name = "pre_sapients_allow"

		potential = {
			is_homicidal = no # STU
		}

		on_enabled = {
			hidden_effect = {
				set_country_flag = found_presapients
			}
		}

		policy_flags = {
			pre_sapients_allow
		}

		AI_weight = {
			factor = 1
		}
	}

	option = {
		name = "pre_sapients_eat"

		potential = {
			host_has_dlc = "Utopia"
			is_synthetic_empire = no
			NOT = {
				has_valid_civic = civic_fanatic_purifiers
			}
		}

		on_enabled = {
			hidden_effect = {
				set_country_flag = found_presapients
			}
		}

		valid = {
			NOR = {
				has_ethic = "ethic_xenophile"
				has_ethic = "ethic_fanatic_xenophile"
			}
		}

		policy_flags = {
			pre_sapients_eat
		}
		
		in_breach_of = {
			{ # EED
				key = resolution_galacticcooperation_sanctity_of_life
			}
		}

		modifier = {}

		AI_weight = {
			factor = 10
			modifier = {
				factor = 0
				NOR = { # EED
					is_hive_empire = yes # Merged and inverted
					has_origin = origin_natural_hunters # EED
				}
				NOT = { is_open_gestalt = yes } # EED
				NOT = { is_civic_environmentalist = yes } # EED
			}
			modifier = { # EED
				factor = 0.1
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				is_active_resolution = "resolution_galacticcooperation_sanctity_of_life"
			}
		}
	}

	option = {
		name = "pre_sapients_purge"

		valid = {
			NOR = {
				has_ethic = "ethic_xenophile"
				has_ethic = "ethic_fanatic_xenophile"
			}
		}

		on_enabled = {
			hidden_effect = {
				set_country_flag = found_presapients
			}
		}

		policy_flags = {
			pre_sapients_purge
		}
		
		in_breach_of = {
			{ # EED
				key = resolution_galacticcooperation_sanctity_of_life
			}
		}

		modifier = {}

		AI_weight = {
			factor = 0.5 # StarTech 5 -> 0.5
			modifier = {
				factor = 0
				is_playable = yes # STU
				NOR = {
					has_ethic = "ethic_xenophobe"
					has_ethic = "ethic_fanatic_xenophobe"
					AND = {
						is_machine_empire = yes # STU
						NOR = {
							is_servitor_empire = yes # STU
							is_machine_assimilator = yes # STU
							is_open_gestalt = yes # EED
							is_civic_environmentalist = yes # EED
						}
					}
				}
			}
			modifier = { # EED
				factor = 0.1
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				is_active_resolution = "resolution_galacticcooperation_sanctity_of_life"
			}
		}
	}
}

## Debris
# Merge between OSA, StarTech, Ariphaos, Scripted Trigger Undercoat
debris = {
	potential = {
		has_encountered_other_species = yes
		OR = {
			is_default_or_fallen = yes # STU
		}
	}

	option = {
		name = "research_debris"

		potential = {
			is_scavenger = no
		}

		valid = {
			has_encountered_other_species = yes # StarTech AI
		}

		policy_flags = {
			research_debris
		}
	}
	option = {
		name = "scavenge_debris"

		potential = {
			is_scavenger = no
		}

		valid = {
			has_encountered_other_species = yes # StarTech AI
		}

		policy_flags = {
			scavenge_debris
		}
	}

	option = {
		name = "scavenge_and_research_debris"

		potential = {
			is_scavenger = yes
		}

		valid = {
			has_encountered_other_species = yes # Ariphaos
		}

		policy_flags = {
			scavenge_and_research_debris
		}
	}
}

## Refugees
# Merge between OSA, EED, NGS, Ariphaos, Scripted Trigger Undercoat
refugees = {
	potential = {
		has_encountered_other_species = yes
		is_playable = yes # STU
		OR = {
			is_gestalt = no # Merged
			is_servitor_empire = yes # STU
			has_origin = origin_extant_creators # EED
		}
	}

	option = {
		name = "refugees_not_allowed"

		valid = {
			NOR = {
				has_ethic = "ethic_xenophile"
				has_ethic = "ethic_fanatic_xenophile"
			}
		}

		policy_flags = {
			refugees_not_allowed
		}
		AI_weight = {
			factor = 2 # NGS
			modifier = { # NGS
				factor = 10
				is_xenophobe = yes
			}
		}
	}

	option = {

		in_breach_of = {
			{ # NGS
				key = resolution_closed_society
			}
			{ # EED
				key = resolution_galacticcooperation_pan_galactic_migration
			}
		}

		name = "refugees_only_citizens"

		potential = {
			is_gestalt = no # Merged
		}

		policy_flags = {
			refugees_only_citizens
		}

		valid = {
			NOT = {
				is_hive_empire = yes # Merged
			}
		}

		AI_weight = {
			factor = 5
			modifier = { # NGS
				factor = 0.1
				is_galactic_community_member = yes
				is_active_resolution = "resolution_closed_society"
			}
			modifier = { # NGS
				factor = 0.5
				is_xenophile = yes
			}
			modifier = { # NGS
				factor = 3
				is_authoritarian = yes
				is_xenophobe = no
				is_xenophile = no
			}
			modifier = { # EED
				factor = 10
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_galacticcooperation_pan_galactic_migration"
					is_active_resolution = "resolution_galacticcooperation_indigenous_protection_protocols"
					is_active_resolution = "resolution_galacticcooperation_interstellar_mediation"
					is_active_resolution = "resolution_galacticcooperation_sanctity_of_life"
				}
			}
		}
	}

	option = {
		name = "refugees_allowed"

		in_breach_of = {
			{ # NGS
				key = resolution_homogenous_state
			}

			{ # NGS
				key = resolution_justified_suspicion
			}

			{ # NGS
				key = resolution_national_purity
			}

			{ # NGS
				key = resolution_cooperation_discouraged
			}

			{ # NGS
				key = resolution_closed_society
			}
		}

		policy_flags = {
			refugees_allowed
		}

		valid = {
			NOR = {
				has_ethic = "ethic_xenophobe"
				has_ethic = "ethic_fanatic_xenophobe"
			}
		}

		AI_weight = {
			factor = 10
			modifier = {
				factor = 0
				NOR = {
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
					is_servitor_empire = yes # STU
					AND = {
						has_valid_ai_personality = yes
						NOT = { has_ai_personality_behaviour = multispecies }
					}
				}
			}
			modifier = { # NGS
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_homogenous_state"
					is_active_resolution = "resolution_justified_suspicion"
					is_active_resolution = "resolution_national_purity"
					is_active_resolution = "resolution_cooperation_discouraged"
					is_active_resolution = "resolution_closed_society"
				}
			}
			modifier = { # EED
				factor = 10
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_galacticcooperation_pan_galactic_migration"
					is_active_resolution = "resolution_galacticcooperation_indigenous_protection_protocols"
					is_active_resolution = "resolution_galacticcooperation_interstellar_mediation"
					is_active_resolution = "resolution_galacticcooperation_sanctity_of_life"
				}
			}
		}
	}
}

## Population Controls
# Merge between OSA, Bug Branch, EED, StarTech, Scripted Trigger Undercoat
population_controls = {
	potential = {
		is_gestalt = no # Merged
	}

	option = {
		name = "population_controls_not_allowed"

		on_enabled = {
			hidden_effect = { every_owned_planet = { remove_modifier = planet_population_control } }
		}

		policy_flags = {
			population_controls_not_allowed
		}
		
		in_breach_of = {
			{ # EED
				key = resolution_lawandorder_informed_governance
			}
		}
	}

	option = {
		name = "population_controls_allowed"

		on_enabled = {
			hidden_effect = { every_owned_planet = { remove_modifier = planet_growth_discouraged } }
		}

		valid = {
			NOR = { # Bug Branch
				is_bugged_spirit_of_freedom = yes # Bug Branch
				has_valid_civic = civic_bugged_theocratic_republic # Bug Branch
			}
		}

		policy_flags = {
			population_controls_allowed
		}
		modifier = {}

		AI_weight = {
			factor = 0.5 # StarTech 10 -> 0.5
			modifier = {
				factor = 0
				OR = {
					has_ethic = ethic_egalitarian
					has_ethic = ethic_fanatic_egalitarian
					has_ethic = ethic_xenophile
					has_ethic = ethic_fanatic_xenophile
				}
				NAND = { # EED
					is_galactic_community_member = yes
					is_active_resolution = "resolution_lawandorder_informed_governance"
				}
			}
			modifier = { # StarTech AI
				add = 1000
				years_passed > 100
			}
		}
	}
}

## Slavery
# Merge between Bug Branch, NGS, Scripted Trigger Undercoat
slavery = {
	potential = {
		is_gestalt = no # Merged
	}

	option = {
		name = "slavery_not_allowed"

		valid = {
			NOR = {
				has_valid_civic = civic_slaver_guilds
				has_valid_civic = civic_bugged_caste_system # Bug Branch
				has_valid_civic = civic_indentured_assets
				has_valid_civic = civic_bugged_organs_corpo # Bug Branch
				is_bugged_slaving_despots = yes # Bug Branch
			}
		}

		policy_flags = {
			slavery_not_allowed
		}

		on_enabled = {
			hidden_effect = { every_owned_planet = { remove_modifier = slave_colony } }
		}

		modifier = {
			slave_market_cost_mult = 1
		}
	}

	option = {
		name = "slavery_allowed"

		valid = {
			custom_tooltip = {
				success_text = is_not_a_signatory_vassal_success
				fail_text = is_not_a_signatory_vassal_fail
				NOT = { any_agreement = { agreement_preset = preset_signatory } }
			}
			#custom_tooltip = { # Bug Branch removes this check
			#	fail_text = is_broken_shackles_origin
			#	NOT = { has_origin = origin_broken_shackles }
			#}
			OR = {
				has_ethic = ethic_elitist # Bug Branch
				has_ethic = ethic_fanatic_elitist # Bug Branch
				has_ethic = ethic_xenophobe
				has_ethic = ethic_fanatic_xenophobe
				has_valid_civic = civic_slaver_guilds # Bug Branch
				has_valid_civic = civic_bugged_caste_system # Bug Branch
				has_valid_civic = civic_bugged_organs_corpo # Bug Branch
				is_bugged_slaving_despots = yes # Bug Branch
			}
		}

		policy_flags = {
			slavery_allowed
		}
		modifier = {}

		AI_weight = {
			factor = 10
			modifier = {
				factor = 0
				has_valid_ai_personality = yes
				NOT = { has_ai_personality_behaviour = slaver }
			}
			modifier = {
				factor = 0
				has_valid_ai_personality = no
				NOR = {
					has_ethic = ethic_elitist # Bug Branch
					has_ethic = ethic_fanatic_elitist # Bug Branch
					has_ethic = ethic_xenophobe
					has_ethic = ethic_fanatic_xenophobe
				}
			}
			# special case for harmonious collectives
			modifier = {
				factor = 0
				has_valid_ai_personality = no
				is_ai = yes
				NOR = {
					has_ethic = "ethic_xenophobe"
					has_ethic = "ethic_fanatic_xenophobe"
					has_ethic = "ethic_militarist"
					has_ethic = "ethic_fanatic_militarist"
				}
				OR = {
					has_ethic = "ethic_pacifist"
					has_ethic = "ethic_fanatic_pacifist"
					has_ethic = "ethic_xenophile"
					has_ethic = "ethic_fanatic_xenophile"
				}
				OR = {
					has_ethic = "ethic_authoritarian"
					has_ethic = "ethic_fanatic_authoritarian"
				}
				NOR = {
					has_valid_civic = "civic_slaver_guilds"
					has_trait = "trait_decadent"
				}
			}
		}
	}
}

## Purge
# Merge between Organic Zealots, OSA, NGS, Expanded Gestalts, StarTech, Ariphaos, Scripted Trigger Undercoat
purge = {
	option = {
		name = "purge_not_allowed"

		valid = {
			is_gestalt = no # Merged
			is_homicidal = no # STU
		}

		policy_flags = {
			purge_not_allowed
		}
		AI_weight = {
			factor = 1 # StarTech AI
		}
	}

	option = {

		in_breach_of = {
			{ # NGS
				key = resolution_prime_directive
			}
			{ # NGS
				key = resolution_galactic_cooperation_initiative
			}
		}

		name = "purge_displacement_only"

		policy_flags = {
			purge_displacement_only
		}

		modifier = {}

		valid = {
			is_xenophile = no # Merged
			is_homicidal = no
		}

		AI_weight = {
			factor = 5
			modifier = {
				factor = 0
				has_valid_ai_personality = yes
				has_ai_personality_behaviour = multispecies
			}
			modifier = { # NGS
				factor = 0.1
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = resolution_prime_directive
					is_active_resolution = resolution_galactic_cooperation_initiative
				}
			}
		}
	}

	option = {
		name = "purge_allowed"

		in_breach_of = {
			{
				key = resolution_rulesofwar_reverence_for_life
			}
			{ # NGS
				key = resolution_rulesofwar_independent_tribunals
			}
			{ # NGS
				key = resolution_rulesofwar_last_resort_doctrine
			}
			{ # NGS
				key = resolution_rulesofwar_demobilization_initiative
			}
			{ # NGS
				key = resolution_charter_of_sentient_rights
			}
			{ # NGS
				key = resolution_stellar_diplomatic_forums
			}
			{ # NGS
				key = resolution_prime_directive
			}
			{ # NGS
				key = resolution_galactic_cooperation_initiative
			}
		}

		policy_flags = {
			purge_allowed
		}
		modifier = {}

		valid = {
			custom_tooltip = {
				success_text = is_not_a_signatory_vassal_success
				fail_text = is_not_a_signatory_vassal_fail
				NOT = { any_agreement = { agreement_preset = preset_signatory } }
			}
			custom_tooltip = {
				fail_text = is_broken_shackles_origin
				NOT = { has_origin = origin_broken_shackles }
			}
			OR = {
				is_gestalt = yes # Merged
				is_xenophobe = yes # Merged
				is_homicidal = yes # Organic Zealots
				NOT = {  has_valid_civic = civic_mutualistic_behavior } # Expanded Gestalts
				has_menace_perk = menp_undertaker	# Unlocked with Crisis Level 1
			}
		}

		AI_weight = {
			factor = 10
			modifier = {
				factor = 40
				is_gestalt = yes # Merged
				NOT = { has_valid_civic = civic_hive_empath }
			}
			modifier = { # StarTech AI
				factor = 0
				is_homicidal = no
			}
			modifier = {
				factor = 0
				is_pacifist = yes # Merged
			}
			modifier = {
				factor = 0
				has_valid_ai_personality = yes
				NOR = {
					has_ai_personality_behaviour = purger
					is_gestalt = yes # Merged
					AND = {
						is_necrophage_empire = yes # STU
						is_xenophobe = yes
					}
				}
			}
			modifier = {
				factor = 0.1
				has_valid_ai_personality = yes
				is_ai = yes
				is_galactic_community_member = yes
				OR = {
					is_active_resolution = "resolution_rulesofwar_reverence_for_life"
					is_active_resolution = "resolution_rulesofwar_independent_tribunals"
					is_active_resolution = "resolution_rulesofwar_last_resort_doctrine"
					is_active_resolution = "resolution_rulesofwar_demobilization_initiative"
					is_active_resolution = "resolution_charter_of_sentient_rights" # NGS
					is_active_resolution = "resolution_stellar_diplomatic_forums" # NGS
					is_active_resolution = "resolution_prime_directive" # NGS
					is_active_resolution = "resolution_galactic_cooperation_initiative" # NGS
				}
			}
			modifier = {
				factor = 10
				has_ascension_perk = ap_become_the_crisis
			}
			modifier = {
				factor = 1000
				is_necrophage_empire = yes # STU
				is_xenophobe = yes
			}
		}
	}
}

## Knightly Duties
# Merge between OSA, Daemonic Incursion, StarTech, Scripted Trigger Undercoat
knightly_duties = {
	potential = {
		is_playable = yes # STU
		OR = { # Daemonic Incursion
			has_origin = origin_toxic_knights
			has_country_flag = decision_toxic_knights
		}
		NOT = { has_country_flag = quest_abandoned }
	}

	option = {
		name = "questing_knights"

		policy_flags = {
			toxic_knights_questing
		}

		modifier = {
			science_ship_survey_speed = 0.25 # OSA 0.15 -> 0.25
			ship_anomaly_generation_chance_mult = 0.05
		}

		AI_weight = {
			factor = 5 #This should make sure AIs stick to this policy
		}
	}

	option = {
		name = "military_knights"

		policy_flags = {
			toxic_knights_military
		}

		modifier = {
			ship_home_territory_fire_rate_mult = 0.2
			ship_fire_rate_mult = 0.10
			army_damage_mult = 0.10
		}
	}

	option = {
		name = "diplomats_knights"

		policy_flags = {
			toxic_knights_diplomats
		}

		modifier = {
			diplo_weight_mult = 0.10 # OSA 0.05 -> 0.10
			envoys_add = 2 # OSA 1 -> 2
		}
	}

	option = {
		name = "herald_knights"

		potential = {
			owner = { has_country_flag = toxoids_7090_a }
		}

		policy_flags = {
			toxic_knights_herald
		}

		modifier = {
			edicts_cost_mult = -0.15
			edicts_upkeep_mult = -0.15
		}
	}
}
