##########################################################################
# Limitless Stellaris - Technology
##########################################################################

@EarlyRepeatableTechCost = 12000
@EarlyRepeatableTechLevelCost = 6000
@EarlyRepatableTechFactor = 0.65
@RepeatableCategoryFactor = 0.25
@RepeatableDifferntFactor = 0.5
@EarlyRepeatableWeight = 13
@EarlyRepeatableTier = 3
@SpecializationPenalty = 0.6
@SpecializationLevel = 0.75

@synergistic_weapon_ai_tech_factor = 1.25

##################################################
## A Deadly Tempest
##################################################

## Nanite Armor [A Deadly Tempest]
# Merge between L-Cluster Plus, EMT, ADT
tech_nanite_armor = {
	cost = @tier4cost3
	area = engineering
	tier = 4
	category = { materials }
	ai_update_type = all # EMT
	weight = @tier4weight3
	is_rare = yes
	prerequisites = { "tech_ship_armor_5" }

	potential = { has_distar = yes }

	weight_modifier = {
		factor = 0.50
		modifier = {
			factor = 0
			# NOT = { any_planet_within_border = { has_resource = { type = nanites amount > 0 } } }
			has_monthly_income = { resource = nanites value < 1 }
			resource_stockpile_compare = { resource = nanites value < 300 }
		}
		modifier = { factor = @ap_technological_ascendancy_rare_tech has_ascension_perk = ap_technological_ascendancy }
		modifier = {
			factor = 1.25
			has_trait_in_council = { TRAIT = leader_trait_expertise_materials }
		}
		modifier = { # EMT
			factor = 0
			NOR = {
				has_technology = tech_nanite_transmutation
				has_technology = tech_nanite_plant
			}
		}
		modifier = { # EMT
			factor = @federation_perk_factor
			has_federation = yes
			federation = {
				has_federation_perk = rare_tech_boost
				any_member = { has_technology = tech_nanite_armor }
			}
		}
	}

	ai_weight = {
		factor = 5
		modifier = {
			factor = 1.25
			has_trait_in_council = { TRAIT = leader_trait_expertise_materials }
		}
	}
}

## Nanite Mega-Construction [A Deadly Tempest]
# ADT version to overwrite L-Cluster Plus version
tech_nanite_mega_construction = {
	area = engineering
	cost = @tier5cost1
	tier = 5
	is_rare = yes

	category = { voidcraft }
	prerequisites = { "tech_mega_engineering" "tech_nanite_living_metal" }
	weight = @tier5weight2

	potential = {
		has_distar = yes
		has_global_flag = l_cluster_opened
		OR = {
			NOT = { has_global_flag = distar_overhaul_mod_active }
			has_country_flag = completed_nanite_technology_mastery_chain
		}
		has_country_resource = { type = nanites amount > 0 }
	}

	prereqfor_desc = {
		# custom = {
		# 	title = TECH_UNLOCK_L_GATE_TITLE
		# 	desc = TECH_UNLOCK_L_GATE_DESC
		# }
		custom = {
			title = TECH_UNLOCK_NANITE_ARMY_TITLE
			desc = TECH_UNLOCK_NANITE_ARMY_DESC
		}
	}

	modifier = {
		megastructure_build_speed_mult = 0.25
		starbase_building_build_speed_mult = 0.1
		starbase_module_build_speed_mult = 0.1
		shipsize_starbase_gatebuilders_build_speed_mult = 0.1
		shipsize_military_station_nanite_bulwark_build_speed_mult = 0.1
		shipsize_scavenger_bot_build_speed_mult = 0.1
		shipsize_dreadnought_build_speed_mult = 0.1
		shipsize_graygoo_mothership_build_speed_mult = 0.1
		shipsize_graygoo_interdictor_build_speed_mult = 0.1
	}

	weight_modifier = {
		factor = 0.50
		modifier = {
			factor = 0
			no_resource_for_component = { RESOURCE = nanites }
			# has_monthly_income = { resource = nanites value < 1 } # NOT = { any_planet_within_border = { has_resource = { type = nanites amount > 0 } } }
			# resource_stockpile_compare = { resource = nanites value < 200 }
		}
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = {
			factor = 1.25
			has_trait_in_council = { TRAIT = leader_trait_expertise_voidcraft }
		}
	}
	ai_weight = {
		factor = 5
		modifier = {
			factor = 1.25
			has_trait_in_council = { TRAIT = leader_trait_expertise_voidcraft }
		}
	}
}

## Nanite Terraforming [A Deadly Tempest]
# ADT version to overwrite L-Cluster Plus version
tech_nanite_terraforming = {
	cost = @tier4cost1
	area = society
	tier = 4
	category = { new_worlds }
	weight = @tier4weight1
	is_rare = yes
	prerequisites = { "tech_climate_restoration" }
	# Unlocks additional terraforming-options
	prereqfor_desc = {
		diplo_action = {
			title = "TECH_UNLOCK_NANITE_TERRAFORMING_TITLE"
			desc = "TECH_UNLOCK_NANITE_TERRAFORMING_DESC"
		}
	}
	potential = {
		no_scope = {
			has_distar = yes
			has_global_flag = l_cluster_opened
		}
		has_country_resource = { type = nanites amount > 0 }
		OR = {
			NOT = { has_global_flag = distar_overhaul_mod_active }
			has_country_flag = completed_nanite_technology_mastery_chain
		}
	}
	weight_modifier = {
		factor = 0.5
		modifier = {
			factor = 0
			# NOT = { any_planet_within_border = { has_resource = { type = nanites amount > 0 } } }
			has_monthly_income = { resource = nanites value < 1 }
			resource_stockpile_compare = { resource = nanites value < 300 }
		}
		modifier = { factor = @ap_technological_ascendancy_rare_tech has_ascension_perk = ap_technological_ascendancy }
		modifier = {
			factor = 1.25
			has_trait_in_council = { TRAIT = leader_trait_expertise_new_worlds }
		}
	}
	ai_weight = {
		factor = 5
		modifier = {
			factor = 1.25
			has_trait_in_council = { TRAIT = leader_trait_expertise_new_worlds }
		}
	}
	modifier = { terraform_speed_mult = 0.3 }
}

##################################################
## Acquisition of Technology
##################################################

## Affluence Center [Acquisition of Technology]
# AOT version to overwrite ZOFE version
tech_fe_affluence_center = {
	cost = @acot_tier6cost2
	area = engineering
	tier = 6
	category = {
		materials
	}
	prerequisites = {
		"tech_dm_production_core"
	}
	weight = @tier4weight1
	potential = {
		has_technology = tech_dm_production_core
		OR = {
			is_gestalt = no
			has_valid_civic = civic_machine_servitor
		}
	}
	weight_modifier = {
		modifier = {
			factor = 0
			NOT = {
				has_technology = tech_dm_production_core
			}
		}
		modifier = {
			factor = 1.25
			research_leader = {
				area = engineering
				has_trait = "leader_trait_expertise_materials"
			}
		}
	}
	ai_weight = {
		factor = 30
		modifier = {
			factor = 1.25
			research_leader = {
				area = engineering
				has_trait = "leader_trait_expertise_materials"
			}
		}
	}
}

## Class 4 Singularity [Acquisition of Technology]
# AOT version to overwrite ZOFE version
tech_fe_class_4_singularity = {
	cost = @acot_tier6cost2
	area = physics
	tier = 6
	category = {
		field_manipulation
	}
	prerequisites = {
		tech_dm_production_core
	}
	weight = @tier3weight1
	potential = {
		has_technology = tech_dm_production_core
	}
	weight_modifier = {
		modifier = {
			factor = 0
			NOT = {
				has_technology = tech_dm_production_core
			}
		}
		modifier = {
			factor = 10
			OR = {
				has_technology = tech_mine_exotic_gases
				has_technology = tech_exotic_gases
			}
		}
		modifier = {
			factor = 2
			has_tradition = tr_prosperity_adopt
		}
		modifier = {
			factor = 1.25
			research_leader = {
				area = physics
				has_trait = "leader_trait_expertise_field_manipulation"
			}
		}
	}
	ai_weight = {
		factor = 30
		modifier = {
			factor = 1.25
			research_leader = {
				area = physics
				has_trait = "leader_trait_expertise_field_manipulation"
			}
		}
	}
}

## Dimensional Fabricator [Acquisition of Technology]
# AOT version to overwrite ZOFE version
tech_fe_dimensional_fabricator = {
	cost = @acot_tier6cost2
	area = engineering
	tier = 6
	category = {
		industry
	}
	prerequisites = {
		"tech_dm_production_core"
	}
	weight = @tier3weight1
	potential = {
		has_technology = tech_dm_production_core
	}
	weight_modifier = {
		modifier = {
			factor = 0
			NOT = {
				has_technology = tech_dm_production_core
			}
		}
		factor = 2
		modifier = {
			factor = 1.25
			research_leader = {
				area = engineering
				has_trait = "leader_trait_expertise_industry"
			}
		}
	}
	ai_weight = {
		factor = 30
		modifier = {
			factor = 1.25
			research_leader = {
				area = engineering
				has_trait = "leader_trait_expertise_industry"
			}
		}
	}
}

## Master Archive [Acquisition of Technology]
# AOT version to overwrite ZOFE version
tech_fe_master_archive = {
	cost = @acot_tier6cost2
	area = physics
	tier = 6
	category = {
		computing
	}
	prerequisites = {
		"tech_dm_production_core"
	}
	weight = @tier4weight1
	potential = {
		has_technology = tech_dm_production_core
	}
	weight_modifier = {
		modifier = {
			factor = 0
			NOT = {
				has_technology = tech_dm_production_core
			}
		}
		factor = 2
		modifier = {
			factor = 1.25
			research_leader = {
				area = physics
				has_trait = "leader_trait_expertise_computing"
			}
		}
	}
	ai_weight = {
		factor = 30
		modifier = {
			factor = 1.25
			research_leader = {
				area = physics
				has_trait = "leader_trait_expertise_computing"
			}
		}
	}
}

## Nano-Forge [Acquisition of Technology]
# AOT version to overwrite ZOFE version
tech_fe_nano_forge = {
	cost = @acot_tier6cost2
	area = engineering
	tier = 6
	category = {
		materials
	}
	prerequisites = {
		"tech_dm_production_core"
	}
	weight = @tier4weight1
	potential = {
		has_technology = tech_dm_production_core
	}
	weight_modifier = {
		modifier = {
			factor = 0
			NOT = {
				has_technology = tech_dm_production_core
			}
		}
		factor = 2
		modifier = {
			factor = 1.25
			research_leader = {
				area = engineering
				has_trait = "leader_trait_expertise_materials"
			}
		}
	}
	ai_weight = {
		factor = 30
		modifier = {
			factor = 1.25
			research_leader = {
				area = engineering
				has_trait = "leader_trait_expertise_materials"
			}
		}
	}
}

## Nourishment Center [Acquisition of Technology]
# AOT version to overwrite ZOFE version
tech_fe_nourishment_center = {
	cost = @acot_tier6cost2
	area = society
	tier = 6
	category = {
		biology
	}
	prerequisites = {
		"tech_dm_production_core"
	}
	weight = @tier3weight1
	potential = {
		has_technology = tech_dm_production_core
		OR = {
			is_machine_empire = no
			has_valid_civic = civic_machine_servitor
		}
	}
	weight_modifier = {
		modifier = {
			factor = 0
			NOT = {
				has_technology = tech_dm_production_core
			}
		}
		factor = 2
		modifier = {
			factor = 0.01
			is_machine_empire = yes
			NOR = {
				has_valid_civic = civic_machine_servitor
				has_valid_civic = civic_machine_assimilator
				any_owned_planet = {
					num_districts = {
						type = district_farming
						value > 0
					}
				}
			}
		}
		modifier = {
			factor = 1.25
			research_leader = {
				area = society
				has_trait = "leader_trait_expertise_biology"
			}
		}
	}
	ai_weight = {
		factor = 30
		modifier = {
			factor = 1.25
			research_leader = {
				area = society
				has_trait = "leader_trait_expertise_biology"
			}
		}
	}
}

## Sky Dome [Acquisition of Technology]
# AOT version to overwrite ZOFE version
tech_fe_sky_dome = {
	cost = @acot_tier6cost2
	area = society
	tier = 6
	category = {
		statecraft
	}
	prerequisites = {
		"tech_dm_production_core"
	}
	weight = @tier1weight1
	potential = {
		has_technology = tech_dm_production_core
		is_gestalt = no
	}
	weight_modifier = {
		modifier = {
			factor = 0
			NOT = {
				has_technology = tech_dm_production_core
			}
		}
		modifier = {
			factor = 10
			OR = {
				has_technology = tech_mine_rare_crystals
				has_technology = tech_rare_crystals
			}
		}
		modifier = {
			factor = 1.25
			research_leader = {
				area = society
				has_trait = "leader_trait_expertise_statecraft"
			}
		}
	}
	ai_weight = {
		factor = 20
		modifier = {
			factor = 1.25
			research_leader = {
				area = society
				has_trait = "leader_trait_expertise_statecraft"
			}
		}
	}
}

##################################################
## Ancient Cache of Technologies
##################################################

## Dark Matter Generation [Ancient Cache of Technologies]
# ACOT version, with some modifiers adjusted. Added to prevent EMT from overwriting.
tech_dark_matter_generation = {
	cost = 90000
	area = physics
	tier = 5
	category = { particles }
	ai_update_type = all
	weight = 20
	is_rare = yes

	modifier = {
		country_energy_produces_mult = 0.05
	}

	prerequisites = { 
		tech_mine_dark_matter
	 }
	
	prereqfor_desc = {
		custom = {
			title = "TECH_UNLOCK_DARK_MATTER_GENERATION_TITLE"
			desc = "TECH_UNLOCK_DARK_MATTER_GENERATION_DESC"
		}
	}

	weight_modifier = {
		modifier = {
			factor = 0
			NOT = { has_country_flag = learned_dark_rumor }
		}
		modifier = {
            factor = 0
            NOT = {
                any_owned_leader = {
                    is_councilor = yes
                    leader_class = scientist
                    has_level > 5         
                }
            }
        }
		# LS - Remove all modifiers unrelated to blocking the tech
		#modifier = {
        #    factor = 0.25
        #    NOT = {
        #        any_owned_leader = {
        #            is_councilor = yes
        #            leader_class = scientist
		#			# LS - Remove trait requirements
		#			#OR = {
		#			#	has_trait = leader_trait_curator
		#			#	has_trait = leader_trait_sapient_AI_assistant
		#			#	has_trait = leader_trait_brainslug
		#			#	has_trait = leader_trait_cyborg
		#			#	has_trait = leader_trait_synthetic
		#			#	has_trait = leader_trait_erudite
		#			#	has_trait = leader_trait_psionic
		#			#	has_trait = leader_trait_chosen
		#			#	has_trait_tier1or2or3 = { TRAIT = leader_trait_expertise_particles } 
		#			#	has_trait_tier1or2or3 = { TRAIT = leader_trait_maniacal } 	
		#			#	has_trait_tier1or2 = { TRAIT = leader_trait_spark_of_genius } 	
		#			#}
		#			has_level >= 5
		#			has_level < 7      
        #        }
        #    }
        #}
		#modifier = {
        #    factor = 1
        #    NOT = {
        #        any_owned_leader = {
        #            is_councilor = yes
        #            leader_class = scientist
		#			# LS - Remove trait requirements
		#			#OR = {
		#			#	has_trait = leader_trait_curator
		#			#	has_trait = leader_trait_sapient_AI_assistant
		#			#	has_trait = leader_trait_brainslug
		#			#	has_trait = leader_trait_cyborg
		#			#	has_trait = leader_trait_synthetic
		#			#	has_trait = leader_trait_erudite
		#			#	has_trait = leader_trait_psionic
		#			#	has_trait = leader_trait_chosen
		#			#	has_trait_tier1or2or3 = { TRAIT = leader_trait_expertise_particles } 
		#			#	has_trait_tier1or2or3 = { TRAIT = leader_trait_maniacal } 	
		#			#	has_trait_tier1or2 = { TRAIT = leader_trait_spark_of_genius } 	
		#			#}
		#			has_level >= 7   
        #        }
        #    }
        #}				
	}
	
	ai_weight = {
		factor = 100.0 #important component
	}
}

##################################################
## Ancient Cache of Technologies
##################################################

## Battlecruiser Build Speed [Dawn of Ascension]
# DOA version to prevent NSC overwrite.
tech_battlecruiser_build_speed = {
	area = engineering
   cost = @fallentechcost
   tier = @fallentechtier
   category = { voidcraft }
   prerequisites = { "tech_ascended_battlecruiser" }
   weight = @tier4weight1

   modifier = {
	   custom_tooltip = tech_battlecruiser_build_speed_effect
	   shipsize_febattlecruiser_build_speed_mult = 0.25
   }

   weight_modifier = {
	   modifier = {
		   factor = value:tech_weight_likelihood
		   research_leader = {
			   area = engineering
			   has_trait = "leader_trait_expertise_voidcraft"
		   }
	   }
	   modifier = {
		   factor = 1.5
		   has_valid_civic = civic_eager_explorers
	   }
   }

   ai_weight = {
	   modifier = {
		   factor = 1.25
		   research_leader = {
			   area = engineering
			   has_trait = "leader_trait_expertise_voidcraft"
		   }
	   }
   }
}

##################################################
## Ecology
##################################################

## Waste Worker Production (Repeatable) [Ecology]
# Changed from infinite repeatable to only having 1 level.
tech_repeatable_waste_worker_production = {
	area = society
	cost = @EarlyRepeatableTechCost
	cost_per_level = @EarlyRepeatableTechLevelCost
	tier = @EarlyRepeatableTier
	category = { biology }
	levels = 1 # LS -1 -> 1
	prerequisites = { "eco_tech_waste_processing_3" }
	weight = @EarlyRepeatableWeight
	
	weight_modifier = {
		modifier = {
			factor = 0
			OR = {
				is_country_type = fallen_empire
				is_country_type = awakened_fallen_empire
			}
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_worker_production value > 0 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_worker_production value > 1 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_worker_production value > 2 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_worker_production value > 3 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_worker_production value > 4 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_worker_production value > 5 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_worker_production value > 6 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_worker_production value > 7 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_worker_production value > 8 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_worker_production value > 9 }
		}
	} 
	
	potential = {
		is_gestalt = no
		is_country_type = default
		has_global_flag = TechAscendant_active
	}
	
	ai_weight = {
		factor = 1.0
	}
	
	weight_groups = {
		production_repeatable
	}
	mod_weight_if_group_picked = {
		production_repeatable = @RepeatableCategoryFactor
    }
    mod_weight_if_group_picked = {
		ship_repeatable = @RepeatableDifferntFactor
	}

	modifier = {
		job_waste_handler_per_pop = 0.02
		job_waste_manager_per_pop = 0.01
	}
}

## Waste Drone Production (Repeatable) [Ecology]
# Changed from infinite repeatable to only having 1 level.
tech_repeatable_waste_drone_production = {
	area = society
	cost = @EarlyRepeatableTechCost
	cost_per_level = @EarlyRepeatableTechLevelCost
	tier = @EarlyRepeatableTier
	category = { biology }
	levels = 1 # LS -1 -> 1
	prerequisites = { "eco_tech_waste_processing_3" }
	weight = @EarlyRepeatableWeight
	
	weight_modifier = {
		modifier = {
			factor = 0
			OR = {
				is_country_type = fallen_empire
				is_country_type = awakened_fallen_empire
			}
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_drone_production value > 0 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_drone_production value > 1 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_drone_production value > 2 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_drone_production value > 3 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_drone_production value > 4 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_drone_production value > 5 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_drone_production value > 6 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_drone_production value > 7 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_drone_production value > 8 }
		}
		modifier = {
			factor = @EarlyRepatableTechFactor
			check_variable = { which = repeatable_waste_drone_production value > 9 }
		}
	} 
	
	potential = {
		is_gestalt = yes
		is_country_type = default
		has_global_flag = TechAscendant_active
	}
	
	ai_weight = {
		factor = 1.0
	}
	
	weight_groups = {
		production_repeatable
	}
	mod_weight_if_group_picked = {
		production_repeatable = @RepeatableCategoryFactor
    }
    mod_weight_if_group_picked = {
		ship_repeatable = @RepeatableDifferntFactor
	}

	modifier = {
		job_waste_drone_per_pop = 0.02
		job_waste_overseer_per_pop = 0.01
	}
}

##################################################
## Expanded Megastructures and Technology
##################################################

## Space Cloud Weapon 2 [Expanded Megastructures and Technology]
# EMT version with The Storm Cluster modifier
tech_space_cloud_weapon_2 = {
	area = physics
	cost = @tier5cost1
	tier = 5
	is_rare = yes
	category = { particles }
	ai_update_type = military
	prerequisites = { "tech_space_cloud_weapon_1" }	
	weight = @tier5weight1
	
	weight_modifier = {	
		factor = 0.5
		modifier = { # The Storm Cluster - Inheritable by released empires (if prereq tech_space_cloud_weapon_1 is also modified to be inheritable)
			add = 1
			has_country_flag = released_empire
			is_subject = yes # exists = overlord
			overlord = { has_technology = tech_space_cloud_weapon_2 }
			# Uninitialized economy means we're less than a month old:
			resource_expenses_compare = {
				resource = food
				value = 0
			}
			resource_expenses_compare = {
				resource = minerals
				value = 0
			}
			resource_expenses_compare = {
				resource = energy
				value = 0
			}
		}
		modifier = {
			factor = @ap_technological_ascendancy_rare_tech
			has_ascension_perk = ap_technological_ascendancy
		}
		modifier = {
			factor = @federation_perk_factor
			has_federation = yes
			federation = {
				has_federation_perk = rare_tech_boost
				any_member = { has_technology = tech_space_cloud_weapon_2 }
			}
		}
	}
	
	ai_weight = {
		factor = 2		#weapons are good
		modifier = {
			factor = 1.25
			has_ethic = ethic_militarist
		}
		modifier = {
			factor = 1.5
			has_ethic = ethic_fanatic_militarist
		}
		modifier = { # The Storm Cluster
			factor = 1.25
			has_trait_in_council = { TRAIT = leader_trait_expertise_particles }
		}
		modifier = { # The Storm Cluster
			factor = @favored_weapon_ai_tech_factor
			OR = {
				is_preferred_weapons = weapon_type_energy
				has_valid_civic = civic_hive_cordyceptic_drones
			}
		}
		modifier = { # The Storm Cluster
			factor = @synergistic_weapon_ai_tech_factor
			is_preferred_weapons = weapon_type_strike_craft
		}
		modifier = { # The Storm Cluster
			factor = @disfavored_weapon_ai_tech_factor
			is_preferred_weapons = weapon_type_kinetic
		}
	}
}

##################################################
## Expanded Starbases
##################################################

## Stellar Bastion [Expanded Starbases]
# Renamed to prevent clash with NSC
tech_starbase_8 = {
	cost = @tier5cost3
	area = engineering
	category = { voidcraft }
	tier = 6 # LS - Up tier from 5 to 6 since it's now big
	prerequisites = { "tech_starbase_7" } # LS - Change to require the Solar Stronghold
	weight = @tier5weight3
	
	# unlocks Citadel
	weight_modifier = {
		modifier = {
			factor = 0
			OR = {
				AND = {
					has_apocalypse = yes
					NOT = { has_technology = tech_titans }
				}
				AND = {
					NOT = { has_apocalypse = yes }
					NOT = { has_technology = tech_battleships }
				}
			}
		}
		modifier = {
			factor = 0.1
			NOT = { years_passed > 90 }
		}	
		modifier = {
			factor = 10
			any_neighbor_country = {
				has_technology = tech_starbase_8
			}
		}
		modifier = {
			factor = 2
			years_passed > 110
		}
		modifier = {
			factor = 3
			years_passed > 115
		}
		modifier = {
			factor = 4
			years_passed > 120
		}
		modifier = {
			factor = 5
			count_starbase_sizes = {
				starbase_size = starbase_citadel
				count >= 3
			}
		}
		modifier = {
			factor = 1.25
			has_tradition = tr_unyielding_adopt
		}
		modifier = {
			factor = @ap_grasp_the_void_travel_tech
			has_ascension_perk = ap_grasp_the_void
		}
		modifier = {
			factor = @eager_explorer_effect
			is_eager_explorer_empire = yes
		}
	}
	
	prereqfor_desc = {	
		ship = {
			title = "TECH_UNLOCK_BASTION_CONSTRUCTION_TITLE"
			desc = "TECH_UNLOCK_BASTION_CONSTRUCTION_DESC"
		}
	}
	
	ai_weight = {
		factor = 100 #higher factor due to starbase upgrade
	}
}
